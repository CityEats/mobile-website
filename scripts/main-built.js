/*!
 * jQuery JavaScript Library v1.10.2
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03T13:48Z
 */

/*!
 * Sizzle CSS Selector Engine v1.10.2
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03
 */

/*! jQuery UI - v1.10.3 - 2013-09-09
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.datepicker.js
* Copyright 2013 jQuery Foundation and other contributors; Licensed MIT */

//     Underscore.js 1.5.1
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

//     (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

// Copyright (c)2013 Derick Bailey, Muted Solutions, LLC.

// Distributed under MIT license

// MarionetteJS (Backbone.Marionette)
// ----------------------------------
// v1.1.0
//
// Copyright (c)2013 Derick Bailey, Muted Solutions, LLC.
// Distributed under MIT license
//
// http://marionettejs.com

/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

(function(e,t){function H(e){var t=e.length,n=w.type(e);return w.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||n!=="function"&&(t===0||typeof t=="number"&&t>0&&t-1 in e)}function j(e){var t=B[e]={};return w.each(e.match(S)||[],function(e,n){t[n]=!0}),t}function q(e,n,r,i){if(!w.acceptData(e))return;var s,o,u=w.expando,a=e.nodeType,f=a?w.cache:e,l=a?e[u]:e[u]&&u;if((!l||!f[l]||!i&&!f[l].data)&&r===t&&typeof n=="string")return;l||(a?l=e[u]=c.pop()||w.guid++:l=u),f[l]||(f[l]=a?{}:{toJSON:w.noop});if(typeof n=="object"||typeof n=="function")i?f[l]=w.extend(f[l],n):f[l].data=w.extend(f[l].data,n);return o=f[l],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[w.camelCase(n)]=r),typeof n=="string"?(s=o[n],s==null&&(s=o[w.camelCase(n)])):s=o,s}function R(e,t,n){if(!w.acceptData(e))return;var r,i,s=e.nodeType,o=s?w.cache:e,u=s?e[w.expando]:w.expando;if(!o[u])return;if(t){r=n?o[u]:o[u].data;if(r){w.isArray(t)?t=t.concat(w.map(t,w.camelCase)):t in r?t=[t]:(t=w.camelCase(t),t in r?t=[t]:t=t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!z(r):!w.isEmptyObject(r))return}}if(!n){delete o[u].data;if(!z(o[u]))return}s?w.cleanData([e],!0):w.support.deleteExpando||o!=o.window?delete o[u]:o[u]=null}function U(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(I,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:F.test(r)?w.parseJSON(r):r}catch(s){}w.data(e,n,r)}else r=t}return r}function z(e){var t;for(t in e){if(t==="data"&&w.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function it(){return!0}function st(){return!1}function ot(){try{return o.activeElement}catch(e){}}function ct(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ht(e,t,n){if(w.isFunction(t))return w.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return w.grep(e,function(e){return e===t!==n});if(typeof t=="string"){if(ut.test(t))return w.filter(t,e,n);t=w.filter(t,e)}return w.grep(e,function(e){return w.inArray(e,t)>=0!==n})}function pt(e){var t=dt.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Mt(e,t){return w.nodeName(e,"table")&&w.nodeName(t.nodeType===1?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function _t(e){return e.type=(w.find.attr(e,"type")!==null)+"/"+e.type,e}function Dt(e){var t=Ct.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Pt(e,t){var n,r=0;for(;(n=e[r])!=null;r++)w._data(n,"globalEval",!t||w._data(t[r],"globalEval"))}function Ht(e,t){if(t.nodeType!==1||!w.hasData(e))return;var n,r,i,s=w._data(e),o=w._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)w.event.add(t,n,u[n][r])}o.data&&(o.data=w.extend({},o.data))}function Bt(e,t){var n,r,i;if(t.nodeType!==1)return;n=t.nodeName.toLowerCase();if(!w.support.noCloneEvent&&t[w.expando]){i=w._data(t);for(r in i.events)w.removeEvent(t,r,i.handle);t.removeAttribute(w.expando)}if(n==="script"&&t.text!==e.text)_t(t).text=e.text,Dt(t);else if(n==="object")t.parentNode&&(t.outerHTML=e.outerHTML),w.support.html5Clone&&e.innerHTML&&!w.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML);else if(n==="input"&&xt.test(e.type))t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value);else if(n==="option")t.defaultSelected=t.selected=e.defaultSelected;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function jt(e,n){var r,s,o=0,u=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!u)for(u=[],r=e.childNodes||e;(s=r[o])!=null;o++)!n||w.nodeName(s,n)?u.push(s):w.merge(u,jt(s,n));return n===t||n&&w.nodeName(e,n)?w.merge([e],u):u}function Ft(e){xt.test(e.type)&&(e.defaultChecked=e.checked)}function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--){t=en[i]+n;if(t in e)return t}return r}function nn(e,t){return e=t||e,w.css(e,"display")==="none"||!w.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=w._data(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&nn(r)&&(s[o]=w._data(r,"olddisplay",an(r.nodeName)))):s[o]||(i=nn(r),(n&&n!=="none"||!i)&&w._data(r,"olddisplay",i?n:w.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function sn(e,t,n){var r=$t.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function on(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=w.css(e,n+Zt[s],!0,i)),r?(n==="content"&&(o-=w.css(e,"padding"+Zt[s],!0,i)),n!=="margin"&&(o-=w.css(e,"border"+Zt[s]+"Width",!0,i))):(o+=w.css(e,"padding"+Zt[s],!0,i),n!=="padding"&&(o+=w.css(e,"border"+Zt[s]+"Width",!0,i)));return o}function un(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=qt(e),o=w.support.boxSizing&&w.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=Rt(e,t,s);if(i<0||i==null)i=e.style[t];if(Jt.test(i))return i;r=o&&(w.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+on(e,t,n||(o?"border":"content"),r,s)+"px"}function an(e){var t=o,n=Qt[e];if(!n){n=fn(e,t);if(n==="none"||!n)It=(It||w("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(It[0].contentWindow||It[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=fn(e,t),It.detach();Qt[e]=n}return n}function fn(e,t){var n=w(t.createElement(e)).appendTo(t.body),r=w.css(n[0],"display");return n.remove(),r}function vn(e,t,n,r){var i;if(w.isArray(t))w.each(t,function(t,i){n||cn.test(e)?r(e,i):vn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&w.type(t)==="object")for(i in t)vn(e+"["+i+"]",t[i],n,r);else r(e,t)}function _n(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(S)||[];if(w.isFunction(n))while(r=s[i++])r[0]==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Dn(e,t,n,r){function o(u){var a;return i[u]=!0,w.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===An;return o(t.dataTypes[0])||!i["*"]&&o("*")}function Pn(e,n){var r,i,s=w.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((s[i]?e:r||(r={}))[i]=n[i]);return r&&w.extend(!0,e,r),e}function Hn(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes;while(f[0]==="*")f.shift(),s===t&&(s=e.mimeType||n.getResponseHeader("Content-Type"));if(s)for(u in a)if(a[u]&&a[u].test(s)){f.unshift(u);break}if(f[0]in r)o=f[0];else{for(u in r){if(!f[0]||e.converters[u+" "+f[0]]){o=u;break}i||(i=u)}o=o||i}if(o)return o!==f[0]&&f.unshift(o),r[o]}function Bn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s){e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift();if(s)if(s==="*")s=a;else if(a!=="*"&&a!==s){o=f[a+" "+s]||f["* "+s];if(!o)for(i in f){u=i.split(" ");if(u[1]===s){o=f[a+" "+u[0]]||f["* "+u[0]];if(o){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}}}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}}return{state:"success",data:t}}function zn(){try{return new e.XMLHttpRequest}catch(t){}}function Wn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function Yn(){return setTimeout(function(){Xn=t}),Xn=w.now()}function Zn(e,t,n){var r,i=(Gn[t]||[]).concat(Gn["*"]),s=0,o=i.length;for(;s<o;s++)if(r=i[s].call(n,t,e))return r}function er(e,t,n){var r,i,s=0,o=Qn.length,u=w.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=Xn||Yn(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Yn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;tr(l,f.opts.specialEasing);for(;s<o;s++){r=Qn[s].call(f,e,l,f.opts);if(r)return r}return w.map(l,Zn,f),w.isFunction(f.opts.start)&&f.opts.start.call(e,f),w.fx.timer(w.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function tr(e,t){var n,r,i,s,o;for(n in e){r=w.camelCase(n),i=t[r],s=e[n],w.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=w.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function nr(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&nn(e),p=w._data(e,"fxshow");n.queue||(u=w._queueHooks(e,"fx"),u.unqueued==null&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,w.queue(e,"fx").length||u.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],w.css(e,"display")==="inline"&&w.css(e,"float")==="none"&&(!w.support.inlineBlockNeedsLayout||an(e.nodeName)==="inline"?c.display="inline-block":c.zoom=1)),n.overflow&&(c.overflow="hidden",w.support.shrinkWrapBlocks||f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t){i=t[r];if($n.exec(i)){delete t[r],s=s||i==="toggle";if(i===(h?"hide":"show"))continue;l[r]=p&&p[r]||w.style(e,r)}}if(!w.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=w._data(e,"fxshow",{}),s&&(p.hidden=!h),h?w(e).show():f.done(function(){w(e).hide()}),f.done(function(){var t;w._removeData(e,"fxshow");for(t in l)w.style(e,t,l[t])});for(r in l)o=Zn(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start=r==="width"||r==="height"?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}function ir(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function sr(e){return w.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=typeof t,s=e.location,o=e.document,u=o.documentElement,a=e.jQuery,f=e.$,l={},c=[],h="1.10.2",p=c.concat,d=c.push,v=c.slice,m=c.indexOf,g=l.toString,y=l.hasOwnProperty,b=h.trim,w=function(e,t){return new w.fn.init(e,t,r)},E=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,S=/\S+/g,x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,N=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,C=/^[\],:{}\s]*$/,k=/(?:^|:|,)(?:\s*\[)+/g,L=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,A=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,O=/^-ms-/,M=/-([\da-z])/gi,_=function(e,t){return t.toUpperCase()},D=function(e){if(o.addEventListener||e.type==="load"||o.readyState==="complete")P(),w.ready()},P=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",D,!1),e.removeEventListener("load",D,!1)):(o.detachEvent("onreadystatechange",D),e.detachEvent("onload",D))};w.fn=w.prototype={jquery:h,constructor:w,init:function(e,n,r){var i,s;if(!e)return this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?i=[null,e,null]:i=T.exec(e);if(i&&(i[1]||!n)){if(i[1]){n=n instanceof w?n[0]:n,w.merge(this,w.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0));if(N.test(i[1])&&w.isPlainObject(n))for(i in n)w.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}s=o.getElementById(i[2]);if(s&&s.parentNode){if(s.id!==i[2])return r.find(e);this.length=1,this[0]=s}return this.context=o,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):w.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),w.makeArray(e,this))},selector:"",length:0,toArray:function(){return v.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return w.each(this,e,t)},ready:function(e){return w.ready.promise().done(e),this},slice:function(){return this.pushStack(v.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},w.fn.init.prototype=w.fn,w.extend=w.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!w.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((s=arguments[a])!=null)for(i in s){e=u[i],r=s[i];if(u===r)continue;l&&r&&(w.isPlainObject(r)||(n=w.isArray(r)))?(n?(n=!1,o=e&&w.isArray(e)?e:[]):o=e&&w.isPlainObject(e)?e:{},u[i]=w.extend(l,o,r)):r!==t&&(u[i]=r)}return u},w.extend({expando:"jQuery"+(h+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===w&&(e.$=f),t&&e.jQuery===w&&(e.jQuery=a),w},isReady:!1,readyWait:1,holdReady:function(e){e?w.readyWait++:w.ready(!0)},ready:function(e){if(e===!0?--w.readyWait:w.isReady)return;if(!o.body)return setTimeout(w.ready);w.isReady=!0;if(e!==!0&&--w.readyWait>0)return;n.resolveWith(o,[w]),w.fn.trigger&&w(o).trigger("ready").off("ready")},isFunction:function(e){return w.type(e)==="function"},isArray:Array.isArray||function(e){return w.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):typeof e=="object"||typeof e=="function"?l[g.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||w.type(e)!=="object"||e.nodeType||w.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,"constructor")&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(w.support.ownLast)for(n in e)return y.call(e,n);for(n in e);return n===t||y.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||o;var r=N.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=w.buildFragment([e],t,i),i&&w(i).remove(),w.merge([],r.childNodes))},parseJSON:function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(t===null)return t;if(typeof t=="string"){t=w.trim(t);if(t&&C.test(t.replace(L,"@").replace(A,"]").replace(k,"")))return(new Function("return "+t))()}w.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&w.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&w.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(O,"ms-").replace(M,_)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=H(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:b&&!b.call("﻿ ")?function(e){return e==null?"":b.call(e)}:function(e){return e==null?"":(e+"").replace(x,"")},makeArray:function(e,t){var n=t||[];return e!=null&&(H(Object(e))?w.merge(n,typeof e=="string"?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(m)return m.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=H(e),u=[];if(o)for(;i<s;i++)r=t(e[i],i,n),r!=null&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),r!=null&&(u[u.length]=r);return p.apply([],u)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(s=e[n],n=e,e=s),w.isFunction(e)?(r=v.call(arguments,2),i=function(){return e.apply(n||this,r.concat(v.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i):t},access:function(e,n,r,i,s,o,u){var a=0,f=e.length,l=r==null;if(w.type(r)==="object"){s=!0;for(a in r)w.access(e,n,a,r[a],!0,o,u)}else if(i!==t){s=!0,w.isFunction(i)||(u=!0),l&&(u?(n.call(e,i),n=null):(l=n,n=function(e,t,n){return l.call(w(e),n)}));if(n)for(;a<f;a++)n(e[a],r,u?i:i.call(e[a],a,n(e[a],r)))}return s?e:l?n.call(e):f?n(e[0],r):o},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),w.ready.promise=function(t){if(!n){n=w.Deferred();if(o.readyState==="complete")setTimeout(w.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",D,!1),e.addEventListener("load",D,!1);else{o.attachEvent("onreadystatechange",D),e.attachEvent("onload",D);var r=!1;try{r=e.frameElement==null&&o.documentElement}catch(i){}r&&r.doScroll&&function s(){if(!w.isReady){try{r.doScroll("left")}catch(e){return setTimeout(s,50)}P(),w.ready()}}()}}return n.promise(t)},w.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),r=w(o),function(e,t){function ot(e,t,n,i){var s,o,u,a,f,l,p,m,g,w;(t?t.ownerDocument||t:E)!==h&&c(t),t=t||h,n=n||[];if(!e||typeof e!="string")return n;if((a=t.nodeType)!==1&&a!==9)return[];if(d&&!i){if(s=Z.exec(e))if(u=s[1]){if(a===9){o=t.getElementById(u);if(!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return H.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return H.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){m=p=b,g=t,w=a===9&&e;if(a===1&&t.nodeName.toLowerCase()!=="object"){l=mt(e),(p=t.getAttribute("id"))?m=p.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+gt(l[f]);g=$.test(e)&&t.parentNode||t,w=l.join(",")}if(w)try{return H.apply(n,g.querySelectorAll(w)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Nt(e.replace(W,"$1"),t,n,i)}function ut(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function at(e){return e[b]=!0,e}function ft(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)s.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(){}function mt(e,t){var n,r,i,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){if(!n||(r=X.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(i=[]);n=!1;if(r=V.exec(u))n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),u=u.slice(n.length);for(o in s.filter)(r=G[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)}function gt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,s=n&&r==="parentNode",o=x++;return t.first?function(t,n,i){while(t=t[r])if(t.nodeType===1||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=S+" "+o;if(u){while(t=t[r])if(t.nodeType===1||s)if(e(t,n,u))return!0}else while(t=t[r])if(t.nodeType===1||s){l=t[b]||(t[b]={});if((f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else{f=l[r]=[c],f[1]=e(t,n,u)||i;if(f[1]===!0)return!0}}}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function Et(e,t,n,r,i,s){return r&&!r[b]&&(r=Et(r)),i&&!i[b]&&(i=Et(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||Tt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?wt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?j.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):H.apply(o,g)})}function St(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return j.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;a<i;a++)if(n=s.relative[e[a].type])h=[yt(bt(h),n)];else{n=s.filter[e[a].type].apply(null,e[a].matches);if(n[b]){r=++a;for(;r<i;r++)if(s.relative[e[r].type])break;return Et(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:e[a-2].type===" "?"*":""})).replace(W,"$1"),n,a<r&&St(e.slice(a,r)),r<i&&St(e=e.slice(r)),r<i&&gt(e))}h.push(n)}return bt(h)}function xt(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],E=p!=null,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=S+=x==null?1:Math.random()||.1;E&&(f=a!==h&&a,i=n);for(;(d=T[b])!=null;b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}E&&(S=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}y+=b;if(r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)!w[b]&&!g[b]&&(g[b]=D.call(c));g=wt(g)}H.apply(c,g),E&&!u&&g.length>0&&y+t.length>1&&ot.uniqueSort(c)}return E&&(S=N,f=x),w};return r?at(u):u}function Tt(e,t,n){var r=0,i=t.length;for(;r<i;r++)ot(e,t[r],n);return n}function Nt(e,t,n,i){var o,u,f,l,c,h=mt(e);if(!i&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&r.getById&&t.nodeType===9&&d&&s.relative[u[1].type]){t=(s.find.ID(f.matches[0].replace(rt,it),t)||[])[0];if(!t)return n;e=e.slice(u.shift().value.length)}o=G.needsContext.test(e)?0:u.length;while(o--){f=u[o];if(s.relative[l=f.type])break;if(c=s.find[l])if(i=c(f.matches[0].replace(rt,it),$.test(u[0].type)&&t.parentNode||t)){u.splice(o,1),e=i.length&&gt(u);if(!e)return H.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,$.test(e)),n}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),E=e.document,S=0,x=0,T=ut(),N=ut(),C=ut(),k=!1,L=function(e,t){return e===t?(k=!0,0):0},A=typeof t,O=1<<31,M={}.hasOwnProperty,_=[],D=_.pop,P=_.push,H=_.push,B=_.slice,j=_.indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=q.replace("w","w#"),U="\\["+I+"*("+q+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+I+"*\\]",z=":("+q+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+U.replace(3,8)+")*)|.*)\\)|)",W=new RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=new RegExp("^"+I+"*,"+I+"*"),V=new RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),$=new RegExp(I+"*[+~]"),J=new RegExp("="+I+"*([^\\]'\"]*)"+I+"*\\]","g"),K=new RegExp(z),Q=new RegExp("^"+R+"$"),G={ID:new RegExp("^#("+q+")"),CLASS:new RegExp("^\\.("+q+")"),TAG:new RegExp("^("+q.replace("w","w*")+")"),ATTR:new RegExp("^"+U),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=new RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)};try{H.apply(_=B.call(E.childNodes),E.childNodes),_[E.childNodes.length].nodeType}catch(st){H={apply:_.length?function(e,t){P.apply(e,B.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},r=ot.support={},c=ot.setDocument=function(e){var t=e?e.ownerDocument||e:E,n=t.defaultView;if(t===h||t.nodeType!==9||!t.documentElement)return h;h=t,p=t.documentElement,d=!u(t),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){c()}),r.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ft(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ft(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",e.getElementsByClassName("i").length===2}),r.getById=ft(function(e){return p.appendChild(e).id=b,!t.getElementsByName||!t.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==A&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==A)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==A&&d)return t.getElementsByClassName(e)},m=[],v=[];if(r.qsa=Y.test(t.querySelectorAll))ft(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+F+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),ft(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")});return(r.matchesSelector=Y.test(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ft(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",z)}),v=v.length&&new RegExp(v.join("|")),m=m.length&&new RegExp(m.join("|")),y=Y.test(p.contains)||p.compareDocumentPosition?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=p.compareDocumentPosition?function(e,n){if(e===n)return k=!0,0;var i=n.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(n);if(i)return i&1||!r.sortDetached&&n.compareDocumentPosition(e)===i?e===t||y(E,e)?-1:n===t||y(E,n)?1:l?j.call(l,e)-j.call(l,n):0:i&4?-1:1;return e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,s=e.parentNode,o=n.parentNode,u=[e],a=[n];if(e===n)return k=!0,0;if(!s||!o)return e===t?-1:n===t?1:s?-1:o?1:l?j.call(l,e)-j.call(l,n):0;if(s===o)return ct(e,n);r=e;while(r=r.parentNode)u.unshift(r);r=n;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ct(u[i],a[i]):u[i]===E?-1:a[i]===E?1:0},t},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){(e.ownerDocument||e)!==h&&c(e),t=t.replace(J,"='$1']");if(r.matchesSelector&&d&&(!m||!m.test(t))&&(!v||!v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&e.document.nodeType!==11)return n}catch(i){}return ot(t,h,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},ot.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&M.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ot.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,n=[],i=0,s=0;k=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(L);if(k){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(!i)for(;t=e[r];r++)n+=o(t);else if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(i===3||i===4)return e.nodeValue;return n},s=ot.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return G.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&K.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&T(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===S&&f[1],h=f[0]===S&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[S,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===S)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){y&&((c[b]||(c[b]={}))[e]=[S,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=j.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(W,"$1"));return r[b]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return Q.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||e.nodeType===3||e.nodeType===4)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[n<0?n+t:n]}),even:dt(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=pt(n);vt.prototype=s.filters=s.pseudos,s.setFilters=new vt,a=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=mt(e)),n=t.length;while(n--)s=St(t[n]),s[b]?r.push(s):i.push(s);s=C(e,xt(i,r))}return s},r.sortStable=b.split("").sort(L).join("")===b,r.detectDuplicates=k,c(),r.sortDetached=ft(function(e){return e.compareDocumentPosition(h.createElement("div"))&1}),ft(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild.getAttribute("href")==="#"})||lt("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}),(!r.attributes||!ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),e.firstChild.getAttribute("value")===""}))&&lt("value",function(e,t,n){if(!n&&e.nodeName.toLowerCase()==="input")return e.defaultValue}),ft(function(e){return e.getAttribute("disabled")==null})||lt(F,function(e,t,n){var r;if(!n)return(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),w.find=ot,w.expr=ot.selectors,w.expr[":"]=w.expr.pseudos,w.unique=ot.uniqueSort,w.text=ot.getText,w.isXMLDoc=ot.isXML,w.contains=ot.contains}(e);var B={};w.Callbacks=function(e){e=typeof e=="string"?B[e]||j(e):w.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){r=e.memory&&t,i=!0,o=u||0,u=0,s=a.length,n=!0;for(;a&&o<s;o++)if(a[o].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,a&&(f?f.length&&l(f.shift()):r?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function i(t){w.each(t,function(t,n){var r=w.type(n);r==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&r!=="string"&&i(n)})})(arguments),n?s=a.length:r&&(u=t,l(r))}return this},remove:function(){return a&&w.each(arguments,function(e,t){var r;while((r=w.inArray(t,a,r))>-1)a.splice(r,1),n&&(r<=s&&s--,r<=o&&o--)}),this},has:function(e){return e?w.inArray(e,a)>-1:!!a&&!!a.length},empty:function(){return a=[],s=0,this},disable:function(){return a=f=r=t,this},disabled:function(){return!a},lock:function(){return f=t,r||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return a&&(!i||f)&&(t=t||[],t=[e,t.slice?t.slice():t],n?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},w.extend({Deferred:function(e){var t=[["resolve","done",w.Callbacks("once memory"),"resolved"],["reject","fail",w.Callbacks("once memory"),"rejected"],["notify","progress",w.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return w.Deferred(function(n){w.each(t,function(t,s){var o=s[0],u=w.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&w.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?w.extend(e,r):r}},i={};return r.pipe=r.then,w.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=v.call(arguments),r=n.length,i=r!==1||e&&w.isFunction(e.promise)?r:0,s=i===1?e:w.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?v.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&w.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),w.support=function(t){var n,r,s,u,a,f,l,c,h,p=o.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*")||[],r=p.getElementsByTagName("a")[0];if(!r||!r.style||!n.length)return t;u=o.createElement("select"),f=u.appendChild(o.createElement("option")),s=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute=p.className!=="t",t.leadingWhitespace=p.firstChild.nodeType===3,t.tbody=!p.getElementsByTagName("tbody").length,t.htmlSerialize=!!p.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized=r.getAttribute("href")==="/a",t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!s.value,t.optSelected=f.selected,t.enctype=!!o.createElement("form").enctype,t.html5Clone=o.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,s.checked=!0,t.noCloneChecked=s.cloneNode(!0).checked,u.disabled=!0,t.optDisabled=!f.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}s=o.createElement("input"),s.setAttribute("value",""),t.input=s.getAttribute("value")==="",s.value="t",s.setAttribute("type","radio"),t.radioValue=s.value==="t",s.setAttribute("checked","t"),s.setAttribute("name","t"),a=o.createDocumentFragment(),a.appendChild(s),t.appendChecked=s.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,p.attachEvent&&(p.attachEvent("onclick",function(){t.noCloneEvent=!1}),p.cloneNode(!0).click());for(h in{submit:!0,change:!0,focusin:!0})p.setAttribute(l="on"+h,"t"),t[h+"Bubbles"]=l in e||p.attributes[l].expando===!1;p.style.backgroundClip="content-box",p.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle=p.style.backgroundClip==="content-box";for(h in w(t))break;return t.ownLast=h!=="0",w(function(){var n,r,s,u="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=o.getElementsByTagName("body")[0];if(!a)return;n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(p),p.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=p.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,p.innerHTML="",p.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",w.swap(a,a.style.zoom!=null?{zoom:1}:{},function(){t.boxSizing=p.offsetWidth===4}),e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(p,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(p,null)||{width:"4px"}).width==="4px",r=p.appendChild(o.createElement("div")),r.style.cssText=p.style.cssText=u,r.style.marginRight=r.style.width="0",p.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof p.style.zoom!==i&&(p.innerHTML="",p.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=p.offsetWidth===3,p.style.display="block",p.innerHTML="<div></div>",p.firstChild.style.width="5px",t.shrinkWrapBlocks=p.offsetWidth!==3,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=p=s=r=null}),n=u=a=f=r=s=null,t}({});var F=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,I=/([A-Z])/g;w.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?w.cache[e[w.expando]]:e[w.expando],!!e&&!z(e)},data:function(e,t,n){return q(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return q(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&e.nodeType!==1&&e.nodeType!==9)return!1;var t=e.nodeName&&w.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),w.fn.extend({data:function(e,n){var r,i,s=null,o=0,u=this[0];if(e===t){if(this.length){s=w.data(u);if(u.nodeType===1&&!w._data(u,"parsedAttrs")){r=u.attributes;for(;o<r.length;o++)i=r[o].name,i.indexOf("data-")===0&&(i=w.camelCase(i.slice(5)),U(u,i,s[i]));w._data(u,"parsedAttrs",!0)}}return s}return typeof e=="object"?this.each(function(){w.data(this,e)}):arguments.length>1?this.each(function(){w.data(this,e,n)}):u?U(u,e,w.data(u,e)):null},removeData:function(e){return this.each(function(){w.removeData(this,e)})}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=w._data(e,t),n&&(!r||w.isArray(n)?r=w._data(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),s=w._queueHooks(e,t),o=function(){w.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return w._data(e,n)||w._data(e,n,{empty:w.Callbacks("once memory").add(function(){w._removeData(e,t+"queue"),w._removeData(e,n)})})}}),w.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?w.queue(this[0],e):n===t?this:this.each(function(){var t=w.queue(this,e,n);w._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},delay:function(e,t){return e=w.fx?w.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=w.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=w._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var W,X,V=/[\t\r\n\f]/g,$=/\r/g,J=/^(?:input|select|textarea|button|object)$/i,K=/^(?:a|area)$/i,Q=/^(?:checked|selected)$/i,G=w.support.getSetAttribute,Y=w.support.input;w.fn.extend({attr:function(e,t){return w.access(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})},prop:function(e,t){return w.access(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return e=w.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=typeof e=="string"&&e;if(w.isFunction(e))return this.each(function(t){w(this).addClass(e.call(this,t,this.className))});if(a){t=(e||"").match(S)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(V," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");n.className=w.trim(r)}}}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=arguments.length===0||typeof e=="string"&&e;if(w.isFunction(e))return this.each(function(t){w(this).removeClass(e.call(this,t,this.className))});if(a){t=(e||"").match(S)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(V," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?w.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e;return typeof t=="boolean"&&n==="string"?t?this.addClass(e):this.removeClass(e):w.isFunction(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var t,r=0,s=w(this),o=e.match(S)||[];while(t=o[r++])s.hasClass(t)?s.removeClass(t):s.addClass(t)}else if(n===i||n==="boolean")this.className&&w._data(this,"__className__",this.className),this.className=this.className||e===!1?"":w._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(V," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return r=w.valHooks[s.type]||w.valHooks[s.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(s,"value"))!==t?n:(n=s.value,typeof n=="string"?n.replace($,""):n==null?"":n);return}return i=w.isFunction(e),this.each(function(n){var s;if(this.nodeType!==1)return;i?s=e.call(this,n,w(this).val()):s=e,s==null?s="":typeof s=="number"?s+="":w.isArray(s)&&(s=w.map(s,function(e){return e==null?"":e+""})),r=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()];if(!r||!("set"in r)||r.set(this,s,"value")===t)this.value=s})}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return t!=null?t:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(w.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!w.nodeName(n.parentNode,"optgroup"))){t=w(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n,r,i=e.options,s=w.makeArray(t),o=i.length;while(o--){r=i[o];if(r.selected=w.inArray(w(r).val(),s)>=0)n=!0}return n||(e.selectedIndex=-1),s}}},attr:function(e,n,r){var s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;if(typeof e.getAttribute===i)return w.prop(e,n,r);if(u!==1||!w.isXMLDoc(e))n=n.toLowerCase(),s=w.attrHooks[n]||(w.expr.match.bool.test(n)?X:W);if(r===t)return s&&"get"in s&&(o=s.get(e,n))!==null?o:(o=w.find.attr(e,n),o==null?t:o);if(r!==null)return s&&"set"in s&&(o=s.set(e,r,n))!==t?o:(e.setAttribute(n,r+""),r);w.removeAttr(e,n)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(S);if(s&&e.nodeType===1)while(n=s[i++])r=w.propFix[n]||n,w.expr.match.bool.test(n)?Y&&G||!Q.test(n)?e[r]=!1:e[w.camelCase("default-"+n)]=e[r]=!1:w.attr(e,n,""),e.removeAttribute(G?n:r)},attrHooks:{type:{set:function(e,t){if(!w.support.radioValue&&t==="radio"&&w.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!w.isXMLDoc(e),o&&(n=w.propFix[n]||n,s=w.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):J.test(e.nodeName)||K.test(e.nodeName)&&e.href?0:-1}}}}),X={set:function(e,t,n){return t===!1?w.removeAttr(e,n):Y&&G||!Q.test(n)?e.setAttribute(!G&&w.propFix[n]||n,n):e[w.camelCase("default-"+n)]=e[n]=!0,n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,n){var r=w.expr.attrHandle[n]||w.find.attr;w.expr.attrHandle[n]=Y&&G||!Q.test(n)?function(e,n,i){var s=w.expr.attrHandle[n],o=i?t:(w.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return w.expr.attrHandle[n]=s,o}:function(e,n,r){return r?t:e[w.camelCase("default-"+n)]?n.toLowerCase():null}});if(!Y||!G)w.attrHooks.value={set:function(e,t,n){if(!w.nodeName(e,"input"))return W&&W.set(e,t,n);e.defaultValue=t}};G||(W={set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="",r==="value"||n===e.getAttribute(r)?n:t}},w.expr.attrHandle.id=w.expr.attrHandle.name=w.expr.attrHandle.coords=function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.value!==""?i.value:null},w.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&r.specified?r.value:t},set:W.set},w.attrHooks.contenteditable={set:function(e,t,n){W.set(e,t===""?!1:t,n)}},w.each(["width","height"],function(e,t){w.attrHooks[t]={set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}}})),w.support.hrefNormalized||w.each(["href","src"],function(e,t){w.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),w.support.style||(w.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),w.support.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),w.support.enctype||(w.propFix.enctype="encoding"),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){if(w.isArray(t))return e.checked=w.inArray(w(e).val(),t)>=0}},w.support.checkOn||(w.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;w.event={global:{},add:function(e,n,r,s,o){var u,a,f,l,c,h,p,d,v,m,g,y=w._data(e);if(!y)return;r.handler&&(l=r,r=l.handler,o=l.selector),r.guid||(r.guid=w.guid++),(a=y.events)||(a=y.events={}),(h=y.handle)||(h=y.handle=function(e){return typeof w===i||!!e&&w.event.triggered===e.type?t:w.event.dispatch.apply(h.elem,arguments)},h.elem=e),n=(n||"").match(S)||[""],f=n.length;while(f--){u=rt.exec(n[f])||[],v=g=u[1],m=(u[2]||"").split(".").sort();if(!v)continue;c=w.event.special[v]||{},v=(o?c.delegateType:c.bindType)||v,c=w.event.special[v]||{},p=w.extend({type:v,origType:g,data:s,handler:r,guid:r.guid,selector:o,needsContext:o&&w.expr.match.needsContext.test(o),namespace:m.join(".")},l);if(!(d=a[v])){d=a[v]=[],d.delegateCount=0;if(!c.setup||c.setup.call(e,s,m,h)===!1)e.addEventListener?e.addEventListener(v,h,!1):e.attachEvent&&e.attachEvent("on"+v,h)}c.add&&(c.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),o?d.splice(d.delegateCount++,0,p):d.push(p),w.event.global[v]=!0}e=null},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=w.hasData(e)&&w._data(e);if(!m||!(l=m.events))return;t=(t||"").match(S)||[""],f=t.length;while(f--){u=rt.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p){for(p in l)w.event.remove(e,p+t[f],n,r,!0);continue}c=w.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=l[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;while(s--)o=h[s],(i||v===o.origType)&&(!n||n.guid===o.guid)&&(!u||u.test(o.namespace))&&(!r||r===o.selector||r==="**"&&o.selector)&&(h.splice(s,1),o.selector&&h.delegateCount--,c.remove&&c.remove.call(e,o));a&&!h.length&&((!c.teardown||c.teardown.call(e,d,m.handle)===!1)&&w.removeEvent(e,p,m.handle),delete l[p])}w.isEmptyObject(l)&&(delete m.handle,w._removeData(e,"events"))},trigger:function(n,r,i,s){var u,a,f,l,c,h,p,d=[i||o],v=y.call(n,"type")?n.type:n,m=y.call(n,"namespace")?n.namespace.split("."):[];f=h=i=i||o;if(i.nodeType===3||i.nodeType===8)return;if(nt.test(v+w.event.triggered))return;v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),a=v.indexOf(":")<0&&"on"+v,n=n[w.expando]?n:new w.Event(v,typeof n=="object"&&n),n.isTrigger=s?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=r==null?[n]:w.makeArray(r,[n]),c=w.event.special[v]||{};if(!s&&c.trigger&&c.trigger.apply(i,r)===!1)return;if(!s&&!c.noBubble&&!w.isWindow(i)){l=c.delegateType||v,nt.test(l+v)||(f=f.parentNode);for(;f;f=f.parentNode)d.push(f),h=f;h===(i.ownerDocument||o)&&d.push(h.defaultView||h.parentWindow||e)}p=0;while((f=d[p++])&&!n.isPropagationStopped())n.type=p>1?l:c.bindType||v,u=(w._data(f,"events")||{})[n.type]&&w._data(f,"handle"),u&&u.apply(f,r),u=a&&f[a],u&&w.acceptData(f)&&u.apply&&u.apply(f,r)===!1&&n.preventDefault();n.type=v;if(!s&&!n.isDefaultPrevented()&&(!c._default||c._default.apply(d.pop(),r)===!1)&&w.acceptData(i)&&a&&i[v]&&!w.isWindow(i)){h=i[a],h&&(i[a]=null),w.event.triggered=v;try{i[v]()}catch(g){}w.event.triggered=t,h&&(i[a]=h)}return n.result},dispatch:function(e){e=w.event.fix(e);var n,r,i,s,o,u=[],a=v.call(arguments),f=(w._data(this,"events")||{})[e.type]||[],l=w.event.special[e.type]||{};a[0]=e,e.delegateTarget=this;if(l.preDispatch&&l.preDispatch.call(this,e)===!1)return;u=w.event.handlers.call(this,e,f),n=0;while((s=u[n++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(i.namespace))e.handleObj=i,e.data=i.data,r=((w.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation())}return l.postDispatch&&l.postDispatch.call(this,e),e.result},handlers:function(e,n){var r,i,s,o,u=[],a=n.delegateCount,f=e.target;if(a&&f.nodeType&&(!e.button||e.type!=="click"))for(;f!=this;f=f.parentNode||this)if(f.nodeType===1&&(f.disabled!==!0||e.type!=="click")){s=[];for(o=0;o<a;o++)i=n[o],r=i.selector+" ",s[r]===t&&(s[r]=i.needsContext?w(r,this).index(f)>=0:w.find(r,this,null,[f]).length),s[r]&&s.push(i);s.length&&u.push({elem:f,handlers:s})}return a<n.length&&u.push({elem:this,handlers:n.slice(a)}),u},fix:function(e){if(e[w.expando])return e;var t,n,r,i=e.type,s=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new w.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=s.srcElement||o),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,u.filter?u.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,s,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(i=e.target.ownerDocument||o,s=i.documentElement,r=i.body,e.pageX=n.clientX+(s&&s.scrollLeft||r&&r.scrollLeft||0)-(s&&s.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||r&&r.scrollTop||0)-(s&&s.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ot()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===ot()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(w.nodeName(this,"input")&&this.type==="checkbox"&&this.click)return this.click(),!1},_default:function(e){return w.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=w.extend(new w.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?w.event.trigger(i,null,t):w.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},w.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:st):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||w.now(),this[w.expando]=!0},w.Event.prototype={isDefaultPrevented:st,isPropagationStopped:st,isImmediatePropagationStopped:st,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},w.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!w.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),w.support.submitBubbles||(w.event.special.submit={setup:function(){if(w.nodeName(this,"form"))return!1;w.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=w.nodeName(n,"input")||w.nodeName(n,"button")?n.form:t;r&&!w._data(r,"submitBubbles")&&(w.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),w._data(r,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&w.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(w.nodeName(this,"form"))return!1;w.event.remove(this,"._submit")}}),w.support.changeBubbles||(w.event.special.change={setup:function(){if(Z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")w.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),w.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),w.event.simulate("change",this,e,!0)});return!1}w.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!w._data(t,"changeBubbles")&&(w.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&w.event.simulate("change",this.parentNode,e,!0)}),w._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return w.event.remove(this,"._change"),!Z.test(this.nodeName)}}),w.support.focusinBubbles||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){w.event.simulate(t,e.target,w.event.fix(e),!0)};w.event.special[t]={setup:function(){n++===0&&o.addEventListener(e,r,!0)},teardown:function(){--n===0&&o.removeEventListener(e,r,!0)}}}),w.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(o in e)this.on(o,n,r,e[o],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=st;else if(!i)return this;return s===1&&(u=i,i=function(e){return w().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=w.guid++)),this.each(function(){w.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,w(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=st),this.each(function(){w.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}});var ut=/^.[^:#\[\.,]*$/,at=/^(?:parents|prev(?:Until|All))/,ft=w.expr.match.needsContext,lt={children:!0,contents:!0,next:!0,prev:!0};w.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if(typeof e!="string")return this.pushStack(w(e).filter(function(){for(t=0;t<i;t++)if(w.contains(r[t],this))return!0}));for(t=0;t<i;t++)w.find(e,r[t],n);return n=this.pushStack(i>1?w.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=w(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(w.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ht(this,e||[],!0))},filter:function(e){return this.pushStack(ht(this,e||[],!1))},is:function(e){return!!ht(this,typeof e=="string"&&ft.test(e)?w(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=ft.test(e)||typeof e!="string"?w(e,t||this.context):0;for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:n.nodeType===1&&w.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?w.unique(s):s)},index:function(e){return e?typeof e=="string"?w.inArray(this[0],w(e)):w.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?w(e,t):w.makeArray(e&&e.nodeType?[e]:e),r=w.merge(this.get(),n);return this.pushStack(w.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return w.dir(e,"parentNode")},parentsUntil:function(e,t,n){return w.dir(e,"parentNode",n)},next:function(e){return ct(e,"nextSibling")},prev:function(e){return ct(e,"previousSibling")},nextAll:function(e){return w.dir(e,"nextSibling")},prevAll:function(e){return w.dir(e,"previousSibling")},nextUntil:function(e,t,n){return w.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return w.dir(e,"previousSibling",n)},siblings:function(e){return w.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return w.sibling(e.firstChild)},contents:function(e){return w.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:w.merge([],e.childNodes)}},function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return e.slice(-5)!=="Until"&&(r=n),r&&typeof r=="string"&&(i=w.filter(r,i)),this.length>1&&(lt[e]||(i=w.unique(i)),at.test(e)&&(i=i.reverse())),this.pushStack(i)}}),w.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),t.length===1&&r.nodeType===1?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return e.nodeType===1}))},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!w(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var dt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",vt=/ jQuery\d+="(?:null|\d+)"/g,mt=new RegExp("<(?:"+dt+")[\\s/>]","i"),gt=/^\s+/,yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,wt=/<tbody/i,Et=/<|&#?\w+;/,St=/<(?:script|style|link)/i,xt=/^(?:checkbox|radio)$/i,Tt=/checked\s*(?:[^=]|=\s*.checked.)/i,Nt=/^$|\/(?:java|ecma)script/i,Ct=/^true\/(.*)/,kt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Lt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:w.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},At=pt(o),Ot=At.appendChild(o.createElement("div"));Lt.optgroup=Lt.option,Lt.tbody=Lt.tfoot=Lt.colgroup=Lt.caption=Lt.thead,Lt.th=Lt.td,w.fn.extend({text:function(e){return w.access(this,function(e){return e===t?w.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Mt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Mt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?w.filter(e,this):this,i=0;for(;(n=r[i])!=null;i++)!t&&n.nodeType===1&&w.cleanData(jt(n)),n.parentNode&&(t&&w.contains(n.ownerDocument,n)&&Pt(jt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&w.cleanData(jt(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&w.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return w.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(vt,""):t;if(typeof e=="string"&&!St.test(e)&&(w.support.htmlSerialize||!mt.test(e))&&(w.support.leadingWhitespace||!gt.test(e))&&!Lt[(bt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(yt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(w.cleanData(jt(n,!1)),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=w.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),w(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=p.apply([],e);var r,i,s,o,u,a,f=0,l=this.length,c=this,h=l-1,d=e[0],v=w.isFunction(d);if(v||!(l<=1||typeof d!="string"||w.support.checkClone||!Tt.test(d)))return this.each(function(r){var i=c.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(l){a=w.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=a.firstChild,a.childNodes.length===1&&(a=r);if(r){o=w.map(jt(a,"script"),_t),s=o.length;for(;f<l;f++)i=a,f!==h&&(i=w.clone(i,!0,!0),s&&w.merge(o,jt(i,"script"))),t.call(this[f],i,f);if(s){u=o[o.length-1].ownerDocument,w.map(o,Dt);for(f=0;f<s;f++)i=o[f],Nt.test(i.type||"")&&!w._data(i,"globalEval")&&w.contains(u,i)&&(i.src?w._evalUrl(i.src):w.globalEval((i.text||i.textContent||i.innerHTML||"").replace(kt,"")))}a=r=null}}return this}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){var n,r=0,i=[],s=w(e),o=s.length-1;for(;r<=o;r++)n=r===o?this:this.clone(!0),w(s[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}}),w.extend({clone:function(e,t,n){var r,i,s,o,u,a=w.contains(e.ownerDocument,e);w.support.html5Clone||w.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(Ot.innerHTML=e.outerHTML,Ot.removeChild(s=Ot.firstChild));if((!w.support.noCloneEvent||!w.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!w.isXMLDoc(e)){r=jt(s),u=jt(e);for(o=0;(i=u[o])!=null;++o)r[o]&&Bt(i,r[o])}if(t)if(n){u=u||jt(e),r=r||jt(s);for(o=0;(i=u[o])!=null;o++)Ht(i,r[o])}else Ht(e,s);return r=jt(s,"script"),r.length>0&&Pt(r,!a&&jt(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l,c=e.length,h=pt(t),p=[],d=0;for(;d<c;d++){s=e[d];if(s||s===0)if(w.type(s)==="object")w.merge(p,s.nodeType?[s]:s);else if(!Et.test(s))p.push(t.createTextNode(s));else{u=u||h.appendChild(t.createElement("div")),a=(bt.exec(s)||["",""])[1].toLowerCase(),l=Lt[a]||Lt._default,u.innerHTML=l[1]+s.replace(yt,"<$1></$2>")+l[2],i=l[0];while(i--)u=u.lastChild;!w.support.leadingWhitespace&&gt.test(s)&&p.push(t.createTextNode(gt.exec(s)[0]));if(!w.support.tbody){s=a==="table"&&!wt.test(s)?u.firstChild:l[1]==="<table>"&&!wt.test(s)?u:0,i=s&&s.childNodes.length;while(i--)w.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}w.merge(p,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=h.lastChild}}u&&h.removeChild(u),w.support.appendChecked||w.grep(jt(p,"input"),Ft),d=0;while(s=p[d++]){if(r&&w.inArray(s,r)!==-1)continue;o=w.contains(s.ownerDocument,s),u=jt(h.appendChild(s),"script"),o&&Pt(u);if(n){i=0;while(s=u[i++])Nt.test(s.type||"")&&n.push(s)}}return u=null,h},cleanData:function(e,t){var n,r,s,o,u=0,a=w.expando,f=w.cache,l=w.support.deleteExpando,h=w.event.special;for(;(n=e[u])!=null;u++)if(t||w.acceptData(n)){s=n[a],o=s&&f[s];if(o){if(o.events)for(r in o.events)h[r]?w.event.remove(n,r):w.removeEvent(n,r,o.handle);f[s]&&(delete f[s],l?delete n[a]:typeof n.removeAttribute!==i?n.removeAttribute(a):n[a]=null,c.push(s))}}},_evalUrl:function(e){return w.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),w.fn.extend({wrapAll:function(e){if(w.isFunction(e))return this.each(function(t){w(this).wrapAll(e.call(this,t))});if(this[0]){var t=w(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return w.isFunction(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=w.isFunction(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){w.nodeName(this,"body")||w(this).replaceWith(this.childNodes)}).end()}});var It,qt,Rt,Ut=/alpha\([^)]*\)/i,zt=/opacity\s*=\s*([^)]*)/,Wt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Vt=/^margin/,$t=new RegExp("^("+E+")(.*)$","i"),Jt=new RegExp("^("+E+")(?!px)[a-z%]+$","i"),Kt=new RegExp("^([+-])=("+E+")","i"),Qt={BODY:"block"},Gt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];w.fn.extend({css:function(e,n){return w.access(this,function(e,n,r){var i,s,o={},u=0;if(w.isArray(n)){s=qt(e),i=n.length;for(;u<i;u++)o[n[u]]=w.css(e,n[u],!1,s);return o}return r!==t?w.style(e,n,r):w.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){return typeof e=="boolean"?e?this.show():this.hide():this.each(function(){nn(this)?w(this).show():w(this).hide()})}}),w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Rt(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":w.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=w.camelCase(n),f=e.style;n=w.cssProps[a]||(w.cssProps[a]=tn(f,a)),u=w.cssHooks[n]||w.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=Kt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(w.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!w.cssNumber[a]&&(r+="px"),!w.support.clearCloneStyle&&r===""&&n.indexOf("background")===0&&(f[n]="inherit");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=w.camelCase(n);return n=w.cssProps[a]||(w.cssProps[a]=tn(e.style,a)),u=w.cssHooks[n]||w.cssHooks[a],u&&"get"in u&&(o=u.get(e,!0,r)),o===t&&(o=Rt(e,n,i)),o==="normal"&&n in Yt&&(o=Yt[n]),r===""||r?(s=parseFloat(o),r===!0||w.isNumeric(s)?s||0:o):o}}),e.getComputedStyle?(qt=function(t){return e.getComputedStyle(t,null)},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u.getPropertyValue(n)||u[n]:t,f=e.style;return u&&(a===""&&!w.contains(e.ownerDocument,e)&&(a=w.style(e,n)),Jt.test(a)&&Vt.test(n)&&(i=f.width,s=f.minWidth,o=f.maxWidth,f.minWidth=f.maxWidth=f.width=a,a=u.width,f.width=i,f.minWidth=s,f.maxWidth=o)),a}):o.documentElement.currentStyle&&(qt=function(e){return e.currentStyle},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u[n]:t,f=e.style;return a==null&&f&&f[n]&&(a=f[n]),Jt.test(a)&&!Wt.test(n)&&(i=f.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),f.left=n==="fontSize"?"1em":a,a=f.pixelLeft+"px",f.left=i,o&&(s.left=o)),a===""?"auto":a}),w.each(["height","width"],function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&Xt.test(w.css(e,"display"))?w.swap(e,Gt,function(){return un(e,t,r)}):un(e,t,r)},set:function(e,n,r){var i=r&&qt(e);return sn(e,n,r?on(e,t,r,w.support.boxSizing&&w.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),w.support.opacity||(w.cssHooks.opacity={get:function(e,t){return zt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=w.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if((t>=1||t==="")&&w.trim(s.replace(Ut,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(t===""||r&&!r.filter)return}n.filter=Ut.test(s)?s.replace(Ut,i):s+" "+i}}),w(function(){w.support.reliableMarginRight||(w.cssHooks.marginRight={get:function(e,t){if(t)return w.swap(e,{display:"inline-block"},Rt,[e,"marginRight"])}}),!w.support.pixelPosition&&w.fn.position&&w.each(["top","left"],function(e,t){w.cssHooks[t]={get:function(e,n){if(n)return n=Rt(e,t),Jt.test(n)?w(e).position()[t]+"px":n}}})}),w.expr&&w.expr.filters&&(w.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!w.support.reliableHiddenOffsets&&(e.style&&e.style.display||w.css(e,"display"))==="none"},w.expr.filters.visible=function(e){return!w.expr.filters.hidden(e)}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+Zt[r]+t]=s[r]||s[r-2]||s[0];return i}},Vt.test(e)||(w.cssHooks[e+t].set=sn)});var ln=/%20/g,cn=/\[\]$/,hn=/\r?\n/g,pn=/^(?:submit|button|image|reset|file)$/i,dn=/^(?:input|select|textarea|keygen)/i;w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&dn.test(this.nodeName)&&!pn.test(e)&&(this.checked||!xt.test(e))}).map(function(e,t){var n=w(this).val();return n==null?null:w.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(hn,"\r\n")}}):{name:t.name,value:n.replace(hn,"\r\n")}}).get()}}),w.param=function(e,n){var r,i=[],s=function(e,t){t=w.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=w.ajaxSettings&&w.ajaxSettings.traditional);if(w.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){s(this.name,this.value)});else for(r in e)vn(r,e[r],n,s);return i.join("&").replace(ln,"+")},w.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});var mn,gn,yn=w.now(),bn=/\?/,wn=/#.*$/,En=/([?&])_=[^&]*/,Sn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,xn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Tn=/^(?:GET|HEAD)$/,Nn=/^\/\//,Cn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,kn=w.fn.load,Ln={},An={},On="*/".concat("*");try{gn=s.href}catch(Mn){gn=o.createElement("a"),gn.href="",gn=gn.href}mn=Cn.exec(gn.toLowerCase())||[],w.fn.load=function(e,n,r){if(typeof e!="string"&&kn)return kn.apply(this,arguments);var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),w.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(o="POST"),u.length>0&&w.ajax({url:e,type:o,dataType:"html",data:n}).done(function(e){s=arguments,u.html(i?w("<div>").append(w.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){u.each(r,s||[e.responseText,t,e])}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gn,type:"GET",isLocal:xn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":On,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":w.parseJSON,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Pn(Pn(e,w.ajaxSettings),t):Pn(w.ajaxSettings,e)},ajaxPrefilter:_n(Ln),ajaxTransport:_n(An),ajax:function(e,n){function N(e,n,r,i){var l,g,y,E,S,T=n;if(b===2)return;b=2,u&&clearTimeout(u),f=t,o=i||"",x.readyState=e>0?4:0,l=e>=200&&e<300||e===304,r&&(E=Hn(c,x,r)),E=Bn(c,E,x,l);if(l)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(w.lastModified[s]=S),S=x.getResponseHeader("etag"),S&&(w.etag[s]=S)),e===204||c.type==="HEAD"?T="nocontent":e===304?T="notmodified":(T=E.state,g=E.data,y=E.error,l=!y);else{y=T;if(e||!T)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[g,T,x]):d.rejectWith(h,[x,T,y]),x.statusCode(m),m=t,a&&p.trigger(l?"ajaxSuccess":"ajaxError",[x,c,l?g:y]),v.fireWith(h,[x,T]),a&&(p.trigger("ajaxComplete",[x,c]),--w.active||w.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=w.ajaxSetup({},n),h=c.context||c,p=c.context&&(h.nodeType||h.jquery)?w(h):w.event,d=w.Deferred(),v=w.Callbacks("once memory"),m=c.statusCode||{},g={},y={},b=0,E="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(b===2){if(!l){l={};while(t=Sn.exec(o))l[t[1].toLowerCase()]=t[2]}t=l[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return b===2?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return b||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(b<2)for(t in e)m[t]=[m[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||E;return f&&f.abort(t),N(0,t),this}};d.promise(x).complete=v.add,x.success=x.done,x.error=x.fail,c.url=((e||c.url||gn)+"").replace(wn,"").replace(Nn,mn[1]+"//"),c.type=n.method||n.type||c.method||c.type,c.dataTypes=w.trim(c.dataType||"*").toLowerCase().match(S)||[""],c.crossDomain==null&&(r=Cn.exec(c.url.toLowerCase()),c.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||(r[1]==="http:"?"80":"443"))===(mn[3]||(mn[1]==="http:"?"80":"443")))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=w.param(c.data,c.traditional)),Dn(Ln,c,n,x);if(b===2)return x;a=c.global,a&&w.active++===0&&w.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Tn.test(c.type),s=c.url,c.hasContent||(c.data&&(s=c.url+=(bn.test(s)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=En.test(s)?s.replace(En,"$1_="+yn++):s+(bn.test(s)?"&":"?")+"_="+yn++)),c.ifModified&&(w.lastModified[s]&&x.setRequestHeader("If-Modified-Since",w.lastModified[s]),w.etag[s]&&x.setRequestHeader("If-None-Match",w.etag[s])),(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+On+"; q=0.01":""):c.accepts["*"]);for(i in c.headers)x.setRequestHeader(i,c.headers[i]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&b!==2){E="abort";for(i in{success:1,error:1,complete:1})x[i](c[i]);f=Dn(An,c,n,x);if(!f)N(-1,"No Transport");else{x.readyState=1,a&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{b=1,f.send(g,N)}catch(T){if(!(b<2))throw T;N(-1,T)}}return x}return x.abort()},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,n){return w.get(e,t,n,"script")}}),w.each(["get","post"],function(e,n){w[n]=function(e,r,i,s){return w.isFunction(r)&&(s=s||i,i=r,r=t),w.ajax({url:e,type:n,dataType:s,data:r,success:i})}}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),w.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=o.head||w("head")[0]||o.documentElement;return{send:function(t,i){n=o.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){if(t||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var jn=[],Fn=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=jn.pop()||w.expando+"_"+yn++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.jsonp!==!1&&(Fn.test(n.url)?"url":typeof n.data=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fn.test(n.data)&&"data");if(a||n.dataTypes[0]==="jsonp")return s=n.jsonpCallback=w.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a?n[a]=n[a].replace(Fn,"$1"+s):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||w.error(s+" was not called"),u[0]},n.dataTypes[0]="json",o=e[s],e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,jn.push(s)),u&&w.isFunction(o)&&o(u[0]),u=o=t}),"script"});var In,qn,Rn=0,Un=e.ActiveXObject&&function(){var e;for(e in In)In[e](t,!0)};w.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&zn()||Wn()}:zn,qn=w.ajaxSettings.xhr(),w.support.cors=!!qn&&"withCredentials"in qn,qn=w.support.ajax=!!qn,qn&&w.ajaxTransport(function(n){if(!n.crossDomain||w.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=w.noop,Un&&delete In[o]);if(i)a.readyState!==4&&a.abort();else{c={},u=a.status,f=a.getAllResponseHeaders(),typeof a.responseText=="string"&&(c.text=a.responseText);try{l=a.statusText}catch(h){l=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(p){i||s(-1,p)}c&&s(u,l,c,f)},n.async?a.readyState===4?setTimeout(r):(o=++Rn,Un&&(In||(In={},w(e).unload(Un)),In[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Vn,$n=/^(?:toggle|show|hide)$/,Jn=new RegExp("^(?:([+-])=|)("+E+")([a-z%]*)$","i"),Kn=/queueHooks$/,Qn=[nr],Gn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Jn.exec(t),s=i&&i[3]||(w.cssNumber[e]?"":"px"),o=(w.cssNumber[e]||s!=="px"&&+r)&&Jn.exec(w.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,w.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&u!==1&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};w.Animation=w.extend(er,{tweener:function(e,t){w.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Gn[n]=Gn[n]||[],Gn[n].unshift(t)},prefilter:function(e,t){t?Qn.unshift(e):Qn.push(e)}}),w.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(w.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=w.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):e.elem.style&&(e.elem.style[w.cssProps[e.prop]]!=null||w.cssHooks[e.prop])?w.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),s=w.speed(t,n,r),o=function(){var t=er(this,w.extend({},e),s);(i||w._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=w.timers,o=w._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Kn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&w.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=w._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=w.timers,o=r?r.length:0;n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.speed=function(e,t,n){var r=e&&typeof e=="object"?w.extend({},e):{complete:n||!n&&t||w.isFunction(e)&&e,duration:e,easing:n&&t||t&&!w.isFunction(t)&&t};r.duration=w.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in w.fx.speeds?w.fx.speeds[r.duration]:w.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){w.isFunction(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},w.timers=[],w.fx=rr.prototype.init,w.fx.tick=function(){var e,n=w.timers,r=0;Xn=w.now();for(;r<n.length;r++)e=n[r],!e()&&n[r]===e&&n.splice(r--,1);n.length||w.fx.stop(),Xn=t},w.fx.timer=function(e){e()&&w.timers.push(e)&&w.fx.start()},w.fx.interval=13,w.fx.start=function(){Vn||(Vn=setInterval(w.fx.tick,w.fx.interval))},w.fx.stop=function(){clearInterval(Vn),Vn=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fx.step={},w.expr&&w.expr.filters&&(w.expr.filters.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length}),w.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){w.offset.setOffset(this,e,t)});var n,r,s={top:0,left:0},o=this[0],u=o&&o.ownerDocument;if(!u)return;return n=u.documentElement,w.contains(n,o)?(typeof o.getBoundingClientRect!==i&&(s=o.getBoundingClientRect()),r=sr(u),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):s},w.offset={setOffset:function(e,t,n){var r=w.css(e,"position");r==="static"&&(e.style.position="relative");var i=w(e),s=i.offset(),o=w.css(e,"top"),u=w.css(e,"left"),a=(r==="absolute"||r==="fixed")&&w.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),w.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},w.fn.extend({position:function(){if(!this[0])return;var e,t,n={top:0,left:0},r=this[0];return w.css(r,"position")==="fixed"?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),w.nodeName(e[0],"html")||(n=e.offset()),n.top+=w.css(e[0],"borderTopWidth",!0),n.left+=w.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-w.css(r,"marginTop",!0),left:t.left-n.left-w.css(r,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||u;while(e&&!w.nodeName(e,"html")&&w.css(e,"position")==="static")e=e.offsetParent;return e||u})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);w.fn[e]=function(i){return w.access(this,function(e,i,s){var o=sr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?w(o).scrollLeft():s,r?s:w(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),w.each({Height:"height",Width:"width"},function(e,n){w.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){w.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return w.access(this,function(n,r,i){var s;return w.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?w.css(n,r,u):w.style(n,r,i,u)},n,o?i:t,o,null)}})}),w.fn.size=function(){return this.length},w.fn.andSelf=w.fn.addBack,typeof module=="object"&&module&&typeof module.exports=="object"?module.exports=w:(e.jQuery=e.$=w,typeof define=="function"&&define.amd&&define("jquery",[],function(){return w}))})(window),function(e,t){function i(t,n){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(r=t.parentNode,i=r.name,!t.href||!i||r.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+i+"]")[0],!!o&&s(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var n=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,r){return typeof n=="number"?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i=r==="Width"?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}})}(jQuery),function(e,t){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=s(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function s(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(r.inline?t.parent()[0]:r.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).addClass("ui-datepicker-next-hover"))})}function o(t,n){e.extend(t,n);for(var r in n)n[r]==null&&(t[r]=n[r]);return t}e.extend(e.ui,{datepicker:{version:"1.10.3"}});var n="datepicker",r;e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return o(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i=r==="div"||r==="span",t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),r==="input"?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?s(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,r){var i=e(t);r.append=e([]),r.trigger=e([]);if(i.hasClass(this.markerClassName))return;this._attachments(i,r),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(r),e.data(t,n,r),r.settings.disabled&&this._disableDatepicker(t)},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),(r==="focus"||r==="both")&&t.focus(this._showDatepicker);if(r==="button"||r==="both")i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){n=0,r=0;for(i=0;i<e.length;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,r){var i=e(t);if(i.hasClass(this.markerClassName))return;i.addClass(this.markerClassName).append(r.dpDiv),e.data(t,n,r),this._setDate(r,this._getDefaultDate(r),!0),this._updateDatepicker(r),this._updateAlternate(r),r.settings.disabled&&this._disableDatepicker(t),r.dpDiv.css("display","block")},_dialogDatepicker:function(t,r,i,s,u){var a,f,l,c,h,p=this._dialogInst;return p||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],n,p)),o(p.settings,s||{}),r=r&&r.constructor===Date?this._formatDate(p,r):r,this._dialogInput.val(r),this._pos=u?u.length?u:[u.pageX,u.pageY]:null,this._pos||(f=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[f/2-100+c,l/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],n,p),this},_destroyDatepicker:function(t){var r,i=e(t),s=e.data(t,n);if(!i.hasClass(this.markerClassName))return;r=t.nodeName.toLowerCase(),e.removeData(t,n),r==="input"?(s.append.remove(),s.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(r==="div"||r==="span")&&i.removeClass(this.markerClassName).empty()},_enableDatepicker:function(t){var r,i,s=e(t),o=e.data(t,n);if(!s.hasClass(this.markerClassName))return;r=t.nodeName.toLowerCase();if(r==="input")t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(r==="div"||r==="span")i=s.children("."+this._inlineClass),i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e})},_disableDatepicker:function(t){var r,i,s=e(t),o=e.data(t,n);if(!s.hasClass(this.markerClassName))return;r=t.nodeName.toLowerCase();if(r==="input")t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(r==="div"||r==="span")i=s.children("."+this._inlineClass),i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,n)}catch(r){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(n,r,i){var s,u,a,f,l=this._getInst(n);if(arguments.length===2&&typeof r=="string")return r==="defaults"?e.extend({},e.datepicker._defaults):l?r==="all"?e.extend({},l.settings):this._get(l,r):null;s=r||{},typeof r=="string"&&(s={},s[r]=i),l&&(this._curInst===l&&this._hideDatepicker(),u=this._getDateDatepicker(n,!0),a=this._getMinMaxDate(l,"min"),f=this._getMinMaxDate(l,"max"),o(l.settings,s),a!==null&&s.dateFormat!==t&&s.minDate===t&&(l.settings.minDate=this._formatDate(l,a)),f!==null&&s.dateFormat!==t&&s.maxDate===t&&(l.settings.maxDate=this._formatDate(l,f)),"disabled"in s&&(s.disabled?this._disableDatepicker(n):this._enableDatepicker(n)),this._attachments(e(n),l),this._autoSize(l),this._setDate(l,u),this._updateAlternate(l),this._updateDatepicker(l))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");s._keyEvent=!0;if(e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else t.keyCode===36&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,r,i=e.datepicker._getInst(t.target);if(e.datepicker._get(i,"constrainInput"))return n=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),r=String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||r<" "||!n||n.indexOf(r)>-1},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){t=t.target||t,t.nodeName.toLowerCase()!=="input"&&(t=e("input",t.parentNode)[0]);if(e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)return;var n,r,i,s,u,a,f;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),i=r?r.apply(t,[t,n]):{};if(i===!1)return;o(n.settings,i),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),s=!1,e(t).parents().each(function(){return s|=e(this).css("position")==="fixed",!s}),u={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),u=e.datepicker._checkOffset(n,u,s),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":s?"fixed":"absolute",display:"none",left:u.left+"px",top:u.top+"px"}),n.inline||(a=e.datepicker._get(n,"showAnim"),f=e.datepicker._get(n,"duration"),n.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[a]?n.dpDiv.show(a,e.datepicker._get(n,"showOptions"),f):n.dpDiv[a||"show"](a?f:null),e.datepicker._shouldFocusInput(n)&&n.input.focus(),e.datepicker._curInst=n)},_updateDatepicker:function(t){this.maxRows=4,r=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var n,i=this._getNumberOfMonths(t),s=i[1],o=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),s>1&&t.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",o*s+"em"),t.dpDiv[(i[0]!==1||i[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){var n,r=this._getInst(t),i=this._get(r,"isRTL");while(t&&(t.type==="hidden"||t.nodeType!==1||e.expr.filters.hidden(t)))t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var r,i,s,o,u=this._curInst;if(!u||t&&u!==e.data(t,n))return;this._datepickerShowing&&(r=this._get(u,"showAnim"),i=this._get(u,"duration"),s=function(){e.datepicker._tidyDialog(u)},e.effects&&(e.effects.effect[r]||e.effects[r])?u.dpDiv.hide(r,e.datepicker._get(u,"showOptions"),i,s):u.dpDiv[r==="slideDown"?"slideUp":r==="fadeIn"?"fadeOut":"hide"](r?i:null,s),r||s(),this._datepickerShowing=!1,o=this._get(u,"onClose"),o&&o.apply(u.input?u.input[0]:null,[u.input?u.input.val():"",u]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(!e.datepicker._curInst)return;var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&n.parents("#"+e.datepicker._mainDivId).length===0&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);if(this._isDisabledDatepicker(i[0]))return;this._adjustInstDate(s,n+(r==="M"?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s)},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+(r==="M"?"Month":"Year")]=s["draw"+(r==="M"?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);if(e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0]))return;s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=n!=null?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],typeof s.input[0]!="object"&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,r){if(t==null||n==null)throw"Invalid arguments";n=typeof n=="object"?n.toString():n+"";if(n==="")return null;var i,s,o,u=0,a=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,f=typeof a!="string"?a:(new Date).getFullYear()%100+parseInt(a,10),l=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,c=(r?r.dayNames:null)||this._defaults.dayNames,h=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,p=(r?r.monthNames:null)||this._defaults.monthNames,d=-1,v=-1,m=-1,g=-1,y=!1,b,w=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},E=function(e){var t=w(e),r=e==="@"?14:e==="!"?20:e==="y"&&t?4:e==="o"?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=n.substring(u).match(i);if(!s)throw"Missing number at position "+u;return u+=s[0].length,parseInt(s[0],10)},S=function(t,r,i){var s=-1,o=e.map(w(t)?i:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});e.each(o,function(e,t){var r=t[1];if(n.substr(u,r.length).toLowerCase()===r.toLowerCase())return s=t[0],u+=r.length,!1});if(s!==-1)return s+1;throw"Unknown name at position "+u},x=function(){if(n.charAt(u)!==t.charAt(i))throw"Unexpected literal at position "+u;u++};for(i=0;i<t.length;i++)if(y)t.charAt(i)==="'"&&!w("'")?y=!1:x();else switch(t.charAt(i)){case"d":m=E("d");break;case"D":S("D",l,c);break;case"o":g=E("o");break;case"m":v=E("m");break;case"M":v=S("M",h,p);break;case"y":d=E("y");break;case"@":b=new Date(E("@")),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"!":b=new Date((E("!")-this._ticksTo1970)/1e4),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"'":w("'")?x():y=!0;break;default:x()}if(u<n.length){o=n.substr(u);if(!/^\s+/.test(o))throw"Extra/unparsed characters found in date: "+o}d===-1?d=(new Date).getFullYear():d<100&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=f?0:-100));if(g>-1){v=1,m=g;do{s=this._getDaysInMonth(d,v-1);if(m<=s)break;v++,m-=s}while(!0)}b=this._daylightSavingAdjust(new Date(d,v-1,m));if(b.getFullYear()!==d||b.getMonth()+1!==v||b.getDate()!==m)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=r+1<e.length&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))while(r.length<n)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;r<e.length;r++)if(h)e.charAt(r)==="'"&&!a("'")?h=!1:c+=e.charAt(r);else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=t.getTime()*1e4+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=t+1<e.length&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;t<e.length;t++)if(r)e.charAt(t)==="'"&&!i("'")?r=!1:n+=e.charAt(t);else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,n){return e.settings[n]!==t?e.settings[n]:this._defaults[n]},_setDateFromField:function(e,t){if(e.input.val()===e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);while(f){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=parseInt(f[1],10)*7;break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=n==null||n===""?r:typeof n=="string"?s(n):typeof n=="number"?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&o.toString()==="Invalid Date"?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!==e.selectedMonth||s!==e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()===""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-n,"M")},next:function(){e.datepicker._adjustDate(r,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){return e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=V[0]!==1||V[1]!==1,Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;Z<0&&(Z+=12,et--);if(Y){t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&t<G?G:t;while(this._daylightSavingAdjust(new Date(et,Z,1))>t)Z--,Z<0&&(Z=11,et--)}e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",E;for(S=0;S<V[0];S++){x="",this.maxRows=4;for(T=0;T<V[1];T++){N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="";if(K){k+="<div class='ui-datepicker-group";if(V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&S===0?U?s:r:"")+(/all|right/.test(C)&&S===0?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(E=0;E<7;E++)A=(E+l)%7,L+="<th"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M));for(H=0;H<D;H++){k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"";for(E=0;E<7;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&P<G||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+((!F||g)&&j[2]?" title='"+j[2].replace(/'/g,"&#39;")+"'":"")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(l=0;l<12;l++)(!a||l>=r.getMonth())&&(!f||l<=i.getMonth())&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}y||(b+=w+(s||!m||!g?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;d<=v;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}}return b+=this._get(e,"yearSuffix"),y&&(b+=(s||!m||!g?"&#xa0;":"")+w),b+="</div>",b},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n==="Y"?t:0),i=e.drawMonth+(n==="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n==="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n==="M"||n==="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10),u=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(o+=r),n[1].match(/[+\-].*/)&&(u+=r)),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||t.getFullYear()<=u)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),e("#"+e.datepicker._mainDivId).length===0&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return typeof t!="string"||t!=="isDisabled"&&t!=="getDate"&&t!=="widget"?t==="option"&&arguments.length===2&&typeof arguments[1]=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){typeof t=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.10.3"}(jQuery),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.5.1";var T=x.each=x.forEach=function(e,t,r){if(e==null)return;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?void 0:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t==null?x.identity:t);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=n==null?x.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,0,t):e[0]},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i=null;return function(){var s=this,o=arguments,u=function(){i=null,n||(r=e.apply(s,o))},a=n&&!i;return clearTimeout(i),i=setTimeout(u,t),a&&(r=e.apply(s,o)),r}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u))return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(e){return function(){var t,n;return t||e._}}(this)),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="1.0.0";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender||e.$,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=o.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,f=o.length;a<f;a++){e=o[a];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(c=0,h=s.length;c<h;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;typeof t=="object"&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=u.uniqueId("l"));return i[s]=t,typeof n=="object"&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(o,a);var p=o.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(t,d)),t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},j(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t;if(r&&(!n||!n.wait)&&!this.set(r,n))return!1;n=u.extend({validate:!0},n);if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);n.wait&&(t=u.extend(r||{},t));if(u.isObject(t)&&!a.set(t,n))return!1;f&&f(a,e,n),a.trigger("sync",a,e,n)},j(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;j(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||B();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t||{},{validationError:n})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];u.each(v,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var m=o.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};u.extend(m.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.defaults(t||{},y))},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},set:function(e,t){t=u.defaults(t||{},g),t.parse&&(e=this.parse(e,t)),u.isArray(e)||(e=e?[e]:[]);var n,i,o,a,f,l,c=t.at,h=this.comparator&&c==null&&t.sort!==!1,p=u.isString(this.comparator)?this.comparator:null,d=[],v=[],m={};for(n=0,i=e.length;n<i;n++){if(!(o=this._prepareModel(e[n],t)))continue;(f=this.get(o))?(t.remove&&(m[f.cid]=!0),t.merge&&(f.set(o.attributes,t),h&&!l&&f.hasChanged(p)&&(l=!0))):t.add&&(d.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o))}if(t.remove){for(n=0,i=this.length;n<i;++n)m[(o=this.models[n]).cid]||v.push(o);v.length&&this.remove(v,t)}d.length&&(h&&(l=!0),this.length+=d.length,c!=null?s.apply(this.models,[c,0].concat(d)):r.apply(this.models,d)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,i=d.length;n<i;n++)(o=d[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(b,function(e){m.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var w=["groupBy","countBy","sortBy"];u.each(w,function(e){m.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var E=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];u.extend(E.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(S),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,x)),this.options=e},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}}),o.sync=function(e,t,n){var r=T[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||B()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled)&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,a,n),a};var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var N=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(e,t,n){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return o.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),o.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=u.result(this,"routes");var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=D.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(_,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!O.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new O;var H=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=m.extend=N.extend=E.extend=O.extend=H;var B=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),define("backbone",["jquery","underscore"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),function(e,t){if(typeof exports=="object"){var n=require("underscore"),r=require("backbone");module.exports=t(n,r)}else typeof define=="function"&&define.amd&&define("backbone.wreqr",["underscore","backbone"],t)}(this,function(e,t){return t.Wreqr=function(e,t,n){var r={};return r.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var r=null;t.isObject(e)&&!t.isFunction(e)&&(r=e.context,e=e.callback),this.setHandler(n,e,r)},this)},setHandler:function(e,t,n){var r={callback:t,context:n};this._wreqrHandlers[e]=r,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(!t)throw new Error("Handler not found for '"+e+"'");return function(){var e=Array.prototype.slice.apply(arguments);return t.callback.apply(t.context,e)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,n),r.CommandStorage=function(){var t=function(e){this.options=e,this._commands={},n.isFunction(this.initialize)&&this.initialize(e)};return n.extend(t.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),t}(),r.Commands=function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,n)},execute:function(e,t){e=arguments[0],t=Array.prototype.slice.call(arguments,1),this.hasHandler(e)?this.getHandler(e).apply(this,t):this.storage.addCommand(e,t)},_executeCommands:function(e,t,r){var i=this.storage.getCommands(e);n.each(i.instances,function(e){t.apply(r,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var t,r=e.storageType||this.storageType;n.isFunction(r)?t=new r:t=r,this.storage=t}})}(r),r.RequestResponse=function(e){return e.Handlers.extend({request:function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return this.getHandler(e).apply(this,t)}})}(r),r.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,n),r}(t,t.Marionette,e),t.Wreqr}),function(e,t){if(typeof exports=="object"){var n=require("underscore"),r=require("backbone");module.exports=t(n,r)}else typeof define=="function"&&define.amd&&define("backbone.babysitter",["underscore","backbone"],t)}(this,function(e,t){"option strict";return t.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength()},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){if(e===n)return delete this._indexByCustom[t],!0},this),delete this._views[n],this._updateLength()},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(r){t.isFunction(r[e])&&r[e].apply(r,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var r=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return t.each(r,function(e){n.prototype[e]=function(){var n=t.values(this._views),r=[n].concat(t.toArray(arguments));return t[e].apply(t,r)}}),n}(t,e),t.ChildViewContainer}),function(e,t){if(typeof exports=="object"){var n=require("underscore"),r=require("backbone"),i=require("backbone.wreqr"),s=require("backbone.babysitter");module.exports=t(n,r,i,s)}else typeof define=="function"&&define.amd&&define("marionette",["underscore","backbone","backbone.wreqr","backbone.babysitter"],t)}(this,function(e,t){var n=function(e,t,n){function s(e){return i.call(e)}function o(e,t){var n=new Error(e);throw n.name=t||"Error",n}var r={};t.Marionette=r,r.$=t.$;var i=Array.prototype.slice;return r.extend=t.Model.extend,r.getOption=function(e,t){if(!e||!t)return;var n;return e.options&&t in e.options&&e.options[t]!==undefined?n=e.options[t]:n=e[t],n},r.triggerMethod=function(){function t(e,t,n){return n.toUpperCase()}var e=/(^|:)(\w)/gi,r=function(r){var i="on"+r.replace(e,t),s=this[i];n.isFunction(this.trigger)&&this.trigger.apply(this,arguments);if(n.isFunction(s))return s.apply(this,n.tail(arguments))};return r}(),r.MonitorDOMRefresh=function(){function e(e){e._isShown=!0,r(e)}function t(e){e._isRendered=!0,r(e)}function r(e){e._isShown&&e._isRendered&&n.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}return function(n){n.listenTo(n,"show",function(){e(n)}),n.listenTo(n,"render",function(){t(n)})}}(),function(e){function t(e,t,r,i){var s=i.split(/\s+/);n.each(s,function(n){var i=e[n];i||o("Method '"+n+"' was configured as an event handler, but does not exist."),e.listenTo(t,r,i,e)})}function r(e,t,n,r){e.listenTo(t,n,r,e)}function i(e,t,r,i){var s=i.split(/\s+/);n.each(s,function(n){var i=e[n];e.stopListening(t,r,i,e)})}function s(e,t,n,r){e.stopListening(t,n,r,e)}function u(e,t,r,i,s){if(!t||!r)return;n.isFunction(r)&&(r=r.call(e)),n.each(r,function(r,o){n.isFunction(r)?i(e,t,o,r):s(e,t,o,r)})}e.bindEntityEvents=function(e,n,i){u(e,n,i,r,t)},e.unbindEntityEvents=function(e,t,n){u(e,t,n,s,i)}}(r),r.Callbacks=function(){this._deferred=r.$.Deferred(),this._callbacks=[]},n.extend(r.Callbacks.prototype,{add:function(e,t){this._callbacks.push({cb:e,ctx:t}),this._deferred.done(function(n,r){t&&(n=t),e.call(n,r)})},run:function(e,t){this._deferred.resolve(t,e)},reset:function(){var e=this._callbacks;this._deferred=r.$.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),r.Controller=function(e){this.triggerMethod=r.triggerMethod,this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},r.Controller.extend=r.extend,n.extend(r.Controller.prototype,t.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),r.Region=function(e){this.options=e||{},this.el=r.getOption(this,"el");if(!this.el){var t=new Error("An 'el' must be specified for a region.");throw t.name="NoElError",t}if(this.initialize){var n=Array.prototype.slice.apply(arguments);this.initialize.apply(this,n)}},n.extend(r.Region,{buildRegion:function(e,t){var r=typeof e=="string",i=typeof e.selector=="string",s=typeof e.regionType=="undefined",o=typeof e=="function";if(!o&&!r&&!i)throw new Error("Region must be specified as a Region type, a selector string or an object with selector property");var u,a;r&&(u=e),e.selector&&(u=e.selector),o&&(a=e),!o&&s&&(a=t),e.regionType&&(a=e.regionType);var f=new a({el:u});return e.parentEl&&(f.getEl=function(t){var r=e.parentEl;return n.isFunction(r)&&(r=r()),r.find(t)}),f}}),n.extend(r.Region.prototype,t.Events,{show:function(e){this.ensureEl();var t=e.isClosed||n.isUndefined(e.$el),i=e!==this.currentView;i&&this.close(),e.render(),(i||t)&&this.open(e),this.currentView=e,r.triggerMethod.call(this,"show",e),r.triggerMethod.call(e,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0)this.$el=this.getEl(this.el)},getEl:function(e){return r.$(e)},open:function(e){this.$el.empty().append(e.el)},close:function(){var e=this.currentView;if(!e||e.isClosed)return;e.close?e.close():e.remove&&e.remove(),r.triggerMethod.call(this,"close"),delete this.currentView},attachView:function(e){this.currentView=e},reset:function(){this.close(),delete this.$el}}),r.Region.extend=r.extend,r.RegionManager=function(e){var t=e.Controller.extend({constructor:function(t){this._regions={},e.Controller.prototype.constructor.call(this,t)},addRegions:function(e,t){var r={};return n.each(e,function(e,i){typeof e=="string"&&(e={selector:e}),e.selector&&(e=n.defaults({},e,t));var s=this.addRegion(i,e);r[i]=s},this),r},addRegion:function(t,r){var i,s=n.isObject(r),o=n.isString(r),u=!!r.selector;return o||s&&u?i=e.Region.buildRegion(r,e.Region):n.isFunction(r)?i=e.Region.buildRegion(r,e.Region):i=r,this._store(t,i),this.triggerMethod("region:add",t,i),i},get:function(e){return this._regions[e]},removeRegion:function(e){var t=this._regions[e];this._remove(e,t)},removeRegions:function(){n.each(this._regions,function(e,t){this._remove(t,e)},this)},closeRegions:function(){n.each(this._regions,function(e,t){e.close()},this)},close:function(){this.removeRegions();var t=Array.prototype.slice.call(arguments);e.Controller.prototype.close.apply(this,t)},_store:function(e,t){this._regions[e]=t,this._setLength()},_remove:function(e,t){t.close(),delete this._regions[e],this._setLength(),this.triggerMethod("region:remove",e,t)},_setLength:function(){this.length=n.size(this._regions)}}),r=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return n.each(r,function(e){t.prototype[e]=function(){var t=n.values(this._regions),r=[t].concat(n.toArray(arguments));return n[e].apply(n,r)}}),t}(r),r.TemplateCache=function(e){this.templateId=e},n.extend(r.TemplateCache,{templateCaches:{},get:function(e){var t=this.templateCaches[e];return t||(t=new r.TemplateCache(e),this.templateCaches[e]=t),t.load()},clear:function(){var e,t=s(arguments),n=t.length;if(n>0)for(e=0;e<n;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(r.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(e),this.compiledTemplate},loadTemplate:function(e){var t=r.$(e).html();return(!t||t.length===0)&&o("Could not find template: '"+e+"'","NoTemplateError"),t},compileTemplate:function(e){return n.template(e)}}),r.Renderer={render:function(e,t){if(!e){var n=new Error("Cannot render the template since it's false, null or undefined.");throw n.name="TemplateNotFoundError",n}var i;return typeof e=="function"?i=e:i=r.TemplateCache.get(e),i(t)}},r.View=t.View.extend({constructor:function(){n.bindAll(this,"render");var e=Array.prototype.slice.apply(arguments);t.View.prototype.constructor.apply(this,e),r.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:r.triggerMethod,getTemplate:function(){return r.getOption(this,"template")},mixinTemplateHelpers:function(e){e=e||{};var t=r.getOption(this,"templateHelpers");return n.isFunction(t)&&(t=t.call(this)),n.extend(e,t)},configureTriggers:function(){if(!this.triggers)return;var e={},t=n.result(this,"triggers");return n.each(t,function(t,n){e[n]=function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation();var n={view:this,model:this.model,collection:this.collection};this.triggerMethod(t,n)}},this),e},delegateEvents:function(e){this._delegateDOMEvents(e),r.bindEntityEvents(this,this.model,r.getOption(this,"modelEvents")),r.bindEntityEvents(this,this.collection,r.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(e){e=e||this.events,n.isFunction(e)&&(e=e.call(this));var r={},i=this.configureTriggers();n.extend(r,e,i),t.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){var e=Array.prototype.slice.call(arguments);t.View.prototype.undelegateEvents.apply(this,e),r.unbindEntityEvents(this,this.model,r.getOption(this,"modelEvents")),r.unbindEntityEvents(this,this.collection,r.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed)return;var e=this.triggerMethod("before:close");if(e===!1)return;this.isClosed=!0,this.triggerMethod("close"),this.unbindUIElements(),this.remove()},bindUIElements:function(){if(!this.ui)return;this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(n.keys(e),function(t){var n=e[t];this.ui[t]=this.$(n)},this)},unbindUIElements:function(){if(!this.ui||!this._uiBindings)return;n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings}}),r.ItemView=r.View.extend({constructor:function(){r.View.prototype.constructor.apply(this,s(arguments))},serializeData:function(){var e={};return this.model?e=this.model.toJSON():this.collection&&(e={items:this.collection.toJSON()}),e},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var e=this.serializeData();e=this.mixinTemplateHelpers(e);var t=this.getTemplate(),n=r.Renderer.render(t,e);return this.$el.html(n),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){if(this.isClosed)return;this.triggerMethod("item:before:close"),r.View.prototype.close.apply(this,s(arguments)),this.triggerMethod("item:closed")}}),r.CollectionView=r.View.extend({itemViewEventPrefix:"itemview",constructor:function(e){this._initChildViewStorage(),r.View.prototype.constructor.apply(this,s(arguments)),this._initialEvents()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(e,t,n){this.closeEmptyView();var r=this.getItemView(e),i=this.collection.indexOf(e);this.addItemView(e,r,i)},onShowCalled:function(){this.children.each(function(e){r.triggerMethod.call(e,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.closeEmptyView(),this.closeChildren(),this.collection&&this.collection.length>0?this.showCollection():this.showEmptyView()},showCollection:function(){var e;this.collection.each(function(t,n){e=this.getItemView(t),this.addItemView(t,e,n)},this)},showEmptyView:function(){var e=r.getOption(this,"emptyView");if(e&&!this._showingEmptyView){this._showingEmptyView=!0;var n=new t.Model;this.addItemView(n,e,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getItemView:function(e){var t=r.getOption(this,"itemView");return t||o("An `itemView` must be specified","NoItemViewError"),t},addItemView:function(e,t,i){var s=r.getOption(this,"itemViewOptions");n.isFunction(s)&&(s=s.call(this,e,i));var o=this.buildItemView(e,t,s);this.addChildViewEventForwarding(o),this.triggerMethod("before:item:added",o),this.children.add(o),this.renderItemView(o,i),this._isShown&&r.triggerMethod.call(o,"show"),this.triggerMethod("after:item:added",o)},addChildViewEventForwarding:function(e){var t=r.getOption(this,"itemViewEventPrefix");this.listenTo(e,"all",function(){var n=s(arguments);n[0]=t+":"+n[0],n.splice(1,0,e),r.triggerMethod.apply(this,n)},this)},renderItemView:function(e,t){e.render(),this.appendHtml(this,e,t)},buildItemView:function(e,t,r){var i=n.extend({model:e},r);return new t(i)},removeItemView:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},removeChildView:function(e){e&&(this.stopListening(e),e.close?e.close():e.remove&&e.remove(),this.children.remove(e)),this.triggerMethod("item:removed",e)},checkEmpty:function(){(!this.collection||this.collection.length===0)&&this.showEmptyView()},appendHtml:function(e,t,n){e.$el.append(t.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},close:function(){if(this.isClosed)return;this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),r.View.prototype.close.apply(this,s(arguments))},closeChildren:function(){this.children.each(function(e){this.removeChildView(e)},this),this.checkEmpty()}}),r.CompositeView=r.CollectionView.extend({constructor:function(){r.CollectionView.prototype.constructor.apply(this,s(arguments))},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))},getItemView:function(e){var t=r.getOption(this,"itemView")||this.constructor;return t||o("An `itemView` must be specified","NoItemViewError"),t},serializeData:function(){var e={};return this.model&&(e=this.model.toJSON()),e},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var e=this.renderModel();return this.$el.html(e),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(r.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e);var t=this.getTemplate();return r.Renderer.render(t,e)},appendHtml:function(e,t,n){var r=this.getItemViewContainer(e);r.append(t.el)},getItemViewContainer:function(e){if("$itemViewContainer"in e)return e.$itemViewContainer;var t,i=r.getOption(e,"itemViewContainer");if(i){var s=n.isFunction(i)?i():i;t=e.$(s),t.length<=0&&o("The specified `itemViewContainer` was not found: "+e.itemViewContainer,"ItemViewContainerMissingError")}else t=e.$el;return e.$itemViewContainer=t,t},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),r.Layout=r.ItemView.extend({regionType:r.Region,constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),r.ItemView.prototype.constructor.call(this,e)},render:function(){this.isClosed&&this._initializeRegions(),this._firstRender?this._firstRender=!1:this.isClosed||this._reInitializeRegions();var e=Array.prototype.slice.apply(arguments),t=r.ItemView.prototype.render.apply(this,e);return t},close:function(){if(this.isClosed)return;this.regionManager.close();var e=Array.prototype.slice.apply(arguments);r.ItemView.prototype.close.apply(this,e)},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},_buildRegions:function(e){var t=this,n={regionType:r.getOption(this,"regionType"),parentEl:function(){return t.$el}};return this.regionManager.addRegions(e,n)},_initializeRegions:function(e){var t;this._initRegionManager(),n.isFunction(this.regions)?t=this.regions(e):t=this.regions||{},this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(e){e.reset()})},_initRegionManager:function(){this.regionManager=new r.RegionManager,this.listenTo(this.regionManager,"region:add",function(e,t){this[e]=t,this.trigger("region:add",e,t)}),this.listenTo(this.regionManager,"region:remove",function(e,t){delete this[e],this.trigger("region:remove",e,t)})}}),r.AppRouter=t.Router.extend({constructor:function(e){t.Router.prototype.constructor.apply(this,s(arguments)),this.options=e||{};var n=r.getOption(this,"appRoutes"),i=this._getController();this.processAppRoutes(i,n)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},processAppRoutes:function(e,t){if(!t)return;var r=n.keys(t).reverse();n.each(r,function(n){this._addAppRoute(e,n,t[n])},this)},_getController:function(){return r.getOption(this,"controller")},_addAppRoute:function(e,t,r){var i=e[r];if(!i)throw new Error("Method '"+r+"' was not found on the controller");this.route(t,r,n.bind(i,e))}}),r.Application=function(e){this._initRegionManager(),this._initCallbacks=new r.Callbacks,this.vent=new t.Wreqr.EventAggregator,this.commands=new t.Wreqr.Commands,this.reqres=new t.Wreqr.RequestResponse,this.submodules={},n.extend(this,e),this.triggerMethod=r.triggerMethod},n.extend(r.Application.prototype,t.Events,{execute:function(){var e=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,e)},request:function(){var e=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,e)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("initialize:before",e),this._initCallbacks.run(e,this),this.triggerMethod("initialize:after",e),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(e){this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},module:function(e,t){var n=s(arguments);return n.unshift(this),r.Module.create.apply(r.Module,n)},_initRegionManager:function(){this._regionManager=new r.RegionManager,this.listenTo(this._regionManager,"region:add",function(e,t){this[e]=t}),this.listenTo(this._regionManager,"region:remove",function(e,t){delete this[e]})}}),r.Application.extend=r.extend,r.Module=function(e,t){this.moduleName=e,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,this.startWithParent=!0,this.triggerMethod=r.triggerMethod},n.extend(r.Module.prototype,t.Events,{addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){if(this._isInitialized)return;n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e)},stop:function(){if(!this._isInitialized)return;this._isInitialized=!1,r.triggerMethod.call(this,"before:stop"),n.each(this.submodules,function(e){e.stop()}),this._finalizerCallbacks.run(undefined,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),r.triggerMethod.call(this,"stop")},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,i){if(!e)return;var s=n.flatten([this,this.app,t,r,r.$,n,i]);e.apply(this,s)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new r.Callbacks,this._finalizerCallbacks=new r.Callbacks}}),n.extend(r.Module,{create:function(e,t,r){var i=e,o=s(arguments);o.splice(0,3),t=t.split(".");var u=t.length,a=[];return a[u-1]=r,n.each(t,function(t,n){var r=i;i=this._getModule(r,t,e),this._addModuleDefinition(r,i,a[n],o)},this),i},_getModule:function(e,t,n,i,s){var o=e[t];return o||(o=new r.Module(t,n),e[t]=o,e.submodules[t]=o),o},_addModuleDefinition:function(e,t,r,i){var s,o;n.isFunction(r)?(s=r,o=!0):n.isObject(r)?(s=r.define,o=r.startWithParent):o=!0,s&&t.addDefinition(s,i),t.startWithParent=t.startWithParent&&o,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),r}(this,t,e);return t.Marionette}),define("app",["marionette"],function(e,t){var n=new e.Application;return n}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!templates/shared/footer.html",[],function(){return'<nav>\r\n    <ul class="clearfix">\r\n        <li class="footerItem"><a class="footerLink btnTermsPrivacy" href="#">Terms &amp; Privacy</a></li>\r\n        <li class="footerItem"><a class="footerLink btnContactUs" href="#">Contact Us</a></li>\r\n    </ul>\r\n</nav>'}),define("views/shared/footer",["marionette","underscore","text!templates/shared/footer.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n),events:{"click .btnContactUs":"gotToContactUs","click .btnTermsPrivacy":"gotToTermsPrivacy"},gotToContactUs:function(e){app.router.navigate("contact-us",{trigger:!0}),e.preventDefault()},gotToTermsPrivacy:function(e){app.router.navigate("terms-privacy",{trigger:!0}),e.preventDefault()}});return r}),define("text!templates/shared/error.html",[],function(){return'<div class="roundedBox">\r\n    <div class="roundedBoxRow">\r\n        <div href="#" class="reservationData">\r\n            <h3 class="reservationDataTitle confirmed">Error</h3>\r\n            <p><%= error %></p>\r\n        </div>\r\n    </div>    \r\n    <div class="roundedBoxRow">\r\n        <div class="reservationButtons">            \r\n            <div class="reservationButtonHolder">\r\n                <a href="#" class="btnSoft btnRefresh">Refresh</a>\r\n            </div>\r\n            <div class="reservationButtonHolder">\r\n                <a href="#" class="btnSoft btnHome">Home</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}),define("views/shared/error",["marionette","backbone","underscore","app","text!templates/shared/error.html"],function(e,t,n,r,i){var s=e.ItemView.extend({template:n.template(i),events:{"click .btnRefresh":"btnRefreshClick","click .btnHome":"btnHomeClick"},serializeData:function(){return{error:this.options.error||"An error has occurred, please try refresh data"}},btnRefreshClick:function(e){e.preventDefault();var n=t.history.fragment;t.history.fragment!=null&&(t.history.fragment=null,t.history.navigate(n,!0))},btnHomeClick:function(e){e.preventDefault(),r.router.navigate("",{trigger:!0})}});return s}),define("text!templates/shared/404.html",[],function(){return'<div class="roundedBoxRow">\r\n    <div href="#" class="reservationData">\r\n        <h3 class="reservationDataTitle confirmed">404</h3>\r\n        <p>Page not found</p>\r\n    </div>\r\n</div>    \r\n<div class="roundedBoxRow">\r\n    <div class="reservationButtons">            \r\n            <a href="#" class="btnSoft btnHome">Home</a>\r\n    </div>\r\n</div>'}),define("views/shared/404",["app","marionette","underscore","text!templates/shared/404.html"],function(e,t,n,r){var i=t.ItemView.extend({template:n.template(r),className:"roundedBox",events:{"click .btnHome":"btnHomeClick"},btnHomeClick:function(t){t.preventDefault(),e.router.navigate("",{trigger:!0})}});return i}),define("views/shared/loading",["marionette","underscore"],function(e,t){var n=e.ItemView.extend({template:t.template('<img src="/img/spinner.gif" />')});return n}),define("modules/helper",["underscore","app"],function(e,t){function i(e){switch(e){case 1:return"1st";case 2:return"2nd";default:return e+"th"}}var n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=["Sunday","Monday","Tuesday ","Wednesday","Thursday","Friday","Saturday"];return t.module("Helper",function(t){function s(e){var t=String(e);return t.length===1&&(t="0"+t),t}e.extend(t,{formatDateForApi:function(e,t){var e=new Date(e);t&&e.setHours(e.getHours()-t);var n=e.getFullYear()+"-"+s(e.getMonth()+1)+"-"+s(e.getDate());return t?n+"T"+s(e.getHours())+":"+s(e.getMinutes())+":"+s(e.getSeconds())+"Z":n},newDate:function(e,t){var n=new Date(e);return n.setHours(n.getUTCHours()+t),n},formatTime:function(e,t){if(typeof t=="undefined")if(typeof e=="string")var n=e.split(":"),e=parseInt(n[0],10),t=parseInt(n[1],10);else typeof e=="object"&&(t=e.getMinutes(),e=e.getHours());var r=e<12,i=r?e:e-12;r&&i==0&&(i=12),!r&&i==0&&(i=12);var s=t<10?"0"+t:t;return{value:e+":"+s,textSimple:i+":"+s,amText:r?"a":"p",amTextFull:r?"am":"pm",valueSimpleAmTextFull:i+":"+s+(r?"am":"pm")}},formatDate:function(e){return typeof e=="string"?e:e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},parseDate:function(e,t){var n=new RegExp("([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})");if(typeof e!="string")return null;if(n.test(e)){var r=n.exec(e),i=t?t.split(":"):null;return r.length==4?new Date(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),i?parseInt(i[0],10):null,i?parseInt(i[1],10):null):new Date(e+t?" "+t:"")}},formatDateLong:function(e){return typeof e=="string"&&(e=new Date(e)),n[e.getMonth()]+" "+i(e.getDate())+", "+e.getFullYear()},formatDateShort:function(e){return typeof e=="string"&&(e=new Date(e)),r[e.getDay()]+" "+n[e.getMonth()]+" "+i(e.getDate())},formatDateShort2:function(e,t){return typeof e=="string"&&(e=new Date(e)),t&&e.setHours(e.getUTCHours()+t),r[e.getDay()].substr(0,3)+", "+n[e.getMonth()]+" "+i(e.getDate())},formatDateShort3:function(e){return typeof e=="string"&&(e=new Date(e)),r[e.getDay()].substr(0,3)+" "+n[e.getMonth()]+", "+i(e.getDate())},getDayOfWeek:function(e,t){return r[e].substr(0,t)},formatDateRelative:function(e,t){typeof e=="string"&&(e=new Date(e));var n=new Date;return n.getDate()==e.getDate()&&n.getMonth()==e.getMonth()&&n.getFullYear()==e.getFullYear()?"Today":(n.setDate(n.getDate()+1),n.getDate()==e.getDate()&&n.getMonth()==e.getMonth()&&n.getFullYear()==e.getFullYear()?"Tomorrow":t?this.formatDateShort3(e):this.formatDate(e))},equalDates:function(e,t){return typeof e=="string"&&(e=new Date(e)),typeof t=="string"&&(t=new Date(t)),e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()},getErrorMessage:function(e){if(e.responseText&&e.responseText.length>0){var t=JSON.parse(e.responseText);return t.error?typeof t.error=="string"?t.error:t.error[0]:null}return null},getTimes:function(e,t,n){var r=[],i,s=new Date;t==null&&(t=new Date,t.setHours(0),t.setMinutes(0)),n==null&&(n=new Date,n.setHours(23),n.setMinutes(45)),i=e.getDate()==s.getDate()&&e.getMonth()==s.getMonth()&&e.getFullYear()==s.getFullYear();var o=new Date;o.setHours(19),o.setMinutes(0);if(i){o=this.newDate(new Date,-5);var u=o.getMinutes();u!=0&&u!=15&&u!=30&&u!=45&&(u>0&&u<15?u=15:u>15&&u<30?u=30:u>30&&u<45?u=45:u=60,o.setMinutes(u)),t=new Date(o)}while(t<=n){var a={},f=t.getHours(),l=t.getMinutes(),c=f<12;f==o.getHours()&&l==o.getMinutes()&&(a.selected=!0),f=c?f:f-12,c&&f==0&&(f=12),!c&&f==0&&(f=12),l=l<10?"0"+l:l,a.text=f+":"+l+(c?"a":"p"),a.value=t.getHours()+":"+l,r.push(a),t.setMinutes(t.getMinutes()+15)}return r},formatPhone:function(e){return e.length>5?["(",e.substr(0,3),") ",e.substr(3,3),"-",e.substr(6)].join(""):e},stringSearch:function(e,t){var n=[{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xC7-\xE7]/g,ch:"c"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}];return $.each(n,function(){t=t.replace(this.re,this.ch),e=e.replace(this.re,this.ch)}),t.toUpperCase().indexOf(e.toUpperCase())>=0}})})}),define("models/topBar",["backbone"],function(e){var t=e.Model.extend({defaults:{leftText:"Home",rightText:"",title:""}});return t}),define("text!templates/shared/topBar.html",[],function(){return'<div class="topBarInner">    \r\n    <% if (typeof(leftUrl) != "undefined") { %>    \r\n        <a class="topBarLink linkLeft <%= (typeof(leftCss) != \'undefined\') ? rightCss : \'\' %>" href="#"><%= leftText %></a>\r\n    <%}  else { %>\r\n    <span/>\r\n    <% } if (typeof(rightUrl) != "undefined") {%>\r\n        <a class="topBarLink linkRight <%= (typeof(rightCss) != \'undefined\') ? rightCss : \'\' %>" href="#"><%= rightText %></a>\r\n    <% }%>\r\n    <div class="topBarHolder">\r\n        <% if (typeof(subTitle) != "undefined") { %>\r\n            <p class="topBarSubTitle"><%= subTitle %></p>\r\n        <% } %>\r\n        <h1 class="topBarTitle"><%= title %>\r\n            <% if (typeof(topBarTitleText) != "undefined") { %>\r\n                <span class="topBarTitleText"><%= topBarTitleText %></span>\r\n            <% } %>\r\n        </h1>\r\n    </div>\r\n</div>'}),define("views/shared/topBar",["app","marionette","underscore","text!templates/shared/topBar.html"],function(e,t,n,r){var i=t.ItemView.extend({template:n.template(r),events:{"click .linkLeft":"btnLeftClick","click .linkRight":"btnRightClick"},ui:{linkRight:".linkRight",topBarTitleText:".topBarTitleText"},btnLeftClick:function(e){var t=this.model.get("leftUrl");this.options.leftClickEvent?this.trigger(this.options.leftClickEvent,t):this.goToPage(t),e.preventDefault()},btnRightClick:function(e){var t=this.model.get("rightUrl");this.options.rightClickEvent?this.trigger(this.options.rightClickEvent,t):this.goToPage(t),e.preventDefault()},goToPage:function(t){e.router.navigate(t,{trigger:!0})},hideRightButton:function(){this.ui.linkRight.hide()},showRightButton:function(){this.ui.linkRight.show()},changeTopBarTitleText:function(e){this.ui.topBarTitleText.text(e)}});return i}),define("text!templates/forgotPassword/content.html",[],function(){return'<!-- Reset Password -->\r\n<section class="resetPass">\r\n    <div class="resetPassHeader">\r\n        <h2 class="title"><span class="titleText">Forgot your password?</span></h2>\r\n        <p>Please enter your email address.</p>\r\n        <p>You will be sent a link to change your password.</p>\r\n    </div>\r\n    <div class="form">\r\n        <form action="#">\r\n            <div class="row">\r\n                <label class="labelForm">Email</label>\r\n                <input class="textField" type="email" />\r\n            </div>\r\n            <div class="row">\r\n                <input class="btn" type="submit" value="Submit" />\r\n            </div>\r\n            <div class="helpLink">\r\n                <a href="#" class="btnSignUp">Sign up for free</a>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</section>\r\n'}),define("views/forgotPassword/forgotPassword",["marionette","underscore","text!templates/forgotPassword/content.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n),events:{"click .btnSignUp":"goToSignUp"},goToSignUp:function(e){app.router.navigate("signup",{trigger:!0}),e.preventDefault()}});return r}),define("modules/forgotPassword",["jquery","underscore","backbone","app","models/topBar","views/shared/topBar","views/forgotPassword/forgotPassword"],function(e,t,n,r,i,s,o){return r.module("ForgotPassword",function(e){t.extend(e,{topBar:new i({leftText:"Home",leftUrl:"",rightText:"Log In",rightUrl:"login",title:"Reset Password"}),ContentLayout:o,TopBarView:s})})}),define("text!templates/contactUs/content.html",[],function(){return'<!-- Contact Us -->\r\n<section class="form contactUs">\r\n    <div class="contactUsHeader">\r\n        <p>Please tell us what’s on your mind.</p>\r\n    </div>\r\n    <form action="#">\r\n        <div class="row">\r\n            <label class="labelForm">Your Name <span class="labelFormRequired">*</span></label>\r\n            <input class="textField" type="text" />\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Email <span class="labelFormRequired">*</span></label>\r\n            <input class="textField" type="email" />\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Subject <span class="labelFormRequired">*</span></label>\r\n            <input class="textField" type="text" />\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Message <span class="labelFormRequired">*</span></label>\r\n            <textarea class="textArea" cols="30" rows="10"></textarea>            \r\n        </div>\r\n        <div class="row">\r\n            <input class="btn" type="submit" value="Submit" />\r\n        </div>\r\n        <div class="helpLink">\r\n            <a href="mailto:cityeats@launchsquad.com">Press inquireies? Contact our team.</a>\r\n        </div>\r\n    </form>\r\n</section>\r\n<!-- Follow Us -->\r\n<section class="followUs">\r\n    <h3 class="title grey line"><span class="titleText">Follow Us</span></h3>\r\n    <ul class="followUsLinks">\r\n        <li class="followUsLinksItem"><a class="followUsLinksLink twitter" href="#">Twitter</a></li>\r\n        <li class="followUsLinksItem"><a class="followUsLinksLink facebook" href="#">Facebook</a></li>\r\n        <li class="followUsLinksItem"><a class="followUsLinksLink pinterest" href="#">Pinterest</a></li>\r\n    </ul>\r\n</section>'}),define("views/contactUs/contactUs",["marionette","underscore","text!templates/contactUs/content.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n)});return r}),define("modules/contactUs",["jquery","underscore","backbone","app","models/topBar","views/shared/topBar","views/contactUs/contactUs"],function(e,t,n,r,i,s,o){return r.module("ContactUs",function(e){t.extend(e,{topBar:new i({leftText:"Home",leftUrl:"",rightText:"Log In",rightUrl:"login",title:"Contact Us"}),ContentLayout:o,TopBarView:s})})}),define("text!templates/restaurant/exclusiveEats/content.html",[],function(){return'<!-- Exclusive Eats -->\r\n<h2 class="exclusiveEatsTitle">Come Celebrate Lotus Blue\'s One Year Anniversary</h2>\r\n<div class="exclusiveEatsSelect column2">\r\n    select\r\n</div>\r\n<div class="bookBox"></div>\r\n<div class="mainBox img">\r\n    <img src="/img/assets/img-large-1.jpg" alt="" />\r\n</div>\r\n<article class="mainBox text aboutBox">\r\n    about\r\n</article>\r\n<article class="mainBox text">\r\n    <h2 class="mainBoxTitle">The Fine Print</h2>\r\n    <p>Any cancellations after March 6th or no show the evening of March 11th will be subject to a $125 fee per person.</p>\r\n</article>\r\n<a href="#" class="btn pale btnFaq">Exclusive Eats FAQ</a>'}),define("views/restaurant/exclusiveEats/exclusiveEats",["marionette","underscore","text!templates/restaurant/exclusiveEats/content.html"],function(e,t,n){var r=Backbone.Marionette.Layout.extend({template:t.template(n),regions:{about:".aboutBox",select:".exclusiveEatsSelect",book:".bookBox"},events:{"click .btnFaq":"goToFaq"},goToFaq:function(e){e.preventDefault();var t="restaurants/5/exclusive-eats-faq";app.router.navigate(t,{trigger:!0})}});return r}),define("text!templates/restaurant/exclusiveEats/about.html",[],function(){return'<h2 class="mainBoxTitle">About this offer</h2>\r\n<div class="mainBoxDetails">\r\n    <ul class="mainBoxInfoList">\r\n        <li><span class="mainBoxInfoListName">Price:</span> $0.00</li>\r\n        <li><span class="mainBoxInfoListName">This offer is available:</span> February 15th through March 1st</li>\r\n        <li><span class="mainBoxInfoListName">Amount left:</span> 10</li>\r\n        <li><span class="mainBoxInfoListName">Time left to buy:</span> 18d 4h34m 1s</li>\r\n    </ul>\r\n    <p><a href="#">More about this restaurant</a></p>\r\n</div>\r\n<p>Lotus Blue is turning one year old and the restaurant wants to show their guests how much they appreciate the support.  Now through March 1, all diners can choose any appetizer, entree and dessert from the regular menu for just $45 per person. A complimentary cocktail is also included in this three-course meal, which is reason enough to celebrate.</p>\r\n<p>What you\'ll get:</p>\r\n<p>Any appetizer, entree and dessert for $45 A complimentary cocktail</p>'}),define("views/restaurant/exclusiveEats/about",["marionette","underscore","text!templates/restaurant/exclusiveEats/about.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n)});return r}),define("text!templates/restaurant/exclusiveEats/book.html",[],function(){return'<h3 class="bookBoxTitle">Book a Table Tonight for 2 People at:</h3>\r\n<ul class="schedule exclusiveEatsSchedule">\r\n    <li class="scheduleItem">\r\n        <a class="scheduleLink" href="#">6:45<span class="scheduleText">p</span></a>\r\n    </li>\r\n    <li class="scheduleItem">\r\n        <a class="scheduleLink" href="#">7:00<span class="scheduleText">p</span></a>\r\n    </li>\r\n    <li class="scheduleItem">\r\n        <div class="scheduleCanceled">7:15<span class="scheduleText">p</span></div>\r\n    </li>\r\n    <li class="scheduleItem">\r\n        <a class="scheduleLink" href="#"><span class="scheduleMoreOptions">more<br />options</span></a>\r\n    </li>\r\n</ul>'}),define("views/restaurant/exclusiveEats/book",["marionette","underscore","text!templates/restaurant/exclusiveEats/book.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n)});return r}),define("text!templates/restaurant/exclusiveEats/selectForm.html",[],function(){return'<div class="selectForm column">\r\n    <select class="select">\r\n        <option>2 people</option>\r\n    </select>\r\n</div>\r\n<div class="datePicker column">Today</div>'}),define("views/restaurant/exclusiveEats/select",["marionette","underscore","text!templates/restaurant/exclusiveEats/selectForm.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n)});return r}),define("text!templates/restaurant/exclusiveEats/faq.html",[],function(){return'<!-- Exclusive Eats -->\r\n<div class="mainBox text">\r\n    <p>\r\n        <strong class="faqQuestion">Q: What are Exclusive Eats, and how do they work?</strong>\r\n        A: Exclusive Eats are special offers that include everything from preferred pricing to special menu items to unique dining experiences. Taking advantage of an Exclusive Eats ticket is easy: Just purchase the offer and make a reservation at the restaurant through CityEats. When you arrive at the restaurant, mention to your host or hostess that you booked an Exclusive Eats with us. No printouts or confirmation codes necessary. Please keep in mind, Exclusive Eats can be set times and dates.\r\n    </p>\r\n    <p>\r\n        <strong class="faqQuestion">Q: What are the different types of Exclusive Eats tickets?</strong>\r\n        A. There are three types of Exclusive Eats tickets: prepaid, pay at the event and those that feature complimentary appetizers and/or beverages. The prepaid ticket allows the customer to book and pay on CityEats. The pay at the event tickets allows the customer to reserve their seat on CityEats, but the customer pays when s/he attends the event. Complimentary appetizers and/or beverages allow the customer to redeem a complimentary food item when they use CityEats to book the reservation.\r\n    </p>\r\n    <p>\r\n        <strong class="faqQuestion">Q. What is the “no-show” policy?</strong>\r\n        A. When you book a reservation for an Exclusive Eats, you agree to allow the restaurant to charge your credit card in the event of a "no-show" or cancellation that is not in accordance with the restaurant’s cancellation policy. Each restaurant sets its own policy and can be contacted directly with questions.\r\n    </p>\r\n    <p>\r\n        <strong class="faqQuestion">Q. Why does it say “free”?</strong>\r\n        A. The system says “Free” when CityEats is not responsible for the monetary transaction of the Exclusive Eats offer, but functions primarily as a booking tool.\r\n    </p>\r\n    <p>\r\n        <strong class="faqQuestion">Q: Do I have to be a member of CityEats to buy an Exclusive Eats offer?</strong>\r\n        A: Yes, but membership to CityEats is free and easy. Sign up today.\r\n    </p>\r\n</div>'}),define("views/restaurant/exclusiveEats/faq",["marionette","underscore","text!templates/restaurant/exclusiveEats/faq.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n)});return r}),define("modules/restaurant/exclusiveEats",["jquery","underscore","backbone","app","models/topBar","views/shared/topBar","views/restaurant/exclusiveEats/exclusiveEats","views/restaurant/exclusiveEats/about","views/restaurant/exclusiveEats/book","views/restaurant/exclusiveEats/select","views/restaurant/exclusiveEats/faq"],function(e,t,n,r,i,s,o,u,a,f,l){return r.module("RestaurantExclusiveEats",function(e){t.extend(e,{topBar:new i({leftText:"Back",leftUrl:"",title:"Exclusive Eats"}),faqTopBar:new i({leftText:"Back",leftUrl:"",title:"Exclusive Eats FAQ"}),ContentLayout:o,TopBarView:s,AboutView:u,BookView:a,SelectView:f,FaqView:l})})}),define("text!templates/restaurant/bookIt/complete/complete.html",[],function(){return'<!-- Reservation -->\r\n<div class="reservationHeader">\r\n    <h2 class="reservationTitle">Complete Reservation</h2>\r\n</div>\r\n<div id="restaurantInfo"></div>\r\n<div id="userInfo"></div>\r\n<div id="additionalInfo"></div>\r\n\r\n<div class="btnHolder">\r\n    <input class="btn btnComplete" type="submit" value="Complete Reservation" />\r\n</div>\r\n<div class="termsText">By completing the reservation you are agreeing to the <a href="#">terms of service</a></div>'}),define("views/restaurant/bookIt/complete/complete",["marionette","underscore","text!templates/restaurant/bookIt/complete/complete.html"],function(e,t,n){var r=Backbone.Marionette.Layout.extend({template:t.template(n),regions:{restaurantInfo:"#restaurantInfo",userInfo:"#userInfo",additionalInfo:"#additionalInfo"},events:{"click .btnComplete":"btnCompleteClick"},btnCompleteClick:function(e){e.preventDefault(),this.trigger("completeClicked")}});return r}),define("text!templates/restaurant/bookIt/complete/restaurantInfo.html",[],function(){return'<div class="roundedBox">\r\n    <div class="roundedBoxRow">\r\n        <div class="reservationData reservationDataEdit">\r\n            <h3 class="reservationDataTitle confirmed"><%= name %></h3>            \r\n            <p><%= slotFormated(0, specialMealId) %></p>\r\n            <p><span class="reservationGreyText">for</span> <%= party %> people <span class="reservationGreyText">at</span> <%= selectedTimeFormated().valueSimpleAmTextFull %></p>\r\n            <% var mealText = getMealText(specialMealId); %>\r\n            <% if(mealText) { %>\r\n                <p><span class="reservationGreyText">for</span> <%= mealText %></p>\r\n            <% } %>\r\n            <a href="#" class="btnSoft small btnEdit">Edit</a>\r\n        </div>\r\n    </div>\r\n</div>'}),define("views/restaurant/bookIt/complete/restaurantInfo",["app","marionette","underscore","text!templates/restaurant/bookIt/complete/restaurantInfo.html"],function(e,t,n,r){var i=t.ItemView.extend({template:n.template(r),events:{"click .btnEdit":"btnEditClick"},serializeData:function(){var e=this.model.toJSON();return n.extend(e,{specialMealId:this.specialMealId})},templateHelpers:{getMealText:function(e){var t=n.findWhere(this.special_meals,{special_meal_id:e});return t?t.name:null}},initialize:function(){this.options.specialMealId&&(this.specialMealId=parseInt(this.options.specialMealId,10))},btnEditClick:function(t){t.preventDefault(),e.router.navigate(this.options.bookItUrl,{trigger:!0})}});return i}),define("basicItemView",["app","marionette","underscore"],function(e,t,n){var r=t.ItemView.extend({ui:{txtError:".txtError"},requireValidation:function(e,t,n){var r=t.val();return r.length==0?(this.showError(e,t,n),!1):(this.hideError(t,n),!0)},showError:function(e,t,n){t&&t.addClass("hasError"),n&&(n=="main"?this.ui.txtError.text(e).show():n.text(e).show())},hideError:function(e,t){e&&e.removeClass("hasError"),t?t.hide():this.ui.txtError.hide()}});return r}),define("text!templates/restaurant/bookIt/complete/userInfo.html",[],function(){return'<div class="btnHolder" id="pnLogIn">\r\n    <a href="#" class="btn pale btnLogIn">Log In</a>\r\n</div>\r\n\r\n<%if (typeof email != \'undefined\') { %>\r\n<div id="pnlAccountInfo">\r\n    <h4 class="reservationSubTitle">Your account info</h4>\r\n    <div class="roundedBox">\r\n        <div class="roundedBoxRow">\r\n            <div class="reservationData">\r\n                <p><%= getFullName() %></p>\r\n                <p class="reservationGreyText"><%= email %></p>\r\n                <p class="reservationGreyText"><%= formatPhone() %></p>\r\n                <div class="reservationDataButtons">\r\n                    <div class="reservationDataButtonLeft">\r\n                        <a href="#" class="btnSoft small btnSomeoneElse">Reserving for someone else?</a>\r\n                    </div>\r\n                    <div class="reservationDataButtonRight">\r\n                        <a href="#" class="btnSoft small btnEditProfile">Edit Profile</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<% } %>\r\n<div id="pnlReservationInfo">\r\n    <h4 class="reservationSubTitle">Enter reservation info</h4>\r\n    <div class="pnlForMyself hide">\r\n        <div class="reservationDataButtonLeft">\r\n            <a href="#" class="btnSoft small btnForMyself">I’m reserving for myself</a>\r\n        </div>            \r\n        <br />\r\n    </div>\r\n    <div class="roundedBox">\r\n        <div class="roundedBoxRow">\r\n            <input class="textField blank txtFirstName" type="text" placeholder="First Name" />\r\n            <p class="textError txtFirstNameError hide">Error</p>\r\n        </div>\r\n        <div class="roundedBoxRow">\r\n            <input class="textField blank txtLastName" type="text" placeholder="Last Name" />\r\n            <p class="textError txtLastNameError hide">Error</p>\r\n        </div>\r\n        <div class="roundedBoxRow">\r\n            <input class="textField blank txtEmail" type="email" placeholder="Email" />\r\n            <p class="textError txtEmailError hide">Error</p>\r\n        </div>\r\n        <div class="roundedBoxRow">\r\n            <input class="textField blank txtPhone" type="tel" placeholder="Phone" />\r\n            <p class="textError txtPhoneError hide">Error</p>\r\n        </div>        \r\n    </div>\r\n</div>'}),define("views/restaurant/bookIt/complete/userInfo",["app","marionette","backbone","underscore","basicItemView","text!templates/restaurant/bookIt/complete/userInfo.html"],function(e,t,n,r,i,s){var o=i.extend({template:r.template(s),ui:{pnLogIn:"#pnLogIn",pnlAccountInfo:"#pnlAccountInfo",pnlReservationInfo:"#pnlReservationInfo",btnSomeoneElse:".btnSomeoneElse",btnEditProfile:".btnEditProfile",pnlForMyself:".pnlForMyself",txtFirstName:".txtFirstName",txtFirstNameError:".txtFirstNameError",txtLastName:".txtLastName",txtLastNameError:".txtLastNameError",txtEmail:".txtEmail",txtEmailError:".txtEmailError",txtPhone:".txtPhone",txtPhoneError:".txtPhoneError"},events:{"click .btnLogIn":"btnLogInClick","click .btnSomeoneElse":"btnSomeoneElseClick","click .btnForMyself":"btnForMyselfClick","click .btnEditProfile":"btnEditProfileClick"},onRender:function(){if(this.options.reservation){var e=this.options.reservation.get("first_name"),t=this.options.reservation.get("last_name"),n=this.options.reservation.get("email"),r=this.options.reservation.get("phone_number");this.model!=null&&this.model.get("first_name")==e&&this.model.get("last_name")==t&&this.model.get("email")==n&&this.model.get("phone_number")==r?(this.ui.pnLogIn.hide(),this.ui.pnlReservationInfo.hide()):(this.model!=null&&(this.btnSomeoneElseClick(),this.ui.pnLogIn.hide()),this.ui.txtFirstName.val(e),this.ui.txtLastName.val(t),this.ui.txtEmail.val(n),this.ui.txtPhone.val(r))}else this.model==null?this.ui.pnlAccountInfo.hide():(this.ui.pnLogIn.hide(),this.ui.pnlReservationInfo.hide())},btnLogInClick:function(t){t.preventDefault();var r=n.history.fragment;e.router.navigate("login?"+encodeURIComponent(r),{trigger:!0})},btnSomeoneElseClick:function(e){e&&e.preventDefault(),this.ui.pnlAccountInfo.hide(),this.ui.pnlReservationInfo.show(),this.ui.pnlForMyself.show(),this.isSomeoneElse=!0},btnForMyselfClick:function(e){e.preventDefault(),this.ui.pnlAccountInfo.show(),this.ui.pnlReservationInfo.hide(),this.isSomeoneElse=!1},btnEditProfileClick:function(t){t.preventDefault();var r=n.history.fragment;e.router.navigate("profile/edit?"+encodeURIComponent(r),{trigger:!0})},validate:function(){var e=!0;return this.ui.pnlReservationInfo.is(":visible")&&(this.requireValidation("First Name is a required field",this.ui.txtFirstName,this.ui.txtFirstNameError)||(e=!1),this.requireValidation("Last Name is a required field",this.ui.txtLastName,this.ui.txtLastNameError)||(e=!1),this.requireValidation("Email is a required field",this.ui.txtEmail,this.ui.txtEmailError)||(e=!1),this.requireValidation("Phone is a required field",this.ui.txtPhone,this.ui.txtPhoneError)||(e=!1)),e},getModel:function(){if(!this.validate())return null;var e=this.model!=null&&this.isSomeoneElse!=1;return{isAuthorized:e,firstName:e?this.model.get("first_name"):this.ui.txtFirstName.val(),lastName:e?this.model.get("last_name"):this.ui.txtLastName.val(),email:e?this.model.get("email"):this.ui.txtEmail.val(),phone:e?this.model.get("phone_number"):this.ui.txtPhone.val(),id:e?this.model.get("id"):null}}});return o}),define("text!templates/restaurant/bookIt/complete/additionalInfo.html",[],function(){return'<h4 class="reservationSubTitle">Special requests</h4>\r\n<div class="roundedBox">\r\n    <div class="roundedBoxRow">\r\n        <input class="textField blank txtSpecialRequests" type="text" placeholder="e.g. Table with View, Shellfish allergy" />\r\n    </div>\r\n</div>\r\n<h4 class="reservationSubTitle">Promo code</h4>\r\n<div class="roundedBox">\r\n    <div class="roundedBoxRow">\r\n        <input class="textField blank txtPromoCode" type="text" placeholder="Promo Code (optional)" />\r\n    </div>\r\n</div>\r\n<div class="roundedBox">\r\n    <div class="roundedBoxRow">\r\n        <div class="reminder reminderBookIt">\r\n            <p class="reminderLabel">SMS Reminder</p>\r\n            <label class="switcher reminderSwitcher">\r\n                <input type="checkbox" data-on="on" data-off="off" checked  class="cbSmsReminder"/>\r\n            </label>\r\n        </div>\r\n    </div>\r\n    <div class="roundedBoxRow">\r\n        <div class="reminder reminderBookIt">\r\n            <p class="reminderLabel">Email Reminder</p>\r\n            <label class="switcher reminderSwitcher">\r\n                <input type="checkbox" data-on="on" data-off="off" class="cbEmailReminder" />\r\n            </label>\r\n        </div>\r\n    </div>\r\n</div>'}),define("views/restaurant/bookIt/complete/additionalInfo",["app","marionette","underscore","text!templates/restaurant/bookIt/complete/additionalInfo.html"],function(e,t,n,r){var i=t.ItemView.extend({template:n.template(r),ui:{txtSpecialRequests:".txtSpecialRequests",txtPromoCode:".txtPromoCode",cbSmsReminder:".cbSmsReminder",cbEmailReminder:".cbEmailReminder"},getModel:function(){return{specialRequests:this.ui.txtSpecialRequests.val(),promoCode:this.ui.txtPromoCode.val(),smsReminder:this.ui.cbSmsReminder.is(":checked"),emailReminder:this.ui.cbEmailReminder.is(":checked")}},onRender:function(){this.options.reservation&&(this.ui.txtSpecialRequests.val(this.options.reservation.get("special_request")),this.ui.txtPromoCode.val(this.options.reservation.get("promo_code")),this.ui.cbSmsReminder.attr("checked",this.options.reservation.get("sms_reminder")),this.ui.cbEmailReminder.attr("checked",this.options.reservation.get("email_reminder")))}});return i}),define("modules/restaurant/completeReservation",["jquery","underscore","backbone","app","models/topBar","views/shared/topBar","views/restaurant/bookIt/complete/complete","views/restaurant/bookIt/complete/restaurantInfo","views/restaurant/bookIt/complete/userInfo","views/restaurant/bookIt/complete/additionalInfo"],function(e,t,n,r,i,s,o,u,a,f){return r.module("CompleteReservation",function(e){t.extend(e,{topBar:new i({leftText:"Back",leftUrl:"",title:"Book It"}),ContentLayout:o,TopBarView:s,RestaurantInfoView:u,UserInfoView:a,AdditionalInfoView:f})})}),define("text!templates/account/profile/about.html",[],function(){return'<!-- Account -->\r\n<section class="account">\r\n    <ul class="tabs">\r\n        <li class="tabsItem"><a class="tabsLink active" href="#">About</a></li>\r\n        <li class="tabsItem"><a class="tabsLink btnReservations" href="#">Reservations</a></li>\r\n    </ul>\r\n    <div class="tabsContent">\r\n        <div class="tabsContentInner">\r\n            <div class="accountAbout">\r\n                <div class="accountAboutUser">\r\n                    <div class="accountAboutUserPhoto"><img src="img/assets/userPhoto.jpg" alt="" /></div>\r\n                    <div class="accountAboutUserInfo">\r\n                        <h2 class="accountAboutUserName"><%= getFullName() %></h2>\r\n                        <p><%= email %></p>\r\n                        <p><%= formatPhone() %></p>\r\n                    </div>\r\n                </div>\r\n                <% \r\n                    var cuisinesItems =  cuisines(),\r\n                    neighborhoodsItems =  neighborhoods(); \r\n                %>\r\n                <% if (neighborhoodsItems.length > 0) { %>\r\n                    <div class="accountAboutBox">\r\n                        <h2 class="accountAboutTitle">Favorite Neighborhoods</h2>\r\n                        <% for(var i = 0; i < neighborhoodsItems.length; i++) { %>\r\n                            <p><%= neighborhoodsItems[i] %></p>\r\n                        <% } %>\r\n                    </div>\r\n                <% } if (cuisinesItems.length > 0) { %>\r\n                    <div class="accountAboutBox">\r\n                        <h2 class="accountAboutTitle">Favorite Cuisines</h2>\r\n                        <% for(var i = 0; i < cuisinesItems.length; i++) { %>\r\n                            <p><%= cuisinesItems[i] %></p>\r\n                        <% } %>\r\n                    </div>\r\n                <% }%>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="helpLink">\r\n        <a href="#" class="btnEdit">Edit Profile</a>\r\n    </div>\r\n</section>'}),define("views/account/profile/about",["marionette","app","underscore","text!templates/account/profile/about.html"],function(e,t,n,r){var i=e.ItemView.extend({template:n.template(r),events:{"click .btnEdit":"goToEdit","click .tabsLink.active":"goToVoid","click .btnReservations":"btnReservationsClick"},templateHelpers:{neighborhoods:function(){return this.favorite_neighborhoods.length>0?this.favorite_neighborhoods.split(","):""},cuisines:function(){return this.favorite_cuisine_types.length>0?this.favorite_cuisine_types.split(","):""}},goToEdit:function(e){e.preventDefault();var n="profile/edit";t.router.navigate(n,{trigger:!0})},btnReservationsClick:function(e){e.preventDefault(),t.vent.trigger("showLoading"),t.router.navigate("profile/reservations",{trigger:!0})},goToVoid:function(e){e.preventDefault()}});return i}),define("text!templates/account/profile/edit.html",[],function(){return'<!-- Edit Profile -->\r\n<section class="form editProfile">\r\n    <div class="row">\r\n        <label class="labelForm">First Name</label>\r\n        <input class="textField txtFirstName" type="text" value="<%= first_name %>" />\r\n        <p class="textError txtFirstNameError hide">Error</p>\r\n    </div>\r\n    <div class="row">\r\n        <label class="labelForm">Last Name</label>\r\n        <input class="textField txtLastName" type="text" value="<%= last_name %>" />\r\n        <p class="textError txtLastNameError hide">Error</p>\r\n    </div>\r\n    <div class="row">\r\n        <label class="labelForm">Email</label>\r\n        <input class="textField txtEmail" type="email" value="<%= email %>" />\r\n        <p class="textError txtEmailError hide">Error</p>\r\n    </div>\r\n    <div class="row">\r\n        <label class="labelForm">Phone</label>\r\n        <input class="textField txtPhone" type="tel" value="<%= phone_number %>" />\r\n        <p class="textError txtPhoneError hide">Error</p>\r\n    </div>\r\n</section>\r\n<div class="row">\r\n    <label class="labelForm">Favorites <span class="labelFormOptional">(Choose up to 3 each)</span></label>\r\n    <div class="roundedBox">\r\n        <div class="roundedBoxRow">\r\n            <div class="filterByItems byNeighborhoods <%= neighborhoodsClass() %>"><%= neighborhoods() %></div>\r\n        </div>\r\n        <div class="roundedBoxRow">\r\n            <div class="filterByItems byCuisines <%= cuisinesClass() %>"><%= cuisines() %></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="row">\r\n    <input class="btn btnSubmit" type="submit" value="Save" />\r\n</div>'}),define("views/account/profile/edit",["marionette","underscore","basicItemView","text!templates/account/profile/edit.html"],function(e,t,n,r){var i=n.extend({template:t.template(r),events:{"click .byNeighborhoods":"btnByNeighborhoodsClicked","click .byCuisines":"btnByCuisinesClicked","click .btnSubmit":"btnSubmitClicked"},ui:{txtFirstName:".txtFirstName",txtFirstNameError:".txtFirstNameError",txtLastName:".txtLastName",txtLastNameError:".txtLastNameError",txtEmail:".txtEmail",txtEmailError:".txtEmailError",txtPhone:".txtPhone",txtPhoneError:".txtPhoneError"},templateHelpers:{neighborhoodsClass:function(){return this.neighborhoodItems&&this.neighborhoodItems.length>0?"updated":""},cuisinesClass:function(){return this.cuisineItems&&this.cuisineItems.length>0?"updated":""},neighborhoods:function(){return this.neighborhoodItems&&this.neighborhoodItems.length>0?this.neighborhoodItems.map(function(e){return e.get("value")}).join(", "):"Favorite Neighborhoods"},cuisines:function(){return this.cuisineItems&&this.cuisineItems.length>0?this.cuisineItems.map(function(e){return e.get("value")}).join(", "):"Favourite Cuisines"}},serializeData:function(){var e=this.model.toJSON();return t.extend(e,{cuisineItems:this.options.cuisineItems,neighborhoodItems:this.options.neighborhoodItems})},btnSubmitClicked:function(e){var t={first_name:this.ui.txtFirstName.val(),last_name:this.ui.txtLastName.val(),email:this.ui.txtEmail.val(),phone_number:this.ui.txtPhone.val()};this.trigger("userSaved",t)},btnByNeighborhoodsClicked:function(e){e.preventDefault(),this.trigger("ByNeighborhoodsClicked")},btnByCuisinesClicked:function(e){e.preventDefault(),this.trigger("ByCuisinesClicked")},showErrors:function(e){var t;e.responseText&&e.responseText.length>0&&(t=JSON.parse(e.responseText)),t?(t.phone_number?this.showError(t.phone_number.join(", "),this.ui.txtPhone,this.ui.txtPhoneError):this.hideError(this.ui.txtPhone,this.ui.txtPhoneError),t.email?this.showError(t.email.join(", "),this.ui.txtEmail,this.ui.txtEmailError):this.hideError(this.ui.txtEmail,this.ui.txtEmailError),t.first_name?this.showError(t.first_name.join(", "),this.ui.txtFirstName,this.ui.txtFirstNameError):this.hideError(this.ui.txtFirstName,this.ui.txtFirstNameError),t.last_name?this.showError(t.last_name.join(", "),this.ui.txtLastName,this.ui.txtLastNameError):this.hideError(this.ui.txtLastName,this.ui.txtLastNameError)):(this.hideError(this.ui.txtPhone,this.ui.txtPhoneError),this.hideError(this.ui.txtEmail,this.ui.txtEmailError),this.hideError(this.ui.txtFirstName,this.ui.txtFirstNameError),this.hideError(this.ui.txtLastName,this.ui.txtLastNameError))}});return i}),define("modules/profile",["jquery","underscore","backbone","app","models/topBar","views/shared/topBar","views/account/profile/about","views/account/profile/edit"],function(e,t,n,r,i,s,o,u){return r.module("Profile",function(e){t.extend(e,{topBar:new i({leftText:"Home",leftUrl:"back",title:"Account"}),topBarEdit:new i({leftText:"Cancel",leftUrl:"",title:"Edit Profile"}),ContentLayout:o,EditView:u,TopBarView:s})})}),define("models/filter",["backbone","app"],function(e,t){var n=e.Model.extend({defaults:{prices:[],cuisineIds:[],neighborhoodIds:[],cuisinesText:function(){var e=this.cuisines.length>0?_(this.cuisines.where({checked:!0})).sortBy(function(e){return e.get("value")}):[];return e.length>0?e.map(function(e){return e.get("value")}).join(","):"By Cuisine"},neighborhoodsText:function(){var e=this.neighborhoods.length>0?_(this.neighborhoods.where({checked:!0})).sortBy(function(e){return e.get("value")}):[];return e.length>0?e.map(function(e){return e.get("value")}).join(","):"By Neighborhood"}},initialize:function(){this.resetFilter()},prepareData:function(){var e=this.get("cuisineIds"),t=this.get("neighborhoodIds"),n=this.get("cuisines"),r=this.get("neighborhoods");n&&n.each(function(t){t.set("checked",e.indexOf(t.get("key"))!=-1)}),r&&r.each(function(e){e.set("checked",t.indexOf(e.get("key"))!=-1)})},isDefault:function(){var e=this.get("sortBy"),n=t.request("GetLocation");return this.get("prices").length==0&&this.get("cuisineIds").length==0&&this.get("neighborhoodIds").length==0&&(n&&e==1||!n&&e==2)},resetFilter:function(){var e=t.request("GetLocation");this.set("neighborhoodIds",[]),this.set("cuisineIds",[]),this.set("prices",[]),this.set("sortBy",e?1:2),this.prepareData()}});return n}),define("models/keyValue",["backbone"],function(e){var t=e.Model.extend({defaults:{key:"",value:0,checked:!1}});return t}),define("models/user",["backbone","modules/helper"],function(e,t){var n=e.Model.extend({defaults:{id:0,getFullName:function(){return this.first_name+" "+this.last_name},formatPhone:function(){return t.formatPhone(this.phone_number)}}});return n}),define("models/reviewItem",["backbone","modules/helper"],function(e,t){var n=e.Model.extend({defaults:{atmosphere_rating:0,created_at:"",dishes:[],feedback:"",food_rating:0,good_for:[],madlibs:"",overall_rating:"",restaurant_id:0,service_rating:0,title:"",username:"",date:function(){return t.formatDateLong(this.created_at)}},maxLength:100,getShortContent:function(){return this.get("madlibs").substring(0,this.maxLength)}});return n}),define("collections/reviews",["backbone","models/reviewItem"],function(e,t){var n=e.Collection.extend({model:t});return n}),define("collections/dictionary",["backbone","models/keyValue"],function(e,t){var n=e.Collection.extend({model:t});return n}),define("models/restaurant",["underscore","backbone","modules/helper","collections/reviews","collections/dictionary"],function(e,t,n,r,i){var s=t.Model.extend({defaults:{distanceText:function(){return this.distance_to_restaurant?this.distance_to_restaurant.toFixed(2)*1e3+" mi":null},cuisine_types:[],cuisinesText:function(t){return t=t||" / ",e(this.cuisine_types).map(function(e){return e.name}).join(t)},priceSymbols:function(){return(new Array(this.price_rating+1)).join("$")},priceSymbolsReverse:function(){return(new Array(5-this.price_rating+1)).join("$")},formatPhone:function(){return n.formatPhone(this.phone_number)},slotsFormated:function(t){var r=this.selectedTime.split(":"),i,s=parseInt(r[0],10),o=parseInt(r[1],10);if(t){var u=e.findWhere(this.special_meals_slots,{id:t});i=u?u.slots:[]}else i=this.slots;var a=new Date(2e3,1,1,s,o),f=new Date(a),l=new Date(a);f.setMinutes(f.getMinutes()-15),l.setMinutes(l.getMinutes()+15);var r=[{text:n.formatTime(f.getHours(),f.getMinutes()).textSimple,amText:n.formatTime(f.getHours(),f.getMinutes()).amText},{text:n.formatTime(a.getHours(),a.getMinutes()).textSimple,amText:n.formatTime(a.getHours(),a.getMinutes()).amText},{text:n.formatTime(l.getHours(),l.getMinutes()).textSimple,amText:n.formatTime(l.getHours(),l.getMinutes()).amText}],c=new Array(3);for(var h=0;h<i.length;h++){var p=n.newDate(i[h],this.current_time_offset),d=p.getHours(),v=p.getMinutes(),m=-1;d==s&&v==o?m=1:d==f.getHours()&&v==f.getMinutes()?m=0:d==l.getHours()&&v==l.getMinutes()&&(m=2),m>=0&&(c[m]={text:n.formatTime(d,v).textSimple,amText:n.formatTime(d,v).amText,value:n.formatTime(d,v).value,isEmpty:!1})}for(var h=0;h<c.length;h++)typeof c[h]=="undefined"&&(c[h]={text:r[h].text,amText:r[h].amText,isEmpty:!0});return c},slotFormated:function(t,r){var i;if(r){var s=e.findWhere(this.special_meals_slots,{id:r});i=s?s.slots:[]}else i=this.slots;return n.formatDateShort2(i[t])},thumbImage:function(){return this.images.length>0?this.images[0].thumb_mobile_app:""},paymentsText:function(){return this.payment_options.join(", ")},geoImageUrl:function(){return this.address.lat&&this.address.lng?"http://maps.googleapis.com/maps/api/staticmap?center="+this.address.lat+","+this.address.lng+"&zoom=12&size=292x73&sensor=false&&markers=color:red%7Clabel:R%7C"+this.address.lat+","+this.address.lng:null},selectedTimeFormated:function(){return n.formatTime(this.selectedTime)}},highlights:function(){var t=e.find(this.get("lists"),function(e){return e.list.title.toLowerCase()==="highlights"});return t?(t.list.description||"").split("\n"):[]},goodToKnow:function(){var t=e.find(this.get("lists"),function(e){return e.list.title.toLowerCase()==="good to know"});return t?(t.list.description||"").split("\n"):[]},recommendedDishes:function(){var t=e.find(this.get("aside_lists"),function(e){return e.classification.toLowerCase()==="recommended-dishes"});return t?t.description:[]},recommendedMargaritas:function(){var t=e.find(this.get("aside_lists"),function(e){return e.classification.toLowerCase()==="recommended-drinks"});return t?t.description:[]},getReviewCollection:function(){return this.reviewCollection||(this.reviewCollection=new r),this.reviewCollection.reset(e.map(this.get("reviews"),function(e){return e.review})),this.reviewCollection},getFullSlots:function(t,r){var r=new Date(r),s,o,u=this,a,f,l=e.chain(this.get("restaurant_open_hours")).where({day_of_week:r.getDay()}).map(function(e){var t=e.start_time.split(":"),n=e.end_time.split(":");return{start_time:e.start_time,start_time_h:parseInt(t[0],10),start_time_m:parseInt(t[1],10),end_time:e.end_time,end_time_h:parseInt(n[0],10),end_time_m:parseInt(n[1],10),start_time_tmp:parseFloat(t[0]+"."+t[1]),end_time_tmp:parseFloat(n[0]+"."+n[1])}}).value();if(l.length>0){var c=e.min(l,function(e){return e.start_time_tmp}),h=e.max(l,function(e){return e.end_time_tmp});s=new Date(r),s.setHours(c.start_time_h),s.setMinutes(c.start_time_m),o=new Date(r),o.setHours(h.end_time_h),o.setMinutes(h.end_time_m),s>o&&o.setDate(o.getDate()+1)}var p=n.getTimes(r,s,o);if(t){var d=e.findWhere(this.get("special_meals_slots"),{id:t});a=d?d.slots:[]}else a=this.get("slots");return f=e.map(a,function(e){return n.formatTime(n.newDate(e,u.get("current_time_offset")))}),new i(e.map(p,function(t){var r=n.parseDate("2000-01-01",t.value),i=n.formatTime(r.getHours(),r.getMinutes());return{key:i.value,value:i,selected:e.some(f,function(e){return e.value==i.value})}}))}});return s}),define("models/reservation",["backbone","modules/helper"],function(e,t){var n=e.Model.extend({defaults:{title:function(){var e=t.newDate(this.reserved_for,this.current_time_offset),n=t.formatTime(e);return t.formatDateRelative(e,!0)+" "+n.textSimple+n.amText+" for "+this.party_size+" people"}},isUpcoming:function(){return this.get("state")=="pending"},isPast:function(){return this.get("state")=="arrived"},isCanceled:function(){return this.get("state")=="cancelled"}});return n}),define("collections/restaurants",["backbone","models/restaurant"],function(e,t){var n=e.Collection.extend({model:t});return n}),define("models/city",["backbone"],function(e){var t=e.Model.extend({defaults:{active:!1,created_at:"",display_name:"",id:0,lat:0,lng:0,short_name:"",time_zone:"",isCurrent:!1}});return t}),define("collections/cities",["backbone","models/city"],function(e,t){var n=e.Collection.extend({model:t});return n}),define("modules/data",["jquery","underscore","backbone","app","modules/helper","models/filter","models/keyValue","models/user","models/restaurant","models/reservation","collections/dictionary","collections/restaurants","collections/cities"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p={},d={},v={},m={},g=null,y={},b=null,w={},E={};return r.module("Data",function(e){t.extend(e,{getRestaurantsByMetro:function(e,t,n,i,s){var o=this,u=p[e];if(typeof u!="undefined")return s?s(null,o.filterRestaurants(u,i,t,n)):null;var a=r.request("GetLocation");r.execute("API:GetRestaurantsByMetro",e,1e3,1,a?a.lat:null,a?a.lng:null,function(r,a){return r==null&&(p[e]=u=new c(a.restaurants)),s?s(r,o.filterRestaurants(u,i,t,n)):null})},getRestaurantExtended:function(e,n){var i=d[e];if(typeof i!="undefined")return n(null,i);r.execute("API:GetRestaurantExtended",e,function(s,o){s==null?r.execute("API:GetRestaurant",e,function(r,s){r==null&&(t.extend(o,s.restaurants),d[e]=i=new a(o)),n(r,i)}):n(s)})},filterRestaurants:function(e,n,r,s){var o=[],u=[],a=[],f;return typeof e=="undefined"||e==null?null:(r!=null&&(o=r.get("cuisineIds"),u=r.get("neighborhoodIds"),a=r.get("prices"),f=r.get("sortBy")),e=new c(e.filter(function(e){var r=filteredByNeighborhood=filteredByPrice=filteredByQuery=filteredByEditorsPicks=!0;o.length>0&&(r=t.intersection(o,e.get("cuisine_type_ids")).length>0),u.length>0&&(filteredByNeighborhood=u.indexOf(e.get("neighborhood_id"))!=-1),a.length>0&&(filteredByPrice=a.indexOf(e.get("price_rating"))!=-1),s&&(filteredByEditorsPicks=e.get("is_editors_picks"));if(n&&n.length>0){n=n.toLowerCase();var f=e.get("name").toLowerCase(),l=t(e.get("cuisine_types")).map(function(e){return e.name}).join(" | ").toLowerCase();filteredByQuery=i.stringSearch(n,f)||i.stringSearch(n,l)||i.stringSearch(n,e.get("neighborhood").name)}return r&&filteredByNeighborhood&&filteredByPrice&&filteredByQuery&&filteredByEditorsPicks})),this.orderRestaurants(e,f))},orderRestaurants:function(e,t){switch(t){case 1:return new c(e.sortBy("distance_to_restaurant"));case 3:return new c(e.sortBy("name"));case 2:default:return new c(e.sortBy("popularity").reverse())}},getMetros:function(e,n,i){if(g!=null)return e?e(null,g):null;r.execute("API:GetMetros",n,i,function(s,o){if(s)return e?e(s):null;g=new h(t.where(o.metros,{active:!0}));if(n&&i&&g.length>0&&r.request("GetCurrentCity")==null){var u=g.at(0);return u.get("distance_to_metro")&&u.get("distance_to_metro")*1e3<=100&&r.execute("SetCurrentCity",u),e?e(s,g):null}return e?e(s,g):null})},getMetro:function(e,n){if(g!=null)return n?n(null,g.get(e)):null;r.execute("API:GetMetros",null,null,function(r,i){return r==null&&(g=new h(t.where(i.metros,{active:!0}))),n?n(r,g.get(e)):null})},getCuisinesByMetro:function(e,t){var n=v[e];if(typeof n!="undefined")return t?t(null,n):null;r.execute("API:GetCuisines",e,function(r,i){return r==null&&(v[e]=n=new l(i.cuisine_types.map(function(e){return{key:e.id,value:e.name}}))),t?t(r,n):null})},getNeighborhoodsByMetro:function(e,t){var n=m[e];if(typeof n!="undefined")return t?t(null,n):null;r.execute("API:GetNeighborhoods",e,function(r,i){return r==null&&(m[e]=n=new l(i.neighborhoods.map(function(e){return{key:e.id,value:e.name}}))),t?t(r,n):null})},getFilter:function(e,t){var n=y[e];n==null&&(n=new s);var r=n.get("cuisineIds")||[],i=n.get("neighborhoodIds")||[],o=this;this.getCuisinesByMetro(e,function(r,i){if(r)return t(r);n.set("cuisines",i),o.getNeighborhoodsByMetro(e,function(r,i){if(r)return t(r);n.set("neighborhoods",i),y[e]=n,t(null,n)})})},getFilterSimple:function(e){var t=y[e];return t==null&&(t=new s,y[e]=t),t},setFilterCuisines:function(e,t){var n=y[e];n==null&&(n=new s,y[e]=n),n.set("cuisineIds",t),y[e]=n},setFilterNeighborhoods:function(e,t){var n=y[e];n==null&&(n=new s,y[e]=n),n.set("neighborhoodIds",t),y[e]=n},signUp:function(e,t){r.execute("API:SignUp",{user:e},function(e,n){return b=null,e==null?(r.execute("GetCurrentUser"),t(e,!0)):t(e,!1)})},signIn:function(e,t){e.remember_me=1,r.execute("API:SignIn",{user:e},function(e,n){return b=null,e==null?(r.execute("GetCurrentUser"),t(e,!0)):t(e,!1)})},signOut:function(e){r.execute("API:SignOut",function(t){if(t)return e(t);b=null,e(null)})},getCurrentUser:function(e){if(b)return e?e(null,b):null;r.execute("API:GetUser",function(t,n){return t==null&&typeof n.error=="undefined"?b=new u(n.user):b=null,e?e(t,b):null})},updateCurrentUser:function(e,t,n,i,s){r.execute("API:UpdateUser",e,t,n,i,function(e,t){return e==null&&typeof t.error=="undefined"&&(b=new u(t.user)),s?s(e,b):null})},saveLock:function(e,t){E[e]=t},getLock:function(e){return E[e]},saveReservations:function(e){for(var t=0;t<e.length;t++)w[e[t].confirmation_code]=e[t]},getReservation:function(e,t){var n=w[e],i=this;if(n)return t(null,new f(n));r.execute("API:GetReservation",e,function(e,n){if(e)return t(e);i.saveReservations([n]),t(null,new f(n))})},clearReservation:function(e){w={}}})})}),define("collections/reservations",["backbone","models/reservation"],function(e,t){var n=e.Collection.extend({model:t});return n}),define("modules/messages",["jquery","underscore","app","modules/data","modules/helper","models/city","models/restaurant","models/reservation","collections/restaurants","collections/reservations"],function(e,t,n,r,i,s,o,u,a,f){var l="/api/v2",c="/api/v1",h="k2Rw6FRzFcuS0suyVIRk96mOIyKEhtH89Fvqz377htFrymvd7IfIPonvzmt87v3",p={enableHighAccuracy:!0,maximumAge:3e4,timeout:15e3},d=function(t){return function(n){e.getJSON(t).success(function(e){n&&n(null,e)}).error(function(e){n&&n(e)})}},v=function(t,n){return function(r){e.ajax({type:"POST",url:t,data:JSON.stringify(n),contentType:"application/json"}).success(function(e){r&&r(null,e)}).error(function(e){r&&r(e)})}},m=function(t,n){return function(r){e.ajax({type:"PUT",url:t,data:JSON.stringify(n),contentType:"application/json"}).success(function(e){r&&r(null,e)}).error(function(e){r&&r(e)})}};n.commands.setHandler("SaveFilterCuisines",function(e,t){r.setFilterCuisines(e,t)}),n.commands.setHandler("SaveFilterNeighborhoods",function(e,t){r.setFilterNeighborhoods(e,t)}),n.commands.setHandler("GetFilter",function(e,t){r.getFilter(e,t)}),n.reqres.setHandler("GetFilterSimple",function(e){return r.getFilterSimple(e)}),n.commands.setHandler("API:GetMetros",function(e,t,n){var r=e&&t?d(l+"/metros?lat="+e+"&lng="+t):d(l+"/metros");r(n)}),n.commands.setHandler("API:CreateMetroEmail",function(e,t){var n=v(l+"/new_metro_emails",{new_metro_email:e});n(t)}),n.commands.setHandler("CreateMetroEmail",function(e,t){n.execute("API:CreateMetroEmail",e,function(e,n){t(e,n)})}),n.reqres.setHandler("GetCurrentCity",function(){var e=localStorage.getItem("CurrentCity");return e?new s(JSON.parse(e)):null}),n.commands.setHandler("SetCurrentCity",function(e){e?localStorage.setItem("CurrentCity",JSON.stringify(e)):localStorage.removeItem("CurrentCity")}),n.reqres.setHandler("GetLocation",function(){var e=localStorage.getItem("Location");return e?JSON.parse(e):null}),n.commands.setHandler("SetLocation",function(e){e?localStorage.setItem("Location",JSON.stringify(e)):localStorage.removeItem("Location")}),n.commands.setHandler("API:GetCuisines",function(e,t){var n=d(l+"/metros/"+e+"/cuisine_types");n(t)}),n.commands.setHandler("GetCuisines",function(e,t){r.getCuisinesByMetro(e,t)}),n.commands.setHandler("API:GetNeighborhoods",function(e,t){var n=d(l+"/metros/"+e+"/neighborhoods");n(t)}),n.commands.setHandler("GetNeighborhoods",function(e,t){r.getNeighborhoodsByMetro(e,t)}),n.commands.setHandler("API:SignUp",function(e,t){var n=v(l+"/users/sign_up.json",e);n(t)}),n.commands.setHandler("API:SignIn",function(e,t){var n=v(l+"/users/sign_in.json",e);n(t)}),n.commands.setHandler("API:SignOut",function(e){var t=d(l+"/users/sign_out.json");t(e)}),n.commands.setHandler("API:GetUser",function(e){var t=d(l+"/user");t(e)}),n.commands.setHandler("API:UpdateUser",function(e,t,n,r,i){t.first_favorite_food=n.at(0)?n.at(0).get("value"):null,t.second_favorite_food=n.at(1)?n.at(1).get("value"):null,t.third_favorite_food=n.at(2)?n.at(2).get("value"):null,t.first_favorite_neighborhood=r.at(0)?r.at(0).get("value"):null,t.second_favorite_neighborhood=r.at(1)?r.at(1).get("value"):null,t.third_favorite_neighborhood=r.at(2)?r.at(2).get("value"):null;var s=m(l+"/user/"+e,{user:t});s(i)}),n.commands.setHandler("SignUp",function(e,t){r.signUp(e,t)}),n.commands.setHandler("SignIn",function(e,t){r.signIn(e,t)}),n.commands.setHandler("SignOut",function(e){r.signOut(e)}),n.commands.setHandler("UpdateCurrentUser",function(e,t,n,i,s){r.updateCurrentUser(e,t,n,i,s)}),n.commands.setHandler("GetCurrentUser",function(e){r.getCurrentUser(e)}),n.commands.setHandler("API:GetAvailableSlots",function(e,t,n,r,s,o){var u=d(l+"/metros/"+e+"/available_slots?start_time="+i.formatDateForApi(t,s)+"&end_time="+i.formatDateForApi(n,s)+"&party_size="+r);u(o)}),n.commands.setHandler("GetRestaurants",function(e,r,i,s,o,u,f,l){n.execute("GetMetro",e,function(c,h){if(c)return l(c);n.execute("GetRestaurantsByMetro",e,f,u,function(u,f){if(u)return l(u);n.execute("API:GetAvailableSlots",e,r,i,s,h.get("current_time_offset"),function(e,n){if(e)return l(e);var i=new a(f.filter(function(e){var i=t(n).findWhere({id:e.get("id")});return i?(e.set("slots",i.slots),e.set("special_meals_slots",i.special_meals),e.set("selectedTime",o),e.set("selectedDate",r),!0):!1}));l(null,i)})})})}),n.commands.setHandler("API:GetRestaurantExtended",function(e,t){var n=d(l+"/restaurants/"+e+"/extended_attrs");n(t)}),n.commands.setHandler("API:GetRestaurant",function(e,t){var n=d(l+"/restaurants/"+e);n(t)}),n.commands.setHandler("API:GetAvailableSlotsForRestaurant",function(e,t,n,r){var s=d(l+"/restaurants/"+e+"/available_slots_for_date?date="+i.formatDateForApi(t)+"&party_size="+n);s(r)}),n.commands.setHandler("GetRestaurant",function(e,t,i,s,o){typeof t=="function"&&(o=t),r.getRestaurantExtended(e,function(r,u){if(r)return o(r);typeof i!="undefined"&&typeof s!="undefined"?n.execute("API:GetAvailableSlotsForRestaurant",e,t,i,function(e,n){if(e)return o(e);n.slots&&n.slots.length>0?u.set("slots",n.slots):u.set("slots",[]),n.special_meals&&n.special_meals.length>0?u.set("special_meals_slots",n.special_meals):u.set("special_meals_slots",[]),s&&u.set("selectedTime",s),t&&u.set("selectedDate",t),i&&u.set("party",i),u.set("current_time_offset",n.current_time_offset),o(null,u)}):o(null,u)})}),n.commands.setHandler("API:GetRestaurantsByMetro",function(e,t,n,r,i,s){var o=d(l+"/metros/"+e+"/restaurants?per_page="+t+"&page_number="+n+(r&&i?"&lat="+r+"&lng="+i:""));o(s)}),n.commands.setHandler("GetRestaurantsByMetro",function(e,t,n,i){r.getRestaurantsByMetro(e,t,!1,n,i)}),n.commands.setHandler("GetEditorsPicksByMetro",function(e,t){r.getRestaurantsByMetro(e,null,!0,null,t)}),n.commands.setHandler("GetMetros",function(e){navigator.geolocation.getCurrentPosition(function(i){n.execute("SetLocation",{lat:i.coords.latitude,lng:i.coords.longitude}),r.getMetros(e,i.coords.latitude,i.coords.longitude)},function(i){n.execute("SetLocation",null),r.getMetros(e)},p)}),n.commands.setHandler("GetMetro",function(e,t){r.getMetro(e,t)}),n.commands.setHandler("API:LockReservation",function(e,t,n){var r=v(l+"/restaurants/"+e+"/locks",t);r(n)}),n.commands.setHandler("API:ConfirmReservation",function(e,n,r,i){var s={restaurant_id:e,key:h};t.extend(s,g(r));var o=v(c+"/iorders",s);o(i)}),n.commands.setHandler("ConfirmReservation",function(e,t,r){n.execute("GetRestaurant",e,function(s,o){if(s)return r(s);n.execute("API:LockReservation",e,{party_size:t.party,time:i.formatDateForApi(t.slotDate,o.get("current_time_offset")),special_meal_id:t.specialMealId},function(s,a){if(s)return r(s);n.execute("API:ConfirmReservation",e,a.lock_id,t,function(e,n){if(e)return r(e);var s=n.order,a={order_id:s.id,confirmation_code:s.confirmation_code,party_size:t.party,reserved_for:i.formatDateForApi(t.slotDate,o.get("current_time_offset")),restaurant_name:o.get("name"),special_request:t.additionalInfo.specialRequests,promo_code:t.additionalInfo.promoCode,email:t.user.email,first_name:t.user.firstName,last_name:t.user.lastName,phone_number:t.user.phone,email_reminder:s.email_reminder,sms_reminder:s.sms_reminder};r(e,new u(a))})})})}),n.commands.setHandler("API:CancelReservation",function(e,t){var n=m(l+"/orders/"+id+"/cancel?key="+h);n(t)}),n.commands.setHandler("CancelReservation",function(e,t){n.execute("API:CancelReservation",e,function(e,n){t(e,n)})}),n.commands.setHandler("API:GetReservations",function(e){var t=d(l+"/reservations");t(e)}),n.commands.setHandler("GetReservations",function(e){n.execute("API:GetReservations",function(n,s){if(n==null)if(s.error)e(s.error);else if(s.reservations){var o=s.reservations;o=t.filter(o,function(e){return e.state!="pending"||i.newDate(e.reserved_for,e.current_time_offset)>i.newDate(new Date,e.current_time_offset)}),r.saveReservations(o),e(null,new f(o))}else e(null,s);else e(n)})}),n.commands.setHandler("API:GetReservation",function(e,t){var n=d(l+"/reservations/"+e);n(t)}),n.commands.setHandler("GetReservation",function(e,t){r.getReservation(e,t)}),n.commands.setHandler("CancelReservation",function(e,t){n.execute("API:CancelReservation",e,function(e,n){if(e)return t(e);r.clearReservation(),t(null)})}),n.commands.setHandler("API:CancelReservation",function(e,t){var n=m(c+"/orders/"+e+"/cancel?key="+h);n(t)}),n.reqres.setHandler("GetLock",function(e){var t=r.getLock(e);return t?new u(t):null}),n.commands.setHandler("API:UpdateReservation",function(e,t,n){var r=m(l+"/reservations/"+e,t);r(n)}),n.commands.setHandler("API:UpdateReservationReminders",function(e,t,n,r){var i=m(l+"/reservations/"+e,{reservation:{sms_reminder:t,email_reminder:n}});i(r)}),n.commands.setHandler("UpdateReservation",function(e,t,i){var s=g(t);n.execute("API:UpdateReservation",e,s,function(e,t){return e?i(e):(r.saveReservations([t.reservation]),i(null,new u(t.reservation)))})}),n.commands.setHandler("UpdateReservationReminders",function(e,t,i,s){n.execute("API:UpdateReservationReminders",e,t,i,function(e,t){return e?s(e):(r.saveReservations([t.reservation]),s(null,new u(t.reservation)))})});var g=function(e){var t={reservation:{party_size:e.party,reserved_for:i.formatDateForApi(e.slotDate,e.timeOffset),promo_code:e.additionalInfo.promoCode,special_request:e.additionalInfo.specialRequests,email_reminder:e.additionalInfo.emailReminder,sms_reminder:e.additionalInfo.smsReminder,email:e.user.email,first_name:e.user.firstName,last_name:e.user.lastName,phone_number:e.user.phone,special_meal_id:e.specialMealId}};return e.user.isAuthorized===!0&&(t.reservation.user={id:e.user.id}),t};return{}}),define("BaseController",["marionette","app","views/shared/error"],function(e,t,n){var r=e.Controller.extend({initialize:function(){this.contentLayout=this.options.contentLayout,this.topBarLayout=this.options.topBarLayout},errorPartial:function(e){e=typeof e=="string"?e:null;var t=new n({error:e});return this.contentLayout.show(t),this.toggleLoading(!1),!1},toggleLoading:function(e){e?t.loading.show(t.loadingView):t.loading.close()},checkCurrentCity:function(){var e=t.request("GetCurrentCity");return e==null?(t.router.navigate("",{trigger:!0}),null):e.get("id")}});return r}),define("models/searchBar",["backbone"],function(e){var t=e.Model.extend({});return t}),define("text!templates/searchResults/content.html",[],function(){return'<!-- Search results -->\r\n<section class="searchResults">\r\n    <div id="searchForm"></div>\r\n    <!-- Results list -->\r\n    <div id="restaurants"></div>\r\n</section>'}),define("views/searchResults/searchResults",["marionette","underscore","text!templates/searchResults/content.html"],function(e,t,n){var r=Backbone.Marionette.Layout.extend({template:t.template(n),regions:{searchBar:"#searchForm",resultsHolder:"#restaurants"}});return r}),define("text!templates/searchResults/searchHeader.html",[],function(){return'<% if (typeof(showSearchBar) != "undefined" && showSearchBar) { %>\r\n<div class="searchForm">\r\n    <input class="searchField" type="text" placeholder="Search by name, cuisine, etc" />\r\n    <a class="searchFormClear" href="#">Clear</a>\r\n    <a class="searchFormButton" href="#"><span>&nbsp</span>;</a>\r\n</div>\r\n<% } if (typeof(showTimingBar) != "undefined" && showTimingBar) { %>\r\n<% var showTimesDdl =  (typeof(showTimes) != "undefined" && showTimes); %>\r\n<div class="<%= showTimesDdl ? \'timing column3\' : \'chooseTimeSelect column2\' %>">\r\n    <div class="selectForm column">\r\n        <select class="select partySize">\r\n            <option value="1">1 people</option>\r\n            <option value="2" selected>2 people</option>\r\n            <option value="3">3 people</option>\r\n            <option value="4">4 people</option>\r\n            <option value="5">5 people</option>\r\n            <option value="6">6 people</option>\r\n            <option value="7">7 people</option>\r\n            <option value="8">8 people</option>\r\n        </select>\r\n    </div>\r\n    <input type="hidden" class="date" />\r\n    <div class="datePicker column">Today</div>\r\n    <% if(showTimesDdl) { %>\r\n        <div class="selectForm column">\r\n            <select class="select time">\r\n                <option>7:00p</option>\r\n            </select>\r\n        </div>\r\n    <% } %>\r\n</div>\r\n\r\n<% if(typeof(special_meals) != "undefined" && special_meals && special_meals.length > 0) { %>\r\n    <div class="chooseMeals">\r\n        <label class="chooseMealsLabel">Meal:</label>\r\n        <div class="selectForm small">\r\n            <select class="select ddlSpecialMeals">\r\n                <% for (var i = 0; i < special_meals.length; i++) { %>\r\n                    <option value="<%= special_meals[i].special_meal_id %>"><%= special_meals[i].name %></option>\r\n                <% } %>\r\n            </select>\r\n        </div>\r\n    </div>\r\n<% } %>\r\n<div class="searchResultsSubmit hide">\r\n    <input class="btn small btnFindTable" type="submit" value="Find a Table">\r\n</div>\r\n<% } %>'}),define("views/searchResults/searchBar",["marionette","underscore","modules/helper","text!templates/searchResults/searchHeader.html"],function(e,t,n,r){var i=e.ItemView.extend({template:t.template(r),events:{"click .searchFormClear":"btnClearClick","click .searchFormButton":"btnSearchClick","click .btnFindTable":"btnFindTableClick","click .datePicker":"datePickerClick","change .partySize, .time":"filterParametersChanged","change .partySize":"partySizeChanged","change .ddlSpecialMeals":"ddlSpecialMealsChanged"},ui:{party:".partySize",dateLabel:".datePicker",date:".date",time:".time",txtSearch:".searchField",searchForm:".searchForm",searchSubmit:".searchResultsSubmit",ddlSpecialMeals:".ddlSpecialMeals"},serializeData:function(){var e=this.model.toJSON();return t.extend(e,{specialMealId:this.specialMealId})},initialize:function(){this.model.get("special_meals")&&(this.specialMealId=this.options.specialMealId)},onRender:function(){var e=this,t=this.model.get("showTimingBar"),n=this.model.get("showTimes"),r=this.model.get("party"),i=this.model.get("date"),s=this.model.get("time"),o=this.model.get("query"),u=this.model.get("special_meals");this.ui.searchForm.addClass("empty");if(t===!0){n===!0&&this.rerenderTime(i),typeof r!="undefined"&&this.ui.party.val(r),typeof i!="undefined"&&(this.ui.dateLabel.text(i),this.ui.date.val(i)),typeof s!="undefined"&&this.ui.time.val(s),typeof o!="undefined"&&(this.ui.txtSearch.val(o),o.length>0?this.ui.searchForm.removeClass("empty"):this.ui.searchForm.addClass("empty"));var a=this.ui.date,f=this.ui.dateLabel;e.setDateText(i,this.ui.dateLabel),this.filterParametersChanged(!0)}this.specialMealId&&this.ui.ddlSpecialMeals.val(this.specialMealId)},setDateText:function(e,t){t.text(n.formatDateRelative(e))},datePickerClick:function(e){e.preventDefault(),this.trigger("datePickerClicked",this.model.get("date"))},btnClearClick:function(e){e.preventDefault(),this.ui.txtSearch.val(""),this.ui.searchForm.addClass("empty"),this.searchChanged()},btnSearchClick:function(e){e.preventDefault(),this.ui.txtSearch.val().length>0?this.ui.searchForm.removeClass("empty"):this.ui.searchForm.addClass("empty"),this.searchChanged()},btnFindTableClick:function(e){e.preventDefault(),this.filterChanged()},filterParametersChanged:function(e){if(this.ui.time.val()==null)return this.trigger("timeExpired");var t,r,i,s=!1;this.model.set("party",parseInt(this.ui.party.val(),10)),this.model.set("time",this.ui.time.val());if(this.options.showFindButton!==!0)return!0;t=this.options.defaults.party,r=this.options.defaults.date,i=this.options.defaults.time,t.toString().toLowerCase()==this.model.get("party").toString().toLowerCase()?this.ui.party.removeClass("updated"):(this.ui.party.addClass("updated"),s=!0),n.formatDate(r)==n.formatDate(this.model.get("date"))?this.ui.dateLabel.removeClass("updated"):(this.ui.dateLabel.addClass("updated"),s=!0),i.toLowerCase()==this.model.get("time").toLowerCase()?this.ui.time.removeClass("updated"):(this.ui.time.addClass("updated"),s=!0),e!==!0||s?this.ui.searchSubmit.show():this.ui.searchSubmit.hide()},partySizeChanged:function(){this.trigger("partySizeChanged",parseInt(this.ui.party.val(),10))},filterChanged:function(){var e=this.model.get("date"),t;e&&(t=n.formatDate(e)),this.trigger("filterParametersChanged",{party:this.ui.party.val(),date:t,time:this.ui.time.val()})},searchChanged:function(){this.model.set("searchQuery",this.ui.txtSearch.val()),this.trigger("searchParametersChanged",{searchQuery:this.ui.txtSearch.val()})},rerenderTime:function(e){var r=n.getTimes(e),i=t(r).map(function(e){return'<option value="'+e.value+'" '+(e.selected?"selected":"")+">"+e.text+"</option>"});this.ui.time.empty().append(i)},ddlSpecialMealsChanged:function(){var e=parseInt(this.ui.ddlSpecialMeals.val(),10);this.specialMealId=isNaN(e)?null:e,this.trigger("specialMealsChanged",this.specialMealId)}});return i}),define("text!templates/searchResults/restaurant.html",[],function(){return'<div class="resultsListItemPhoto">\r\n    <% if(thumbImage().length > 0) { %>\r\n        <img src="<%= thumbImage() %>" alt="" />\r\n    <% } %>\r\n</div>\r\n<div class="resultsListItemHolder">\r\n    <div class="resultsListInfo">\r\n        <h3 class="resultsListTitle"><a href="#"><%= name %></a></h3>\r\n        <p class="resultsListLocation"><%= neighborhood.name %></p>\r\n        <p class="resultsListType"><%= cuisinesText() %></p>\r\n        <ul class="resultsListSchedule">\r\n            <%\r\n                var slotsF = slotsFormated(specialMealId);\r\n                for (var i = 0; i < slotsF.length; i++) { %>            \r\n\r\n                <%if(!slotsF[i].isEmpty) { %>\r\n                    <li><a href="#" class="btnSlot" data-time="<%= slotsF[i].value %>"><%= slotsF[i].text %></a></li>\r\n                <% } else { %>            \r\n                    <li>-----</li>\r\n                <% } \r\n            } %>\r\n        </ul>\r\n    </div>\r\n    <div class="resultsListMeta">\r\n        <% if(distance_to_restaurant) { %>\r\n            <p><%= distanceText() %></p>\r\n        <% } %>\r\n        <p><%= priceSymbols() %></p>\r\n        <div class="rateit rating small" data-rateit-value="<%= rating %>" data-rateit-ispreset="true" data-rateit-readonly="true" data-rateit-starwidth="10" data-rateit-starheight="10"></div>\r\n    </div>\r\n    <% if(has_special_meals) { %>\r\n        <div class="chooseMeals resultsListItemMeals">\r\n            <label class="chooseMealsLabel">Meal:</label>\r\n            <div class="selectForm small">\r\n                <select class="select ddlSpecialMeals">                    \r\n                    <% for (var i = 0; i < special_meals.length; i++) { %>\r\n                        <option value="<%= special_meals[i].special_meal_id %>"><%= special_meals[i].name %></option>\r\n                    <% } %>\r\n                </select>\r\n            </div>\r\n        </div>\r\n    <% } %>\r\n</div>'}),define("text!templates/searchResults/restaurantSimple.html",[],function(){return'<div class="resultsListItemPhoto">\r\n    <% if(thumbImage().length > 0) { %>\r\n        <!--<img src="/img/assets/img-1.jpg" alt="" />-->\r\n        <img src="<%= thumbImage() %>" alt="" />\r\n    <% } %>\r\n</div>\r\n<div class="resultsListItemHolder">\r\n    <div class="resultsListInfo">\r\n        <h3 class="resultsListTitle"><a href="#"><%= name %></a></h3>\r\n        <p class="resultsListLocation"><%= neighborhood.name %></p>\r\n        <p class="resultsListType"><%= cuisinesText() %></p>\r\n    </div>\r\n    <div class="resultsListMeta">\r\n        <% if(distance_to_restaurant) { %>\r\n            <p><%= distanceText() %></p>\r\n        <% } %>\r\n        <p><%= priceSymbols() %></p>\r\n        <div class="rateit rating small" data-rateit-value="<%= rating %>" data-rateit-ispreset="true" data-rateit-readonly="true" data-rateit-starwidth="10" data-rateit-starheight="10"></div>\r\n    </div>\r\n</div>'}),define("views/searchResults/restaurant",["marionette","underscore","text!templates/searchResults/restaurant.html","text!templates/searchResults/restaurantSimple.html"],function(e,t,n,r){var i=e.ItemView.extend({getTemplate:function(){return this.options.showSimple?t.template(r):t.template(n)},tagName:"article",className:"resultsListItem",ui:{rateit:".rateit",ddlSpecialMeals:".ddlSpecialMeals"},events:{click:"rootClick","click .resultsListTitle a":"goToRestaurantInfo","click .btnSlot":"gotoReservation","change .ddlSpecialMeals":"ddlSpecialMealsChanged"},serializeData:function(){var e=this.model.toJSON();return t.extend(e,{specialMealId:this.specialMealId})},initialize:function(){this.model.get("has_special_meals")&&this.model.get("special_meals_slots")&&this.model.get("special_meals_slots").length>0&&(this.specialMealId=this.model.get("special_meals_slots")[0].id)},onRender:function(){this.ui.rateit.rateit(),this.specialMealId&&this.ui.ddlSpecialMeals.val(this.specialMealId)},goToRestaurantInfo:function(e){e.preventDefault();var t=this.model.get("id"),n;n=this.options.showSimple===!0?"restaurants/"+t+"/info":"restaurants/"+t+"/party/"+this.options.party+"/date/"+this.options.date+"/time/"+this.options.time+"/info",app.router.navigate(n,{trigger:!0})},gotoReservation:function(e){e.preventDefault();var t=this.$(e.target).data("time"),n=this.model.get("id"),r=this.options.date,i=this.options.time,s=this.options.party;app.router.navigate(["restaurants/",n,"/party/",s,"/date/",r,"/time/",i,"/search/complete-reservation/",t,this.specialMealId!=null?"/meal/"+this.specialMealId:""].join(""),{trigger:!0})},rootClick:function(e){this.options.showSimple===!0&&this.goToRestaurantInfo(e)},ddlSpecialMealsChanged:function(){var e=parseInt(this.ui.ddlSpecialMeals.val(),10);this.specialMealId=isNaN(e)?null:e,this.render()}});return i}),define("text!templates/shared/noResults.html",[],function(){return'<h3 class="title">No results found</h3>'}),define("views/shared/noResults",["marionette","underscore","text!templates/shared/noResults.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n)});return r}),define("views/searchResults/restaurants",["marionette","underscore","views/searchResults/restaurant","views/shared/noResults"],function(e,t,n,r){var i=e.CollectionView.extend({itemView:n,emptyView:r,itemViewOptions:function(e,t){return this.options}});return i}),define("text!templates/searchResults/page.html",[],function(){return'<h2 class="resultsTitle pick">Editor’s Picks</h2>\r\n<div class="editorsPicks resultsList"></div>\r\n<h2 class="resultsTitle all">All Restaurants</h2>\r\n<div class="allRestaurants resultsList"></div>\r\n'}),define("views/searchResults/restaurantsPage",["marionette","underscore","app","views/searchResults/restaurants","text!templates/searchResults/page.html"],function(e,t,n,r,i){var s=e.Layout.extend({template:t.template(i),regions:{restaurants:".allRestaurants",editorsPicks:".editorsPicks"},ui:{picksLabel:".resultsTitle.pick",restaurantsLabel:".resultsTitle.all",editorsPicks:".editorsPicks"},onRender:function(){var e=this.model.get("key"),t=this.model.get("value");e==null||e.length==0?(this.editorsPicks.close(),this.ui.editorsPicks.hide(),this.ui.picksLabel.hide()):this.editorsPicks.show(new r({collection:e,showSimple:this.options.showSimple})),this.restaurants.show(new r({collection:t,showSimple:this.options.showSimple,party:this.options.party,date:this.options.date,time:this.options.time,cityId:this.options.cityId})),this.options.isBrowseAll||this.ui.restaurantsLabel.hide()}});return s}),define("views/searchResults/restaurantsPages",["marionette","underscore","views/searchResults/restaurantsPage"],function(e,t,n){var r=e.CollectionView.extend({itemView:n,itemViewOptions:function(e,t){return this.options}});return r}),define("text!templates/shared/calendar.html",[],function(){return'<div id="datepicker"></div>'}),define("views/shared/calendar",["app","marionette","underscore","text!templates/shared/calendar.html"],function(e,t,n,r){var i=t.ItemView.extend({template:n.template(r),ui:{date:"#datepicker"},onRender:function(){var e=this,t=this.ui.date;this.ui.date.datepicker({minDate:new Date,maxDate:"+90d",dateFormat:"yy-mm-dd",nextText:"&#9658",prevText:"&#9668",onSelect:function(n){var r=t.datepicker("getDate");e.trigger("dateSelected",r)}}),this.options.date&&this.ui.date.datepicker("setDate",this.options.date)}});return i}),define("controllers/restaurants",["underscore","app","modules/helper","BaseController","models/restaurant","models/topBar","models/searchBar","views/shared/topBar","collections/restaurants","collections/dictionary","views/searchResults/searchResults","views/searchResults/searchBar","views/searchResults/restaurantsPages","views/shared/calendar","views/searchResults/restaurant","views/searchResults/restaurants"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=r.extend({index:function(){var e=this,n,r,i,s=t.request("GetCurrentCity");if(!(r=this.checkCurrentCity()))return!0;n=t.request("GetFilterSimple",r);var u=new c({model:new o({showSearchBar:!0}),showFindButton:!0}),a=this.getResraurantsTopBarView(s,n);t.execute("GetEditorsPicksByMetro",r,function(s,o){if(s)return e.errorPartial();var f=function(t,n){if(t)return e.errorPartial();i==null&&(i=new l,e.contentLayout.show(i),i.searchBar.show(u));var r=new h({collection:e.getRestaurantSet(o,n),isBrowseAll:!0,showSimple:!0});i.resultsHolder.show(r),e.topBarLayout.show(a)};u.on("searchParametersChanged",function(e){t.execute("GetRestaurantsByMetro",r,n,e.searchQuery,f)}),t.execute("GetRestaurantsByMetro",r,n,null,f)})},getResraurantsTopBarView:function(e,t){var n=new s({leftText:"Home",leftUrl:"/find-table",rightText:"Filter",rightUrl:"restaurants/filter",subTitle:"Search for a restaurant in:",title:e.get("display_name"),rightCss:t&&!t.isDefault()?"red":""});return new u({model:n})},getRestaurantSet:function(t,n){if(t.length<3||n.length==0)return new f([{key:null,value:n}]);var r=e.map(e.range(Math.ceil(n.length/11)),function(e,r){var i=r*11;return{key:new a(t.shuffle().slice(0,3)),value:new a(n.toArray().slice(i,i+11))}});return new f(r)},search:function(e,r,i,s,o,u,a){var f=t.request("GetCurrentCity");if(!(cityId=this.checkCurrentCity()))return!0;var d=this,v=t.request("GetFilterSimple",cityId),m=!1,g=n.parseDate(r,i),y=new Date(g);g.setMinutes(g.getMinutes()-15),y.setMinutes(y.getMinutes()+15);var b=this.getSearchTopBarView({rightUrl:"search-results/party/"+e+"/date/"+encodeURIComponent(r)+"/time/"+i+"/filter",title:f.get("display_name"),rightCss:v&&!v.isDefault()?"red":""});searchBar=new c({model:d.getSearchModel(s||e,o||r,u||i,a),defaults:{party:e,date:r,time:i},showFindButton:!0});var w=new l,E=new p({date:o||r}),S=this.getCalendarTopBarView();searchBar.on("datePickerClicked",function(){d.topBarLayout.show(S),d.contentLayout.show(E),S.on("btnLeftClick",function(){d.search(e,r,i,searchBar.model.get("party"),o,searchBar.model.get("time"),searchBar.model.get("searchQuery"))}),E.on("dateSelected",function(t){d.search(e,r,i,searchBar.model.get("party"),n.formatDate(t),searchBar.model.get("time"),searchBar.model.get("searchQuery"))})}).on("timeExpired",function(){return t.router.navigate("find-table",{trigger:!0})});var x=function(e,t){if(e)return d.errorPartial();d.toggleLoading(!1);var n=new h({collection:d.getRestaurantSet([],t),party:searchBar.model.get("party"),date:o||r,time:searchBar.model.get("time"),cityId:cityId});m||(d.contentLayout.show(w),w.searchBar.show(searchBar),d.topBarLayout.show(b),m=!0),w.resultsHolder&&w.resultsHolder.show(n)};searchBar.on("filterParametersChanged",function(e){t.router.navigate("search-results/party/"+e.party+"/date/"+e.date+"/time/"+e.time,{trigger:!0})}),searchBar.on("searchParametersChanged",function(n){t.execute("GetRestaurants",cityId,g,y,e,i,n.searchQuery,v,x)}),t.execute("GetRestaurants",cityId,g,y,e,i,a,v,x)},getSearchTopBarView:function(t){var n=new s(e.extend({leftText:"Home",leftUrl:"find-table",rightText:"Filter",subTitle:"Search for a restaurant in:"},t));return new u({model:n})},getCalendarTopBarView:function(){var e=new s({leftText:"Cancel",leftUrl:"",title:"Date"});return new u({model:e,leftClickEvent:"btnLeftClick"})},getSearchModel:function(e,t,r,i){return typeof t=="string"&&(t=n.parseDate(t,r)),new o({showTimingBar:!0,showSearchBar:!0,showTimes:!0,party:e,date:t,time:r,query:i})}});return m}),define("text!templates/chooseCity/content.html",[],function(){return'<!-- Logo -->\r\n<strong class="logo">City Eats</strong>\r\n<!-- Current Locations -->\r\n<section class="currentLocations">\r\n    <div class="currentLocationsHeader">\r\n        <h2 class="title"><span class="titleText">Your Single Destination for Dining Out.</span></h2>\r\n        <p>Because you are where you eat.</p>\r\n    </div>\r\n    <div id="currentCity">\r\n        \r\n    </div>\r\n    <h3 class="title line" id="lbChooseCity"><span class="titleText">Choose Your City</span></h3>\r\n    <ul class="locationsButtons">        \r\n    </ul>\r\n</section>\r\n<!-- Find Your City -->\r\n<section class="form findYourCity">\r\n    \r\n</section>'}),define("views/chooseCity/content",["marionette","underscore","text!templates/chooseCity/content.html"],function(e,t,n){var r=Backbone.Marionette.Layout.extend({template:t.template(n),regions:{locationsButtons:".locationsButtons",findYourCity:".findYourCity",currentCity:"#currentCity"},onRender:function(){this.options.hasCurrentCity&&this.$el.find("#lbChooseCity").remove()}});return r}),define("text!templates/chooseCity/city.html",[],function(){return'<li class="locationsButtonsItem"><a class="btn" href="#"><%= display_name %></a></li>'}),define("text!templates/chooseCity/currentCity.html",[],function(){return'<div class="currentCity">\r\n    <a class="btn" href="#"><span class="btnText">Current:</span> <%= display_name %></a>\r\n</div>'}),define("views/chooseCity/city",["marionette","underscore","app","text!templates/chooseCity/city.html","text!templates/chooseCity/currentCity.html"],function(e,t,n,r,i){var s=e.ItemView.extend({getTemplate:function(){return this.model.get("isCurrent")?t.template(i):t.template(r)},events:{"click a.btn":"goToFindTable"},goToFindTable:function(e){var t=this.model.get("id");n.execute("SetCurrentCity",this.model),n.router.navigate("find-table",{trigger:!0}),e.preventDefault()}});return s}),define("views/chooseCity/cities",["marionette","underscore","views/chooseCity/city"],function(e,t,n){var r=e.CollectionView.extend({itemView:n});return r}),define("text!templates/chooseCity/dontSeeCity.html",[],function(){return'<div class="findYourCityHeader">\r\n    <h2 class="title"><span class="titleText">Don’t see your city?</span></h2>\r\n    <p>Give us your info, and we\'ll be sure to let you know when CityEats is coming to your city.</p>\r\n</div>\r\n<p class="textError txtError row hide">Error</p>\r\n<div class="row">\r\n    <label class="labelForm">Email</label>\r\n    <input class="textField txtEmail" type="email" />        \r\n</div>\r\n<div class="row">\r\n    <label class="labelForm">Zip Code</label>\r\n    <input class="textField txtZip" type="text" />\r\n</div>\r\n<div class="row">\r\n    <input class="btn pale btnSendNewCity" type="submit" value="Submit" />\r\n</div>'}),define("views/chooseCity/dontSeeCity",["marionette","underscore","basicItemView","text!templates/chooseCity/dontSeeCity.html"],function(e,t,n,r){var i=n.extend({template:t.template(r),events:{"click .btnSendNewCity":"btnSendNewCityClick"},ui:{txtZip:".txtZip",txtEmail:".txtEmail",txtError:".txtError"},btnSendNewCityClick:function(e){e.preventDefault();var t=this.ui.txtEmail.val(),n=this.ui.txtZip.val();this.trigger("submitNewCity",t,n)}});return i}),define("controllers/metros",["underscore","app","modules/helper","BaseController","models/city","models/topBar","collections/cities","views/chooseCity/content","views/chooseCity/city","views/chooseCity/cities","views/chooseCity/dontSeeCity","views/shared/topBar"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=r.extend({index:function(e){var r=this,i;t.execute("GetCurrentUser",function(s,c){t.execute("GetMetros",function(s,h){if(s)return r.errorPartial();topBarView=p(),r.topBarLayout.show(topBarView),c&&topBarView.hideRightButton();var d=t.request("GetCurrentCity");if(d){if(!e)return t.router.navigate("find-table",{trigger:!0});d.set("isCurrent",!0),h=new o(h.filter(function(e){return e.get("id")!=d.get("id")})),i=new u({hasCurrentCity:!0}),t.content.show(i),i.currentCity.show(new a({model:d}))}else i=new u,t.content.show(i);var v=new f({collection:h}),m=new l;m.on("submitNewCity",function(e,i){var s={email:e,zip:i},o=this;t.execute("CreateMetroEmail",s,function(e,t){if(e==null){o.hideError(),alert("Thanks for your interest. We'll be sure to let you know when we're coming to your city!");return}var i=n.getErrorMessage(e);i?o.showError(i,null,"main"):r.errorPartial()})},m),i.findYourCity.show(m),i.locationsButtons.show(v)})})}}),p=function(){var e=new s({leftText:"Home",leftUrl:"back",rightText:"Log In",rightUrl:"login",title:"Choose Your City"});return new c({model:e})};return h}),define("text!templates/login/content.html",[],function(){return'<!-- Content -->\r\n<div class="content hasFooter">\r\n    <!-- Log In -->\r\n    <section class="form logIn">\r\n        <a class="fbLoginBtn" href="#">Log In with Facebook</a>\r\n        <h3 class="title grey line"><span class="titleText">Or</span></h3>\r\n        <p class="textError txtError row hide">Error</p>\r\n        <div class="row">\r\n            <label class="labelForm">Email</label>\r\n            <input class="textField txtEmail" type="email" value=""/>\r\n            <p class="textError txtEmailError hide">Error</p>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Password</label>\r\n            <input class="textField txtPassword" type="password" value="" />\r\n            <p class="textError txtPasswordError hide">Error</p>\r\n        </div>\r\n        <div class="row">\r\n            <input class="btn btnSubmit" type="submit" value="Log In" />\r\n        </div>\r\n        <div class="helpLink">\r\n            <a href="#" class="btnForgotPassword">Forgot Your Password?</a>\r\n        </div>\r\n        \r\n    </section>\r\n</div>'}),define("views/login/login",["marionette","underscore","basicItemView","text!templates/login/content.html"],function(e,t,n,r){var i=n.extend({template:t.template(r),events:{"click .btnForgotPassword":"goToForgotPassword","click .btnSubmit":"btnSubmitClick"},ui:{txtEmail:".txtEmail",txtPassword:".txtPassword",txtEmailError:".txtEmailError",txtPasswordError:".txtPasswordError",txtError:".txtError",fbLoginBtn:".fbLoginBtn"},onRender:function(){var e="/auth/facebook?callback_url=/auth/facebook/callback/back";this.ui.fbLoginBtn.attr("href",e)},goToForgotPassword:function(e){e.preventDefault(),app.router.navigate("forgot-password",{trigger:!0})},btnSubmitClick:function(e){e.preventDefault(),this.validate()&&this.trigger("loginSubmited",{email:this.ui.txtEmail.val(),password:this.ui.txtPassword.val()})},validate:function(){var e=!0;return this.requireValidation("Email is a required field.",this.ui.txtEmail,this.ui.txtEmailError)||(e=!1),this.requireValidation("Password is a required field.",this.ui.txtPassword,this.ui.txtPasswordError)||(e=!1),e}});return i}),define("text!templates/signUp/content.html",[],function(){return'<!-- Content -->\r\n<div class="content hasFooter">\r\n    <!-- Sugn Up -->\r\n    <section class="form signUp">\r\n        <a class="fbLoginBtn" href="#">Sign Up with Facebook</a>\r\n        <h3 class="title grey line"><span class="titleText">Or</span></h3>        \r\n        <p class="textError txtError row hide">Error</p>\r\n        <div class="row">\r\n            <label class="labelForm">First Name <span class="labelFormRequired">*</span></label>\r\n            <input class="textField txtFirstName" type="text" />\r\n            <p class="textError txtFirstNameError hide">Error</p>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Last Name <span class="labelFormRequired">*</span></label>\r\n            <input class="textField txtLastName" type="text" />\r\n            <p class="textError txtLastNameError hide">Error</p>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Email <span class="labelFormRequired">*</span></label>\r\n            <input class="textField txtEmail" type="email" />\r\n            <p class="textError txtEmailError hide">Error</p>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Password <span class="labelFormRequired">*</span></label>\r\n            <input class="textField txtPassword" type="password" />\r\n            <p class="textError txtPasswordError hide">Error</p>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Confirm Password <span class="labelFormRequired">*</span></label>\r\n            <input class="textField txtPassword2" type="password" />\r\n            <p class="textError txtPassword2Error hide">Error</p>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Zip Code <span class="labelFormRequired">*</span></label>\r\n            <input class="textField txtZip" type="text" />\r\n            <p class="textError txtZipError hide">Error</p>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Phone Number <span class="labelFormRequired">*</span></label>\r\n            <input class="textField txtPhone" type="tel" />\r\n            <p class="textError txtPhoneError hide">Error</p>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">Birthday <span class="labelFormOptional">(optional)</span></label>\r\n            <div class="clearfix">\r\n                <div class="selectForm selectFormBirthdayMonth">\r\n                    <select class="select ddlMonth">\r\n                        <option>Month</option>\r\n                    </select>\r\n                </div>\r\n                <div class="selectForm selectFormBirthdayDay">\r\n                    <select class="select ddlDay">\r\n                        <option>Day</option>\r\n                    </select>\r\n                </div>\r\n                <div class="selectForm selectFormBirthdayYear">\r\n                    <select class="select ddlYear">\r\n                        <option>Year</option>\r\n                    </select>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelForm">How did you hear about us? <span class="labelFormOptional">(optional)</span></label>\r\n            <div class="selectForm">\r\n                <select class="select ddlHowHeard">\r\n                    <option>Internet</option>\r\n                    <option>Radio</option>\r\n                </select>\r\n            </div>\r\n        </div>\r\n        <div class="row">\r\n            <label class="labelFormHasCheckbox">\r\n                <span class="checkboxForm"><input class="checkbox cbAgree" type="checkbox" /></span>\r\n                By checking this box, you confirm that you have read, understood and agree to the CityEats <a href="#">terms of use</a> and <a href="#">privacy policy</a> <span class="labelFormRequired">*</span>\r\n            </label>\r\n        </div>\r\n        <div class="row">\r\n            <input class="btn btnSubmit" type="submit" value="Sign Up" />\r\n        </div>\r\n    </section>\r\n</div>'}),define("views/signUp/signUp",["app","marionette","underscore","basicItemView","text!templates/signUp/content.html"],function(e,t,n,r,i){var s=r.extend({template:n.template(i),events:{"click .btnSubmit":"btnSubmitClick","click .cbAgree":"cbAgreeClick","click .btnTermsPrivacy":"btnTermsPrivacyClick","change .ddlMonth":"ddlMonthChange","change .ddlYear":"ddlYearChange"},ui:{txtFirstName:".txtFirstName",txtFirstNameError:".txtFirstNameError",txtLastName:".txtLastName",txtLastNameError:".txtLastNameError",txtEmail:".txtEmail",txtEmailError:".txtEmailError",txtPassword:".txtPassword",txtPasswordError:".txtPasswordError",txtPassword2:".txtPassword2",txtPassword2Error:".txtPassword2Error",txtZip:".txtZip",txtZipError:".txtZipError",txtPhone:".txtPhone",txtPhoneError:".txtPhoneError",txtError:".txtError",cbAgree:".cbAgree",ddlMonth:".ddlMonth",ddlDay:".ddlDay",ddlYear:".ddlYear",ddlHowHeard:".ddlHowHeard",fbLoginBtn:".fbLoginBtn"},onRender:function(){var e="/auth/facebook?callback_url=/auth/facebook/callback/back";this.ui.fbLoginBtn.attr("href",e);var t=new Date,n=["<option>Year</option>"],r=["<option>Month</option>"],i=["<option></option>"],s=["January","February","March","April","May","June","July","August","September","October","November","December"],o=[{"Word of Mouth":1},{"Online ad":2},{Radio:3},{TV:4},{Print:5},{"Outdoor ad":6},{Other:7}];for(var u=1900;u<=t.getFullYear();u++)n.push('<option value="'+u+'"> '+u+"</option>");for(var u=0;u<s.length;u++)r.push('<option value="'+(u+1)+'"> '+s[u]+"</option>");for(var u=0;u<o.length;u++){var a=Object.keys(o[u]);i.push('<option value="'+o[u][a[0]]+'"> '+a[0]+"</option>")}this.ui.ddlYear.empty().append(n),this.ui.ddlMonth.empty().append(r),this.ui.ddlHowHeard.empty().append(i),this.buildDays()},btnTermsPrivacyClick:function(t){e.router.navigate("terms-privacy",{trigger:!0}),t.preventDefault()},btnSubmitClick:function(e){if(this.validate()){var t=parseInt(this.ui.ddlYear.val(),10),n=parseInt(this.ui.ddlMonth.val(),10),r=parseInt(this.ui.ddlDay.val(),10),i=parseInt(this.ui.ddlHowHeard.val()),s={email:this.ui.txtEmail.val(),password:this.ui.txtPassword.val(),password_confirmation:this.ui.txtPassword2.val(),first_name:this.ui.txtFirstName.val(),last_name:this.ui.txtLastName.val(),postal_code:this.ui.txtZip.val(),phone_number:this.ui.txtPhone.val()};!isNaN(t)&&!isNaN(n)&&!isNaN(r)&&(s["birthday(1i)"]=t.toString(),s["birthday(2i)"]=n.toString(),s["birthday(3i)"]=r.toString()),isNaN(i)||(s.referral_type_id=i),this.trigger("loginSubmited",s)}},cbAgreeClick:function(){this.hideError(this.ui.cbAgree)},ddlMonthChange:function(){this.buildDays()},ddlYearChange:function(){this.buildDays()},buildDays:function(){var e=parseInt(this.ui.ddlDay.val(),10),t=parseInt(this.ui.ddlYear.val(),10)||2001,n=parseInt(this.ui.ddlMonth.val(),10)||1,r=["<option>Day</option>"];for(var i=1;i<=(new Date(t,n,0)).getDate();i++)r.push('<option value="'+i+'"> '+i+"</option>");this.ui.ddlDay.empty().append(r),isNaN(e)||this.ui.ddlDay.val(e)},validate:function(){var e=!0;return this.requireValidation("First Name is a required field",this.ui.txtFirstName,this.ui.txtFirstNameError)||(e=!1),this.requireValidation("Last Name is a required field",this.ui.txtLastName,this.ui.txtLastNameError)||(e=!1),this.requireValidation("Email is a required field",this.ui.txtEmail,this.ui.txtEmailError)||(e=!1),this.requireValidation("Password is a required field",this.ui.txtPassword,this.ui.txtPasswordError)?this.ui.txtPassword.val().length<6?(e=!1,this.showError("Password must be at least 6 characters long.",this.ui.txtPassword,this.ui.txtPasswordError)):this.hideError(this.ui.txtPassword,this.ui.txtPasswordError):e=!1,this.requireValidation("Confirm Password is a required field",this.ui.txtPassword2,this.ui.txtPassword2Error)?this.ui.txtPassword.val()!==this.ui.txtPassword2.val()?(e=!1,this.showError("Password Confirmation must match Password.",this.ui.txtPassword2,this.ui.txtPassword2Error)):this.hideError(this.ui.txtPassword2,this.ui.txtPassword2Error):e=!1,this.requireValidation("Zip is a required field",this.ui.txtZip,this.ui.txtZipError)||(e=!1),this.requireValidation("Phone is a required field",this.ui.txtPhone,this.ui.txtPhoneError)||(e=!1),this.ui.cbAgree.is(":checked")?this.hideError(this.ui.cbAgree):(this.showError(null,this.ui.cbAgree),e=!1),e}});return s}),define("text!templates/shared/checkboxesListItem.html",[],function(){return'<input class="checkboxesListInput" id="cb_<%= key %>_<%= value.replace(\' \', \'\') %>" itemId="<%= key %>" type="checkbox" <% if(checked) { %> checked <% } %>/>\r\n<label class="checkboxesListLabel" for="cb_<%= key %>_<%= value.replace(\' \', \'\') %>"><%= value %></label>'}),define("views/shared/checkboxesListItem",["app","marionette","underscore","text!templates/shared/checkboxesListItem.html"],function(e,t,n,r){var i=t.ItemView.extend({tagName:"li",className:"checkboxesListItem",template:n.template(r),events:{"change input":"change"},change:function(e){var t=this.$(e.target).is(":checked");this.model.set("checked",t),this.trigger("checkboxChanged")}});return i}),define("text!templates/filter/cuisinesAndNeighborhoods.html",[],function(){return'<section class="cuisines">\r\n    <ul class="checkboxesList"></ul>\r\n</section>'}),define("views/filter/favoriteItems",["app","marionette","underscore","views/shared/checkboxesListItem","text!templates/filter/cuisinesAndNeighborhoods.html"],function(e,t,n,r,i){var s=t.CompositeView.extend({template:n.template(i),itemViewContainer:".checkboxesList",itemView:r,initialize:function(){var e=this;this.options.isFavorite&&this.collection.each(function(t){e.options.items.some(function(e){return e.get("value").toLowerCase()===t.get("value").toLowerCase()||e.get("key")===t.get("key")})?t.set("checked",!0):t.set("checked",!1)})},saveItems:function(){e.execute(this.options.isCuisines?"SaveFilterCuisines":"SaveFilterNeighborhoods",this.options.cityId,this.collection.where({checked:!0}).map(function(e){return e.get("key")}))}});return s}),define("controllers/account",["underscore","app","BaseController","modules/helper","models/topBar","models/keyValue","collections/dictionary","views/shared/topBar","views/login/login","views/signUp/signUp","views/account/profile/about","views/account/profile/edit","views/filter/favoriteItems"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.extend({login:function(e,n){var i=d(),s=new a({redirectUri:e});s.on("loginSubmited",function(e){var i=this;t.execute("SignIn",e,function(e,s){if(e==null)n?t.router.navigate(n,{trigger:!0}):t.router.navigate("back",{trigger:!0});else{var o=r.getErrorMessage(e);o?i.showError(o,null,"main"):that.errorPartial()}},s)}),this.topBarLayout.show(i),this.contentLayout.show(s)},signUp:function(e){var n=v(),i=new f({redirectUri:e});i.on("loginSubmited",function(e){var n=this;t.execute("SignUp",e,function(e,i){if(e==null)t.router.navigate("back",{trigger:!0});else{var s=r.getErrorMessage(e);s?n.showError(s,null,"main"):that.errorPartial()}})},i),this.topBarLayout.show(n),this.contentLayout.show(i)},profile:function(){var e=this;t.execute("GetCurrentUser",function(n,r){if(n)return e.errorPartial();if(r==null)return t.router.navigate("login",{trigger:!0});var i=g();contentView=new l({model:r}),t.topBar.show(i),t.content.show(contentView)})},profileEdit:function(n,r,i){var s=this,u=t.request("GetCurrentCity");if(!(cityId=s.checkCurrentCity()))return!0;t.execute("GetCurrentUser",function(u,a){if(a==null)return t.router.navigate("login",{trigger:!0});var f=a.get("favorite_cuisine_types"),l=a.get("favorite_neighborhoods");r==null&&(r=new o(e.map(f.length>0?f.split(","):[],function(e){return{value:e.trim()}}))),i==null&&(i=new o(e.map(l.length>0?l.split(","):[],function(e){return{value:e.trim()}})));var h=y();contentView=new c({model:a,cuisineItems:r,neighborhoodItems:i}),contentView.on("userSaved",function(e){t.execute("UpdateCurrentUser",a.get("id"),e,r,i,function(e,r){e==null?t.router.navigate(n?n:"profile",{trigger:!0}):contentView.showErrors(e)})}),t.topBar.show(h),t.content.show(contentView),contentView.on("ByNeighborhoodsClicked",function(){m(!1,cityId,i,function(e){s.profileEdit(n,r,e)})}).on("ByCuisinesClicked",function(){m(!0,cityId,r,function(e){s.profileEdit(n,e,i)})})})}}),d=function(){var e=new i({leftText:"Home",leftUrl:"back",rightText:"Sign Up",rightUrl:"signup",title:"Log In"});return new u({model:e})},v=function(){var e=new i({leftText:"Home",leftUrl:"back",rightText:"Log In",rightUrl:"login",title:"Sign Up"});return new u({model:e})},m=function(e,n,r,i){var s=this;t.execute(e?"GetCuisines":"GetNeighborhoods",n,function(n,u){if(n)return s.errorPartial();var a=e?b(r.length):w(r.length),f=new h({collection:u,items:r,isFavorite:!0});t.topBar.show(a),t.content.show(f),f.on("itemview:checkboxChanged",function(t){f.collection.where({checked:!0}).length>3?(t.model.set("checked",!1),t.render(),alert("Please choose up to 3 "+(e?"cuisines":"neighborhoods"))):a.changeTopBarTitleText("("+f.collection.where({checked:!0}).length+")")}),a.on("btnLeftClick",function(){i(null)}).on("btnRightClick",function(){i(new o(f.collection.where({checked:!0})))})})},g=function(){var e=new i({leftText:"Home",leftUrl:"back",title:"Account"});return new u({model:e})},y=function(){var e=new i({leftText:"Cancel",leftUrl:"profile",title:"Account"});return new u({model:e})},b=function(e){var t=new i({leftText:"Cancel",leftUrl:"",rightText:"Done",rightUrl:"",rightCss:"blue",title:"Favourite Cuisines",topBarTitleText:"("+e+")"});return new u({model:t,leftClickEvent:"btnLeftClick",rightClickEvent:"btnRightClick"})},w=function(e){var t=new i({leftText:"Cancel",leftUrl:"",rightText:"Done",rightUrl:"",rightCss:"blue",title:"Favourite Neighborhoods",topBarTitleText:"("+e+")"});return new u({model:t,leftClickEvent:"btnLeftClick",rightClickEvent:"btnRightClick"})};return p}),define("text!templates/findTable/content.html",[],function(){return'<section class="findaTable">\r\n    <div class="findaTableHeader">\r\n        <p>Find a Table in: <span class="city"><%= display_name %></span></p>\r\n    </div>\r\n    <div id="searchBar"></div>    \r\n    <div class="btnHolder">\r\n        <input class="btn btnFindTable" type="submit" value="Find Table" />\r\n    </div>\r\n    <div class="btnHolder">\r\n        <a href="#" class="btn pale btnBrowseAll">Browse All</a>\r\n    </div>\r\n    <div class="btnHolder">\r\n        <a href="#" class="btn pale btnChangeCity">Change City: <span class="btnText"><%= display_name %></span></a>\r\n    </div>\r\n    <div class="btnHolder column2 pnlLogin">\r\n        <div class="column"><a href="#" class="btn pale btnLogIn">Log In</a></div>\r\n        <div class="column"><a href="#" class="btn pale btnSignUp">Sign Up</a></div>\r\n    </div>\r\n    <div class="btnHolder pnlUser hide">\r\n        <a href="#" class="btn pale btnUser">Account: <span class="btnText"></span></a>\r\n    </div>\r\n    <div class="helpLink pnlLogOut">\r\n        <a class="findaTableLogOut btnLogOut" href="#">Log Out</a>\r\n    </div>\r\n    \r\n</section>'}),define("views/findTable/findTable",["app","marionette","underscore","text!templates/findTable/content.html"],function(e,t,n,r){var i=t.Layout.extend({template:n.template(r),regions:{search:"#searchBar"},events:{"click .btnLogIn":"goToLogIn","click .btnSignUp":"goToSignUp","click .btnChangeCity":"goToChangeCity","click .btnFindTable":"goToSearchResults","click .btnBrowseAll":"goToBrowseAll","click .btnUser":"goToUser","click .btnLogOut":"btnLogOutClick"},ui:{pnlLogin:".pnlLogin",pnlUser:".pnlUser",pnlLogOut:".pnlLogOut"},onRender:function(){this.options.user?(this.ui.pnlUser.show(),this.ui.pnlLogOut.show(),this.ui.pnlLogin.hide(),this.ui.pnlUser.find(".btnText").text(this.options.user)):(this.ui.pnlUser.hide(),this.ui.pnlLogOut.hide(),this.ui.pnlLogin.show())},goToLogIn:function(e){this.goTo(e,"login")},goToSignUp:function(e){this.goTo(e,"signup")},goToChangeCity:function(e){this.goTo(e,"change-city")},goToUser:function(e){this.goTo(e,"profile")},goToSearchResults:function(e){this.trigger("findTableClicked")},goToBrowseAll:function(e){this.goTo(e,"restaurants")},btnLogOutClick:function(e){e.preventDefault(),this.trigger("logOut")},goTo:function(t,n){t.preventDefault(),e.router.navigate(n,{trigger:!0})}});return i}),define("controllers/findTable",["underscore","app","modules/helper","BaseController","models/topBar","models/searchBar","views/shared/topBar","views/shared/calendar","views/findTable/findTable","views/searchResults/searchBar"],function(e,t,n,r,i,s,o,u,a,f){var l=r.extend({index:function(e,r,i){var s=this,o;party=2,e==null&&(e=new Date);if(!(o=this.checkCurrentCity()))return!0;t.execute("GetRestaurantsByMetro",o),t.execute("GetCuisines",o);var l=t.request("GetCurrentCity");if(l==null)return t.router.navigate("",{trigger:!0});t.execute("GetCurrentUser",function(o,c){var h;c&&(h=c.get("first_name")+" "+c.get("last_name"));var p=new a({model:l,user:h}),d=new f({model:s.getSearchModel(r||party,e,i),defaults:{party:2,date:e,time:i}}),v=new u({date:e}),m=s.getCalendarTopBarView();s.contentLayout.show(p),p.search.show(d),d.on("datePickerClicked",function(){m.on("btnLeftClick",function(){s.index(e,d.model.get("party"),d.model.get("time"))}),s.topBarLayout.show(m),s.contentLayout.show(v),v.on("dateSelected",function(e){d.model.set("date",e),s.index(e,d.model.get("party"),d.model.get("time"))})}).on("timeExpired",function(){return s.errorPartial()}),p.on("findTableClicked",function(){var e=d.model.get("date"),r=d.model.get("party"),i=d.model.get("time"),o="search-results/party/"+r+"/date/"+n.formatDate(e)+"/time/"+i;s.toggleLoading(!0),t.router.navigate(o,{trigger:!0})}).on("logOut",function(){t.execute("SignOut",function(t){if(t)return s.errorPartial();s.index(e,r,i)})})});var c=this.getTopBarView();this.topBarLayout.show(c)},getTopBarView:function(){var e=new i({title:"Find a Table"});return new o({model:e})},getCalendarTopBarView:function(){var e=new i({leftText:"Cancel",leftUrl:"",title:"Date"});return new o({model:e,leftClickEvent:"btnLeftClick"})},getSearchModel:function(e,t,r){return typeof t=="string"&&(t=n.parseDate(t,r)),new s({showTimingBar:!0,showTimes:!0,party:e,date:t,time:r})}});return l}),define("text!templates/filter/content.html",[],function(){return'<!-- Filter -->\r\n<section class="filter">\r\n    <form action="#">\r\n        <div class="row">\r\n            <div class="roundedBox">\r\n                <div class="roundedBoxRow">\r\n\r\n                    <div class="filterByItems byCuisines <% if(cuisineIds.length > 0) { %> updated <% } %>"><%= cuisinesText() %></div>\r\n                </div>\r\n                <div class="roundedBoxRow">\r\n                    <div class="filterByItems byNeighborhoods <% if(neighborhoodIds.length > 0) { %> updated <% } %>"><%= neighborhoodsText() %></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="row prices">\r\n            <ul class="radiosLine">                \r\n                <li class="radiosLineItem">\r\n                    <input id="price_$" type="checkbox" class="radiosLineInput" itemId="1" <% if(prices.indexOf(1) != -1) { %> checked <% } %> />\r\n                    <label for="price_$" class="radiosLineLabel">$</label>\r\n                </li>\r\n                <li class="radiosLineItem">\r\n                    <input id="price_$$" type="checkbox" class="radiosLineInput" itemId="2" <% if(prices.indexOf(2) != -1) {  %> checked <% }  %> />\r\n                    <label for="price_$$" class="radiosLineLabel">$$</label>\r\n                </li>\r\n                <li class="radiosLineItem">\r\n                    <input id="price_$$$" type="checkbox" class="radiosLineInput" itemId="3" <% if(prices.indexOf(3) != -1) {  %> checked <% }  %> />\r\n                    <label for="price_$$$" class="radiosLineLabel">$$$</label>\r\n                </li>\r\n                <li class="radiosLineItem">\r\n                    <input id="price_$$$$" type="checkbox" class="radiosLineInput" itemId="4" <% if(prices.indexOf(4) != -1) {  %> checked <% }  %> />\r\n                    <label for="price_$$$$" class="radiosLineLabel">$$$$</label>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class="sortBy">\r\n            <h2 class="sortByTitle">Sort results by:</h2>\r\n            <div class="row">\r\n                <ul class="radiosLine">\r\n                    <li class="radiosLineItem">\r\n                        <input id="price_Distance" type="radio" class="radiosLineInput" name="sort" itemId="1" <% if(sortBy == 1) {  %> checked <% }  %> />\r\n                        <label for="price_Distance" class="radiosLineLabel btnDistance">Distance</label>\r\n                    </li>\r\n                    <li class="radiosLineItem">\r\n                        <input id="price_Popular" type="radio" class="radiosLineInput" name="sort" itemId="2" <% if(sortBy == 2) {  %> checked <% }  %>/>\r\n                        <label for="price_Popular" class="radiosLineLabel">Popular</label>\r\n                    </li>\r\n                    <li class="radiosLineItem">\r\n                        <input id="price_AZ" type="radio" class="radiosLineInput" name="sort" itemId="3" <% if(sortBy == 3) {  %> checked <% }  %>/>\r\n                        <label for="price_AZ" class="radiosLineLabel">A - Z</label>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n        <div class="row">\r\n            <input class="btn" id="btnSubmit" type="submit" value="Apply" />\r\n        </div>\r\n    </form>\r\n</section>'}),define("views/filter/filter",["app","marionette","underscore","text!templates/filter/content.html"],function(e,t,n,r){var i=t.ItemView.extend({template:n.template(r),events:{"click .byCuisines":"goToCuisines","click .byNeighborhoods":"goToNeighborhoods","click #btnSubmit":"applyFilter","click .btnDistance":"btnDistanceClick",'change .radiosLineInput[type="checkbox"]':"pricesChanged",'change .radiosLineInput[type="radio"]':"sortByChanged"},ui:{btnDistance:".btnDistance"},initialize:function(){this.model.prepareData(),this.backUrl=this.options.isRestaurants?"restaurants":"search-results/party/"+this.options.searchSettings.party+"/date/"+this.options.searchSettings.date+"/time/"+this.options.searchSettings.time,this.cuisinesUrl=this.options.isRestaurants?"restaurants/filter/cuisines":"search-results/party/"+this.options.searchSettings.party+"/date/"+this.options.searchSettings.date+"/time/"+this.options.searchSettings.time+"/filter/cuisines",this.neighborhoodsUrl=this.options.isRestaurants?"restaurants/filter/neighborhoods":"search-results/party/"+this.options.searchSettings.party+"/date/"+this.options.searchSettings.date+"/time/"+this.options.searchSettings.time+"/filter/neighborhoods"},onRender:function(){this.checkChanges(),this.options.isLocation?this.ui.btnDistance.removeClass("disabled"):this.ui.btnDistance.addClass("disabled")},btnDistanceClick:function(e){this.options.isLocation!==!0&&e.preventDefault()},goToCuisines:function(t){e.router.navigate(this.cuisinesUrl,{trigger:!0}),t.preventDefault()},goToNeighborhoods:function(t){e.router.navigate(this.neighborhoodsUrl,{trigger:!0}),t.preventDefault()},applyFilter:function(t){t.preventDefault();var n=this,r=parseInt(this.$('input[name="sort"]:checked').attr("itemId"),10)||0,i=[],s=this.$('.prices input[type="checkbox"]:checked');s.each(function(e,t){i.push(parseInt(n.$(t).attr("itemId"),10)||0)}),this.model.set("sortBy",r),this.model.set("prices",i),e.router.navigate(this.backUrl,{trigger:!0})},pricesChanged:function(){this.checkChanges()},sortByChanged:function(){this.checkChanges()},checkChanges:function(){var e=this.$('.prices input[type="checkbox"]:checked'),t=parseInt(this.$('input[name="sort"]:checked').attr("itemId"),10)||0,n=e.length==0&&(this.options.isLocation&&t==1||!this.options.isLocation&&t==2)&&this.model.get("cuisineIds").length==0&&this.model.get("neighborhoodIds").length==0;this.trigger("filterChanged",n)},resetFilter:function(){this.model.resetFilter(),this.render()}});return i}),define("controllers/filter",["underscore","app","modules/helper","BaseController","models/topBar","models/filter","models/keyValue","collections/dictionary","views/shared/topBar","views/filter/filter","views/filter/favoriteItems"],function(e,t,n,r,i,s,o,u,a,f,l){var c=r.extend({index:function(e,n,r,i){var s=this,o;if(!(o=this.checkCurrentCity()))return!0;var u=e?"restaurants":"search-results/party/"+n+"/date/"+r+"/time/"+i,a=this.getTopBarView({leftUrl:u});t.execute("GetFilter",o,function(o,u){if(o)return s.errorPartial();var l=new f({model:u,isLocation:t.request("GetLocation")!=null,isRestaurants:e,searchSettings:{party:n,date:r,time:i}});s.contentLayout.show(l),s.topBarLayout.show(a),l.on("filterChanged",function(e){e?this.hideRightButton():this.showRightButton()},a),a.on("btnRightClick",function(){this.resetFilter()},l),u.isDefault()?a.hideRightButton():a.showRightButton()})},cuisines:function(e,t,n,r){this.basicCorNAction(!0,e,t,n,r)},neighborhoods:function(e,t,n,r){this.basicCorNAction(!1,e,t,n,r)},basicCorNAction:function(e,n,r,i,s){var o=this,u;if(!(u=this.checkCurrentCity()))return!0;var a=n?"restaurants/filter":"search-results/party/"+r+"/date/"+i+"/time/"+s+"/filter",f=this.getTopBarCorNView({leftUrl:a,rightUrl:a,tutle:e?"Cuisines":"Neighborhoods"});t.execute("GetFilter",u,function(r,i){if(r)return o.errorPartial();var s=new l({collection:i.get(e?"cuisines":"neighborhoods"),cityId:u,isCuisines:e,isRestaurants:n});f.on("btnRightClick",function(e){this.saveItems(),t.router.navigate(e,{trigger:!0})},s),o.contentLayout.show(s),o.topBarLayout.show(f)})},getTopBarView:function(t){var n=new i(e.extend({leftText:"Cancel",rightText:"Reset",rightCss:"hide red",rightUrl:"",title:"Filter"},t));return new a({model:n,rightClickEvent:"btnRightClick"})},getTopBarCorNView:function(t){var n=new i(e.extend({leftText:"Cancel",rightText:"Done",rightCss:"blue"},t));return new a({model:n,rightClickEvent:"btnRightClick"})}});return c}),define("text!templates/restaurant/menu.html",[],function(){return'<ul class="subNav">\r\n    <li class="subNavItem"><a class="subNavLink <%= (key == 0) ? \'active\' : \'\' %>" href="#" data-url="info">Info</a></li>\r\n    <li class="subNavItem"><a class="subNavLink <%= (key == 1) ? \'active\' : \'\' %>" href="#" data-url="reviews">Reviews</a></li>\r\n    <li class="subNavItem"><a class="subNavLink <%= (key == 2) ? \'active\' : \'\' %>" href="#" data-url="menus">Menus</a></li>\r\n    <li class="subNavItem"><a class="subNavLink bookIt" href="#" data-url="book-it">Book It</a></li>\r\n</ul>'}),define("views/restaurant/topMenu",["app","marionette","underscore","text!templates/restaurant/menu.html"],function(e,t,n,r){var i=t.ItemView.extend({template:n.template(r),events:{"click .subNavLink":"goToPage"},goToPage:function(t){t.preventDefault();var n=this.$(t.target).data("url");n=this.options.urlBase+n,e.router.navigate(n,{trigger:!0})}});return i}),define("text!templates/restaurant/content.html",[],function(){return'<nav id="topMenu"></nav>\r\n<div id="restaurantContent"></div>'}),define("views/restaurant/content",["marionette","underscore","text!templates/restaurant/content.html"],function(e,t,n){var r=Backbone.Marionette.Layout.extend({template:t.template(n),regions:{topMenu:"#topMenu",restaurantContent:"#restaurantContent"}});return r}),define("text!templates/restaurant/info/info.html",[],function(){return'<div id="imgBox"></div>\r\n<div id="bookBox"></div>\r\n<div id="exclusiveEatsOffer" class="exclusiveEatsOffer"></div>\r\n<div id="mapBox" class="mainBox"></div>\r\n<div id="mainBox"></div>\r\n<div id="highlightsBox"></div>\r\n<div id="goodToKnowBox"></div>\r\n<div id="dishesBox"></div>\r\n<div id="margaritasBox"></div>\r\n<div id="fullOverviewBox"></div>'}),define("modules/Helper",["underscore","app"],function(e,t){function i(e){switch(e){case 1:return"1st";case 2:return"2nd";default:return e+"th"}}var n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=["Sunday","Monday","Tuesday ","Wednesday","Thursday","Friday","Saturday"];return t.module("Helper",function(t){function s(e){var t=String(e);return t.length===1&&(t="0"+t),t}e.extend(t,{formatDateForApi:function(e,t){var e=new Date(e);t&&e.setHours(e.getHours()-t);var n=e.getFullYear()+"-"+s(e.getMonth()+1)+"-"+s(e.getDate());return t?n+"T"+s(e.getHours())+":"+s(e.getMinutes())+":"+s(e.getSeconds())+"Z":n},newDate:function(e,t){var n=new Date(e);return n.setHours(n.getUTCHours()+t),n},formatTime:function(e,t){if(typeof t=="undefined")if(typeof e=="string")var n=e.split(":"),e=parseInt(n[0],10),t=parseInt(n[1],10);else typeof e=="object"&&(t=e.getMinutes(),e=e.getHours());var r=e<12,i=r?e:e-12;r&&i==0&&(i=12),!r&&i==0&&(i=12);var s=t<10?"0"+t:t;return{value:e+":"+s,textSimple:i+":"+s,amText:r?"a":"p",amTextFull:r?"am":"pm",valueSimpleAmTextFull:i+":"+s+(r?"am":"pm")}},formatDate:function(e){return typeof e=="string"?e:e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},parseDate:function(e,t){var n=new RegExp("([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})");if(typeof e!="string")return null;if(n.test(e)){var r=n.exec(e),i=t?t.split(":"):null;return r.length==4?new Date(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),i?parseInt(i[0],10):null,i?parseInt(i[1],10):null):new Date(e+t?" "+t:"")}},formatDateLong:function(e){return typeof e=="string"&&(e=new Date(e)),n[e.getMonth()]+" "+i(e.getDate())+", "+e.getFullYear()},formatDateShort:function(e){return typeof e=="string"&&(e=new Date(e)),r[e.getDay()]+" "+n[e.getMonth()]+" "+i(e.getDate())},formatDateShort2:function(e,t){return typeof e=="string"&&(e=new Date(e)),t&&e.setHours(e.getUTCHours()+t),r[e.getDay()].substr(0,3)+", "+n[e.getMonth()]+" "+i(e.getDate())},formatDateShort3:function(e){return typeof e=="string"&&(e=new Date(e)),r[e.getDay()].substr(0,3)+" "+n[e.getMonth()]+", "+i(e.getDate())},getDayOfWeek:function(e,t){return r[e].substr(0,t)},formatDateRelative:function(e,t){typeof e=="string"&&(e=new Date(e));var n=new Date;return n.getDate()==e.getDate()&&n.getMonth()==e.getMonth()&&n.getFullYear()==e.getFullYear()?"Today":(n.setDate(n.getDate()+1),n.getDate()==e.getDate()&&n.getMonth()==e.getMonth()&&n.getFullYear()==e.getFullYear()?"Tomorrow":t?this.formatDateShort3(e):this.formatDate(e))},equalDates:function(e,t){return typeof e=="string"&&(e=new Date(e)),typeof t=="string"&&(t=new Date(t)),e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()},getErrorMessage:function(e){if(e.responseText&&e.responseText.length>0){var t=JSON.parse(e.responseText);return t.error?typeof t.error=="string"?t.error:t.error[0]:null}return null},getTimes:function(e,t,n){var r=[],i,s=new Date;t==null&&(t=new Date,t.setHours(0),t.setMinutes(0)),n==null&&(n=new Date,n.setHours(23),n.setMinutes(45)),i=e.getDate()==s.getDate()&&e.getMonth()==s.getMonth()&&e.getFullYear()==s.getFullYear();var o=new Date;o.setHours(19),o.setMinutes(0);if(i){o=this.newDate(new Date,-5);var u=o.getMinutes();u!=0&&u!=15&&u!=30&&u!=45&&(u>0&&u<15?u=15:u>15&&u<30?u=30:u>30&&u<45?u=45:u=60,o.setMinutes(u)),t=new Date(o)}while(t<=n){var a={},f=t.getHours(),l=t.getMinutes(),c=f<12;f==o.getHours()&&l==o.getMinutes()&&(a.selected=!0),f=c?f:f-12,c&&f==0&&(f=12),!c&&f==0&&(f=12),l=l<10?"0"+l:l,a.text=f+":"+l+(c?"a":"p"),a.value=t.getHours()+":"+l,r.push(a),t.setMinutes(t.getMinutes()+15)}return r},formatPhone:function(e){return e.length>5?["(",e.substr(0,3),") ",e.substr(3,3),"-",e.substr(6)].join(""):e},stringSearch:function(e,t){var n=[{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xC7-\xE7]/g,ch:"c"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}];return $.each(n,function(){t=t.replace(this.re,this.ch),e=e.replace(this.re,this.ch)}),t.toUpperCase().indexOf(e.toUpperCase())>=0}})})}),define("text!templates/restaurant/info/book.html",[],function(){return'<div id="testTmpl">\r\n<% if(has_special_meals) { %>\r\n    <div class="chooseMeals">\r\n        <label class="chooseMealsLabel">Meal:</label>\r\n        <div class="selectForm small">\r\n            <select class="select ddlSpecialMeals">                \r\n                <% for (var i = 0; i < special_meals.length; i++) { %>\r\n                    <option value="<%= special_meals[i].special_meal_id %>"><%= special_meals[i].name %></option>\r\n                <% } %>\r\n            </select>\r\n        </div>\r\n    </div>\r\n<% } %>\r\n\r\n<h3 class="bookBoxTitle">Book a Table <%= formatDateRelative() %> for <%= party%> People at:</h3>\r\n<ul class="schedule restaurantInfoSchedule">    \r\n    <%\r\n        var slotsF = slotsFormated(specialMealId);\r\n        for (var i = 0; i < slotsF.length; i++) { %>            \r\n\r\n        <%if(!slotsF[i].isEmpty) { %>            \r\n            <li class="scheduleItem">\r\n                <a class="scheduleLink" data-time="<%= slotsF[i].value %>" href="#"><%= slotsF[i].text %><span class="scheduleText"><%= slotsF[i].amText %></span></a>\r\n            </li>\r\n\r\n        <% } else { %>            \r\n            <li class="scheduleItem">\r\n                <div class="scheduleCanceled"><%= slotsF[i].text %><span class="scheduleText"><%= slotsF[i].amText %></span></div>\r\n            </li>\r\n        <% } \r\n    } %>\r\n\r\n    <li class="scheduleItem">\r\n        <a class="scheduleLink" href="#"><span class="scheduleMoreOptions">more<br>options</span></a>\r\n    </li>\r\n</ul>\r\n</div>'}),define("views/restaurant/info/book",["marionette","underscore","modules/Helper","text!templates/restaurant/info/book.html"],function(e,t,n,r){var i=e.ItemView.extend({template:t.template(r),events:{"click .scheduleLink":"goToCompleteReservation","change .ddlSpecialMeals":"ddlSpecialMealsChanged"},ui:{ddlSpecialMeals:".ddlSpecialMeals"},serializeData:function(){var e=this.model.toJSON();return t.extend(e,{specialMealId:this.specialMealId})},templateHelpers:{formatDateRelative:function(){return n.formatDateRelative(this.selectedDate)}},initialize:function(){this.model.get("has_special_meals")&&this.model.get("special_meals_slots")&&this.model.get("special_meals_slots").length>0&&(this.specialMealId=this.model.get("special_meals_slots")[0].id)},onRender:function(){this.specialMealId=this.specialMealId||this.options.specialMealId,this.specialMealId&&this.ui.ddlSpecialMeals.val(this.specialMealId)},goToCompleteReservation:function(e){e.preventDefault();var t=this.$(e.target).data("time");this.trigger("slotChosen",t,this.specialMealId)},ddlSpecialMealsChanged:function(){var e=parseInt(this.ui.ddlSpecialMeals.val(),10);this.specialMealId=isNaN(e)?null:e,this.render()}});return i}),define("text!templates/restaurant/info/exclusiveEatsOffer.html",[],function(){return'<div class="exclusiveEatsOfferPhoto"><img src="/img/assets/img-6.jpg" alt=""></div>\r\n<div class="exclusiveEatsOfferInfo">\r\n    <h3 class="exclusiveEatsOfferTitle">Four Course Lunar New Year Dinner at Station Grill</h3>\r\n    <a href="#" class="btn tiny exclusiveEatsOfferDetails">Details</a>\r\n</div>'}),define("views/restaurant/info/exclusiveEatsOffer",["marionette","underscore","text!templates/restaurant/info/exclusiveEatsOffer.html"],function(e,t,n){var r=e.ItemView.extend({className:"exclusiveEatsOfferInner",template:t.template(n),events:{"click .exclusiveEatsOfferDetails":"goToExclusiveEats"},goToExclusiveEats:function(e){e.preventDefault();var t="restaurants/5/exclusive-eats";app.router.navigate(t,{trigger:!0})}});return r}),define("text!templates/restaurant/info/reviewItem.html",[],function(){return'<h2 class="mainBoxTitle"><%= title %></h2>\r\n<div class="mainBoxMeta">\r\n    <p>By <%= username %></p>\r\n</div>\r\n<p><%= madlibs %></p>\r\n'}),define("views/restaurant/info/review",["marionette","underscore","text!templates/restaurant/info/reviewItem.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n),ui:{rateit:".rateit"},onRender:function(){this.ui.rateit.rateit()}});return r}),define("text!templates/restaurant/info/reviews.html",[],function(){return'<div id="fullOverview"></div>\r\n<div class="mainBoxButton">\r\n    <a href="#" class="btn small btnReadMore">Read More</a>\r\n</div>'}),define("views/restaurant/info/fullOverview",["marionette","underscore","views/restaurant/info/review","text!templates/restaurant/info/reviews.html"],function(e,t,n,r){var i=e.CompositeView.extend({tagName:"article",className:"mainBox text",itemViewContainer:"#fullOverview",itemView:n,template:t.template(r),events:{"click .btnReadMore":"btnReadMoreClick"},ui:{btnReadMore:".btnReadMore",fullOverview:"#fullOverview"},initialize:function(){this.expanded=!1,this.fullCollection=this.collection.clone(),this.shortCollection=this.collection.clone(),this.shortCollection.reset([this.fullCollection.at(0)]),this.collection=this.shortCollection},onRender:function(){this.fullCollection.length<2&&this.ui.btnReadMore.hide(),this.renderReadMore()},renderReadMore:function(){this.expanded?this.ui.btnReadMore.text("Read Less"):this.ui.btnReadMore.text("Read More")},btnReadMoreClick:function(e){e.preventDefault(),this.expanded=!this.expanded,this.expanded?this.collection=this.fullCollection:this.collection=this.shortCollection,this.render()}});return i}),define("text!templates/restaurant/info/images.html",[],function(){return'<div class="carouselHolder">\r\n    <ul class="carousel">\r\n        <% for(var i = 0; i < images.length; i++) {%>                \r\n            <li class="carouselItem"><img src="<%= images[i].photo_mobile_app %>" alt=""></li>            \r\n        <% } %>\r\n    </ul>\r\n    <a class="carouselPrev" href="#">Previous</a>\r\n    <a class="carouselNext" href="#">Next</a>\r\n</div>'}),define("views/restaurant/info/images",["marionette","underscore","text!templates/restaurant/info/images.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n),className:function(){return this.model.get("images").length>0?"mainBox img":"emptyMainBox"},events:{"click .carouselPrev":"carouselPrevClick","click .carouselNext":"carouselNextClick"},ui:{carousel:".carousel",carouselPrev:".carouselPrev",carouselNext:".carouselNext"},onRender:function(){this.model.get("images").length<2&&(this.ui.carouselPrev.hide(),this.ui.carouselNext.hide())},carouselPrevClick:function(e){e.preventDefault();var t=this.ui.carousel.find("li:last");t.insertBefore(this.ui.carousel.find("li:first"))},carouselNextClick:function(e){e.preventDefault();var t=this.ui.carousel.find("li:first");t.insertAfter(this.ui.carousel.find("li:last"))}});return r}),define("text!templates/restaurant/info/main.html",[],function(){return'<div class="mainBox">\r\n    <div class="restaurantInfoMain">\r\n        <div class="column2 restaurantInfoMainTop">\r\n            <div class="column">\r\n                <div class="restaurantInfoPrice"><span class="restaurantInfoPriceActive"><%= priceSymbols() %></span><%= priceSymbolsReverse() %></div>\r\n                <div class="rateit rating" data-rateit-value="<%= rating %>" data-rateit-ispreset="true" data-rateit-readonly="true" data-rateit-starwidth="14" data-rateit-starheight="14"></div>\r\n            </div>\r\n            <div class="column">\r\n                <a href="#" class="btn small grey"><%= formatPhone()%></a>\r\n            </div>\r\n        </div>\r\n        <div class="column2 restaurantInfoMainBody">\r\n            <div class="column">\r\n                <dl class="restaurantInfoList">\r\n                    <% if (open_for && open_for.length > 0) { %>\r\n                        <dt>Open For</dt>\r\n                        <dd><%= open_for %></dd>\r\n                    <% } %>\r\n\r\n                    <% if (restaurant_hours.length > 0) { \r\n                        var openHours  = getOpenHours();\r\n                        for(var i = 0; i < openHours.length; i++) { %>\r\n                            <dt><%= openHours[i].days %></dt>\r\n                            <% for (var k = 0; k < openHours[i].hours.length; k++) { %>\r\n                            <dd><%= openHours[i].hours[k]%></dd>\r\n                    <% }}} %>\r\n                </dl>\r\n            </div>\r\n            <div class="column">\r\n                <dl class="restaurantInfoList">\r\n                    <% if (cuisine_types.length > 0) { %>\r\n                        <dt>Cuisine</dt>\r\n                        <dd><%= cuisinesText(\', \')%></dd>\r\n                    <% } %>\r\n                    <% if (neighborhood != null) { %>\r\n                        <dt>Neighborhood</dt>\r\n                        <dd><%= neighborhood.name %></dd>\r\n                    <% } %>\r\n                    <% if (payment_options.length > 0) { %>\r\n                        <dt>Accepted Payment</dt>\r\n                        <dd><%= paymentsText() %></dd>\r\n                    <% } %>\r\n                </dl>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}),define("views/restaurant/info/main",["marionette","underscore","modules/helper","text!templates/restaurant/info/main.html"],function(e,t,n,r){var i=e.ItemView.extend({template:t.template(r),ui:{rateit:".rateit"},templateHelpers:{getOpenHours:function(){var e=[],r=t.groupBy(this.restaurant_open_hours,"day_of_week"),i=null;for(var s in r)r.hasOwnProperty(s)&&(i&&i.items.length==r[s].length&&t.pluck(i.items,"end_time").join(";")==t.pluck(r[s],"end_time").join(";")&&t.pluck(i.items,"start_time").join(";")==t.pluck(r[s],"start_time").join(";")?i.days_of_week.push(r[s][0].day_of_week):(i={days_of_week:[r[s][0].day_of_week],items:r[s]},e.push(i)));return t.map(e,function(e){return{days:n.getDayOfWeek(e.days_of_week[0],3)+(e.days_of_week.length>1?"-"+n.getDayOfWeek(t.max(e.days_of_week),3):""),hours:t.map(e.items,function(e){return n.formatTime(e.start_time).valueSimpleAmTextFull+" - "+n.formatTime(e.end_time).valueSimpleAmTextFull})}})}},onRender:function(){this.ui.rateit.rateit()}});return i}),define("text!templates/restaurant/info/textBlock.html",[],function(){return'<h2 class="mainBoxTitle"><%= key %></h2>\r\n<% if (typeof value == \'string\') { %>\r\n    <p><%= value %></p>\r\n<% } else { %>\r\n    <ul class="mainBoxTextList indent">\r\n    <% for (var i = 0; i < value.length; i++) { %>\r\n        <li class="mainBoxTextListItem"><%= value[i]%></li>\r\n    <% } %>\r\n    </ul>\r\n<% } %> '}),define("views/restaurant/info/textBlock",["marionette","underscore","text!templates/restaurant/info/textBlock.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n),tagName:"article",className:"mainBox text"});return r}),define("text!templates/restaurant/info/map.html",[],function(){return'<p class="mainBoxContactMap"><%= address.street1 %> <span class="mainBoxContactMapState"><%= address.city %></span></p>\r\n<div class="mapHolder">\r\n    <img src="<%= geoImageUrl() %>" alt="">\r\n</div>'}),define("views/restaurant/info/map",["marionette","underscore","text!templates/restaurant/info/map.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n)});return r}),define("views/restaurant/info/info",["marionette","underscore","text!templates/restaurant/info/info.html","models/keyValue","views/restaurant/info/book","views/restaurant/info/exclusiveEatsOffer","views/restaurant/info/fullOverview","views/restaurant/info/images","views/restaurant/info/main","views/restaurant/info/textBlock","views/restaurant/info/map"],function(e,t,n,r,i,s,o,u,a,f,l){var c=Backbone.Marionette.Layout.extend({template:t.template(n),regions:{imgBox:"#imgBox",bookBox:"#bookBox",exclusiveEatsOffer:"#exclusiveEatsOffer",mapBox:"#mapBox",mainBox:"#mainBox",highlightsBox:"#highlightsBox",goodToKnowBox:"#goodToKnowBox",dishesBox:"#dishesBox",margaritasBox:"#margaritasBox",fullOverviewBox:"#fullOverviewBox"},onRender:function(){var e=this.options.id,t=this.options.party,n=this.options.date,s=this.options.time,c=this.options.fromRestaurants,h=this.model,p=new i({model:h}),d=new u({model:h}),v=new a({model:h}),m=new l({model:h}),g=h.highlights();g.length>0?highlightsView=new f({model:new r({key:"Highlights",value:g})}):highlightsView=null;var y=h.goodToKnow();y.length>0?goodToKnowView=new f({model:new r({key:"Good to Know",value:y})}):goodToKnowView=null;var b=h.recommendedDishes();b.length>0?recommendedDishesView=new f({model:new r({key:"Recommended Dishes",value:b})}):recommendedDishesView=null;var w=h.recommendedMargaritas();w.length>0?recommendedMargaritasView=new f({model:new r({key:"Recommended Margaritas",value:w})}):recommendedMargaritasView=null;var E=h.get("reviews");E.length>0?fullOverview=new o({collection:h.getReviewCollection()}):fullOverview=null,this.imgBox.show(d),this.bookBox.show(p),this.mainBox.show(v),this.mapBox.show(m),highlightsView!=null?this.highlightsBox.show(highlightsView):this.highlightsBox.close(),goodToKnowView!=null?this.goodToKnowBox.show(goodToKnowView):this.goodToKnowBox.close(),recommendedMargaritasView!=null?this.margaritasBox.show(recommendedMargaritasView):this.margaritasBox.close(),recommendedDishesView!=null?this.dishesBox.show(recommendedDishesView):this.dishesBox.close(),fullOverview!=null?this.fullOverviewBox.show(fullOverview):this.fullOverviewBox.close(),p.on("slotChosen",function(r,i){var o;r&&r.length>0?(o=["restaurants/",e,"/party/",t,"/date/",n,"/time/",s,"/",c?"book-it":"book-it-ext","/complete-reservation/",r].join(""),i&&(o+="/meal/"+i)):o=c===!0?"restaurants/"+e+"/book-it":"restaurants/"+e+"/party/"+t+"/date/"+n+"/time/"+s+"/book-it",app.router.navigate(o,{trigger:!0})})}});return c}),define("text!templates/restaurant/reviews/reviewItem.html",[],function(){return'<h3 class="reviewTitle"><%= title %></h3>\r\n<div class="rateit rating" data-rateit-value="<%= overall_rating %>" data-rateit-ispreset="true" data-rateit-readonly="true" data-rateit-starwidth="14" data-rateit-starheight="14"></div>\r\n<p class="reviewMeta">By <%= username %>  -  <%= date() %></p>\r\n<p><%= madlibs %> \r\n<a href="#" class="btnShowMore">Read More</a></p>'}),define("views/restaurant/reviews/reviewItem",["marionette","underscore","text!templates/restaurant/reviews/reviewItem.html"],function(e,t,n){var r=e.ItemView.extend({tagName:"article",className:"review",template:t.template(n),ui:{btnShowMore:".btnShowMore",rateit:".rateit"},events:{"click .btnShowMore":"showMoreClick"},initialize:function(){this.fullContent=this.model.get("madlibs"),this.shortContent=this.model.getShortContent(),this.model.set("madlibs",this.shortContent)},onRender:function(){this.fullContent.length<this.model.maxLength&&this.ui.btnShowMore.hide(),this.ui.rateit.rateit()},showMoreClick:function(e){e.preventDefault(),this.model.set("madlibs",this.fullContent),this.render(),this.ui.btnShowMore.hide()}});return r}),define("text!templates/restaurant/reviews/reviews.html",[],function(){return'<!-- Restaurant Reviews -->\r\n<h2 class="restaurantReviewsTitle">Reviews</h2>\r\n<div class="mainBox"></div>'}),define("views/restaurant/reviews/reviews",["marionette","underscore","views/restaurant/reviews/reviewItem","views/shared/noResults","text!templates/restaurant/reviews/reviews.html"],function(e,t,n,r,i){var s=e.CompositeView.extend({template:t.template(i),itemViewContainer:".mainBox",itemView:n,emptyView:r});return s}),define("text!templates/restaurant/menus/menu.html",[],function(){return"<!-- Restaurant Menus -->\r\n<script id=\"-locu-widget\" src='<%= value %>'></script>"}),define("views/restaurant/menus/menus",["marionette","underscore","text!templates/restaurant/menus/menu.html","views/shared/noResults"],function(e,t,n,r){var i=e.ItemView.extend({template:t.template(n),className:"mainBox"});return i}),define("text!templates/restaurant/bookIt/nextDay.html",[],function(){return'<a href="#" class="btn pale"><%= value %></a>'}),define("views/restaurant/bookIt/nextDay",["app","marionette","underscore","text!templates/restaurant/bookIt/nextDay.html"],function(e,t,n,r){var i=t.ItemView.extend({template:n.template(r),className:"btnHolder",events:{"click .btn":"btnClick"},btnClick:function(e){e.preventDefault(),this.trigger("dateSelected",this.model.get("key"))}});return i}),define("text!templates/restaurant/bookIt/nextDays.html",[],function(){return'<h2 class="chooseTimeHeaderButtons">Here are the next 3 days with availability:</h2>'}),define("views/restaurant/bookIt/nextDays",["app","marionette","underscore","views/restaurant/bookIt/nextDay","text!templates/restaurant/bookIt/nextDays.html"],function(e,t,n,r,i){var s=t.CompositeView.extend({template:n.template(i),itemView:r,itemViewEventPrefix:"newDayView"});return s}),define("text!templates/restaurant/bookIt/scheduleItem.html",[],function(){return'<% if(selected === true) { %>\r\n    <a class="scheduleLink" href="#"><%= value.textSimple %><span class="scheduleText"><%= value.amText %></span></a>\r\n<% } else { %>\r\n    <div class="scheduleCanceled"><%= value.textSimple %><span class="scheduleText"><%= value.amText %></span></div>\r\n<% } %>'}),define("views/restaurant/bookIt/scheduleItem",["app","marionette","underscore","text!templates/restaurant/bookIt/scheduleItem.html"],function(e,t,n,r){var i=t.ItemView.extend({tagName:"li",className:"scheduleItem",template:n.template(r),events:{"click .scheduleLink":"goToCompleteReservation"},goToCompleteReservation:function(t){t.preventDefault();var n=this.options.completeUrlTemplate.replace("##time##",this.model.get("key"));e.router.navigate(n,{trigger:!0})}});return i}),define("views/restaurant/bookIt/scheduleItems",["app","marionette","underscore","views/restaurant/bookIt/scheduleItem"],function(e,t,n,r){var i=t.CollectionView.extend({tagName:"ul",itemView:r,itemViewOptions:function(e,t){return this.options}});return i}),define("text!templates/restaurant/bookIt/bookIt.html",[],function(){return'<!-- Choose Time -->\r\n<div class="chooseTimeSelect column2"></div>\r\n<h2 class="chooseTimeHeader">Сhoose time</h2>\r\n<ul class="schedule chooseTimeSchedule"></ul>\r\n<div id="nextDays"></div>\r\n'}),define("views/restaurant/bookIt/bookIt",["marionette","underscore","text!templates/restaurant/bookIt/bookIt.html"],function(e,t,n){var r=Backbone.Marionette.Layout.extend({template:t.template(n),regions:{chooseTime:".chooseTimeSelect",schedule:".chooseTimeSchedule",nextDays:"#nextDays"}});return r}),define("controllers/restaurant",["underscore","app","modules/helper","BaseController","models/keyValue","models/restaurant","models/topBar","models/searchBar","views/shared/topBar","collections/restaurants","collections/dictionary","views/searchResults/searchResults","views/searchResults/searchBar","views/searchResults/restaurantsPages","views/shared/calendar","views/searchResults/restaurant","views/searchResults/restaurants","views/restaurant/topMenu","views/restaurant/content","views/restaurant/info/info","views/restaurant/reviews/reviews","views/restaurant/menus/menus","views/searchResults/searchBar","views/restaurant/bookIt/nextDays","views/restaurant/bookIt/scheduleItems","views/shared/calendar","views/restaurant/bookIt/bookIt"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,d,N){var C=r.extend({info:function(e,t,n,r,i,s){var o=this;this.buildRestaurantBaseInfo(e,t,n,r,i,0,s,function(s){var u=new b({model:s,id:e,party:t,date:n,time:r,fromRestaurants:i});o.contentLayout.currentView.restaurantContent.show(u)})},reviews:function(e,t,n,r,i){var s=this;this.buildRestaurantBaseInfo(e,t,n,r,i,1,null,function(e){var t=new w({collection:e.getReviewCollection()});s.contentLayout.currentView.restaurantContent.show(t)})},menus:function(e,t,n,r,s){var o=this;this.buildRestaurantBaseInfo(e,t,n,r,s,2,null,function(e){var t=new E({model:new i({value:e.get("locu_url")})});o.contentLayout.currentView.restaurantContent.show(t)})},bookIt:function(e,t,r,i,s,o,u,a,f){var l=this;this.buildRestaurantBaseInfo(e,a||t,f||r,i,u,3,null,function(c){s==null&&c.get("has_special_meals")&&c.get("special_meals_slots")&&c.get("special_meals_slots").length>0&&(s=c.get("special_meals_slots")[0].id);var h=new S({model:l.getSearchModel(a||t,f||r,c.get("special_meals")),specialMealId:s}),p=new x({collection:l.getNextDays(f||r)}),v=new T({collection:c.getFullSlots(s,f||r),completeUrlTemplate:["restaurants/",e,"/party/",a||t,"/date/",f||r,"/time/",i,"/",u?"book-it":"book-it-ext","/complete-reservation/##time##",o?"/modify/"+o:"",s?"/meal/"+s:""].join("")});l.contentLayout.currentView.chooseTime.show(h),l.contentLayout.currentView.schedule.show(v),l.contentLayout.currentView.nextDays.show(p);var m=new d({date:f||r}),g=l.getCalendarTopBarView();h.on("datePickerClicked",function(){g.on("btnLeftClick",function(){l.bookIt(e,t,r,i,s,o,u,h.model.get("party"),f?n.formatDate(f):null)}),l.topBarLayout.show(g),l.contentLayout.show(m),m.on("dateSelected",function(a){l.bookIt(e,t,r,i,s,o,u,h.model.get("party"),n.formatDate(a))})}).on("partySizeChanged",function(n){l.bookIt(e,t,r,i,s,o,u,n,f)}).on("specialMealsChanged",function(n){l.bookIt(e,t,r,i,n,o,u,a,f)}),p.on("newDayView:dateSelected",function(a,f){l.bookIt(e,t,r,i,s,o,u,h.model.get("party"),n.formatDate(f))})})},buildRestaurantBaseInfo:function(e,r,s,o,u,a,f,l){var c=this,h,p;if(!(p=this.checkCurrentCity()))return!0;h=n.parseDate(s,o),t.execute("GetRestaurant",e,h,r,o,function(t,n){if(t)return c.errorPartial();var h;a==3?h=u===!0?"restaurants/"+e+"/info":"restaurants/"+e+"/party/"+r+"/date/"+s+"/time/"+o+"/info":h=u===!0?f?f:"restaurants":"search-results/party/"+r+"/date/"+s+"/time/"+o;var p=c.getTopBarView({leftText:a==3?"Cancel":"Back",title:n.get("name"),leftUrl:h});if(a!=3)var d=new g({model:new i({key:a}),urlBase:u===!0?"restaurants/"+e+"/":"restaurants/"+e+"/party/"+r+"/date/"+s+"/time/"+o+"/"});var v=a==3?new N:new y;c.topBarLayout.show(p),c.contentLayout.show(v),d&&v.topMenu.show(d),l(n)})},getSearchModel:function(e,t,r){return typeof t=="string"&&(t=n.parseDate(t)),new u({showTimingBar:!0,showTimes:!1,party:e,date:t,special_meals:r})},getNextDays:function(t){var r=n.parseDate(t),i=new Date(r),s=new Date(r);return r.setDate(r.getDate()+1),i.setDate(i.getDate()+2),s.setDate(s.getDate()+3),new l(e.map([r,i,s],function(e){return{key:e,value:n.formatDateShort(e)}}))},getTopBarView:function(t){var n=new o(e.extend({leftText:"Back",leftUrl:"back",title:""},t));return new a({model:n})},getCalendarTopBarView:function(){var e=new o({leftText:"Cancel",leftUrl:"",title:"Date"});return new a({model:e,leftClickEvent:"btnLeftClick"})}});return C}),define("text!templates/account/reservations/upcoming.html",[],function(){return'<!-- Reservation -->\r\n<div class="reservationHeader">\r\n    <p>Confirmation Number: <%= confirmation_code %></p>\r\n</div>\r\n<div class="roundedBox">\r\n    <div class="roundedBoxRow">\r\n        <a href="#" class="reservationData">\r\n            <h3 class="reservationDataTitle confirmed"><%= restaurant_name %></h3>\r\n            <p><%= getDate() %></p>\r\n            <p><span class="reservationGreyText">for</span> <%= party_size %> people <span class="reservationGreyText">at</span> <%= getTime() %></p>\r\n            <% if (typeof special_meal_name != \'undefined\') { %>\r\n            <p><span class="reservationGreyText">for</span> <%= special_meal_name %></p>\r\n            <% } %>\r\n        </a>\r\n    </div>\r\n    <div class="roundedBoxRow">\r\n        <div class="reservationData">\r\n            <h4 class="reservationSubTitle">Your contact info</h4>\r\n            <p><%= getFullName() %></p>\r\n            <p class="reservationGreyText"><%= formatEmail() %></p>\r\n            <p class="reservationGreyText"><%= formatPhone() %></p>\r\n        </div>\r\n    </div>\r\n    <div class="roundedBoxRow">\r\n        <div class="reservationData">\r\n            <h4 class="reservationSubTitle">Special requests</h4>\r\n            <p><%= special_request %></p>\r\n        </div>\r\n    </div>\r\n    <div class="roundedBoxRow">\r\n        <div class="reservationButtons">\r\n            <div class="reservationButtonHolder">\r\n                <a href="#" class="btnSoft red btnCancel">Cancel Reservation</a>\r\n            </div>\r\n            <div class="reservationButtonHolder">\r\n                <a href="#" class="btnSoft btnModify">Modify Reservation</a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<% if (!isConfirmedView) { %>\r\n<div class="roundedBox">\r\n    <div class="roundedBoxRow">\r\n        <div class="reminder reminderBookIt">\r\n            <p class="reminderLabel">SMS Reminder</p>\r\n            <label class="switcher reminderSwitcher">\r\n                <input type="checkbox" data-on="on" data-off="off" checked  class="cbSmsReminder"/>\r\n            </label>\r\n        </div>\r\n    </div>\r\n    <div class="roundedBoxRow">\r\n        <div class="reminder reminderBookIt">\r\n            <p class="reminderLabel">Email Reminder</p>\r\n            <label class="switcher reminderSwitcher">\r\n                <input type="checkbox" data-on="on" data-off="off" class="cbEmailReminder" />\r\n            </label>\r\n        </div>\r\n    </div>\r\n</div>\r\n<!--<a href="#" class="btn pale btnShare">Share Reservation</a>-->\r\n<% } %>\r\n<% if(points > 0) { %>\r\n    <div class="emptyBox">\r\n        <div class="reservationPoints">\r\n            <div class="reservationPointsNumber"><%= points %></div>\r\n            <div class="reservationPointsHolder">Points Rewarded for <br />this Reservation</div>\r\n        </div>\r\n    </div>\r\n<% } %>'}),define("text!templates/account/reservations/past.html",[],function(){return'<!-- Reservation -->\r\n<div class="reservationHeader">\r\n    <p>Confirmation Number: <%= confirmation_code %></p>\r\n</div>\r\n<div class="roundedBox">\r\n    <div class="roundedBoxRow">\r\n        <a href="#" class="reservationData">\r\n            <h3 class="reservationDataTitle"><%= restaurant_name %></h3>\r\n            <p><%= getDate() %></p>\r\n            <p><span class="reservationGreyText">for</span> <%= party_size %> people <span class="reservationGreyText">at</span> <%= getTime() %></p>\r\n        </a>\r\n    </div>\r\n    <div class="roundedBoxRow">\r\n        <div class="reservationData">\r\n            <h4 class="reservationSubTitle">Your contact info</h4>\r\n            <p><%= getFullName() %></p>\r\n            <p class="reservationGreyText"><%= formatEmail() %></p>\r\n            <p class="reservationGreyText"><%= formatPhone() %></p>\r\n        </div>\r\n    </div>\r\n    <div class="roundedBoxRow">\r\n        <div class="reservationData">\r\n            <h4 class="reservationSubTitle">Special requests</h4>\r\n            <p><%= special_request %></p>\r\n        </div>\r\n    </div>\r\n</div>'}),define("text!templates/account/reservations/canceled.html",[],function(){return'<!-- Reservation -->\r\n<div class="reservationHeader">\r\n    <p>Confirmation Number: <%= confirmation_code %></p>\r\n</div>\r\n<div class="roundedBox">\r\n    <div class="roundedBoxRow">\r\n        <a href="#" class="reservationData">\r\n            <h3 class="reservationDataTitle"><%= restaurant_name %></h3>\r\n            <p><%= getDate() %></p>\r\n            <p><span class="reservationGreyText">for</span> <%= party_size %> people <span class="reservationGreyText">at</span> <%= getTime() %></p>\r\n        </a>\r\n    </div>\r\n    <div class="roundedBoxRow">\r\n        <div class="reservationData">\r\n            <h4 class="reservationSubTitle">Your contact info</h4>\r\n            <p><%= getFullName() %></p>\r\n            <p class="reservationGreyText"><%= formatEmail() %></p>\r\n            <p class="reservationGreyText"><%= formatPhone() %></p>\r\n        </div>\r\n    </div>\r\n    <div class="roundedBoxRow">\r\n        <div class="reservationData">\r\n            <h4 class="reservationSubTitle">Special requests</h4>\r\n            <p><%= special_request %></p>\r\n        </div>\r\n    </div>\r\n</div>'}),define("views/account/reservations/details",["marionette","underscore","modules/helper","text!templates/account/reservations/upcoming.html","text!templates/account/reservations/past.html","text!templates/account/reservations/canceled.html"],function(e,t,n,r,i,s){var o=e.ItemView.extend({getTemplate:function(){if(this.options.isConfirmedView)return t.template(r);if(this.model.isUpcoming())return t.template(r);if(this.model.isPast())return t.template(i);if(this.model.isCanceled())return t.template(s)},events:{"click .btnCancel":"btnCancelClick","click .btnModify":"btnModifyClick","click .btnShare":"btnShareClick","click .cbSmsReminder":"reminderChanged","click .cbEmailReminder":"reminderChanged","click a.reservationData":"reservationDataClicked"},ui:{cbSmsReminder:".cbSmsReminder",cbEmailReminder:".cbEmailReminder"},onRender:function(){if(this.options.isConfirmedView||this.model.isUpcoming())this.ui.cbSmsReminder.attr("checked",this.model.get("sms_reminder")),this.ui.cbEmailReminder.attr("checked",this.model.get("email_reminder"))},templateHelpers:{getDate:function(){return n.formatDateShort2(this.reserved_for,this.current_time_offset)},getTime:function(){var e=n.formatTime(n.newDate(this.reserved_for,this.current_time_offset));return e.textSimple+e.amTextFull},getFullName:function(){return this.first_name+" "+this.last_name},formatPhone:function(){return n.formatPhone(this.phone_number)},formatEmail:function(){return this.email}},serializeData:function(){var e=this.model.toJSON(),n={isConfirmedView:this.options.isConfirmedView,points:this.options.points};return t.extend(e,n)},btnCancelClick:function(e){e.preventDefault();var t=this,r="Are you sure you want to cancel this CityEats reservation?",i="We're sorry, but the restaurant does not allow online cancellations this close to the reservation time. Please call them at "+n.formatPhone(this.options.phoneNumber)+". Thank you.",s=function(){confirm(r)&&t.trigger("btnCancelClicked")};if(this.options.minTimeToCancel){var o=new Date(this.model.get("reserved_for"));o.setMinutes(o.getMinutes()-this.options.minTimeToCancel),o<new Date?alert(i):s()}else s()},btnModifyClick:function(e){e.preventDefault();var t,r,i,s,o,u;t=new Date(this.model.get("reserved_for")),o=this.model.get("party_size"),s=this.model.get("confirmation_code"),u=this.model.get("order_id"),r=n.formatTime(t),i=n.formatDate(t),this.trigger("btnModifyClicked",s,u,o,i,r.value)},reminderChanged:function(e){this.trigger("reminderChanged",this.ui.cbSmsReminder.is(":checked"),this.ui.cbEmailReminder.is(":checked"))},reservationDataClicked:function(e){e.preventDefault();var t=Backbone.history.fragment;app.router.navigate("restaurants/"+this.model.get("restaurant_id")+"/info?"+encodeURIComponent(t),{trigger:!0})}});return o}),define("text!templates/account/reservations/item.html",[],function(){return' <a href="#" class="accountReservationLink">\r\n    <h3 class="accountReservationSubTitle"><%= restaurant_name %></h3>\r\n    <p><%= title() %></p>\r\n</a>'}),define("views/account/reservations/item",["marionette","underscore","text!templates/account/reservations/item.html"],function(e,t,n){var r=e.ItemView.extend({template:t.template(n),tagName:"li",className:"accountReservationItem",events:{"click .accountReservationLink":"goToReservation"},goToReservation:function(e){e.preventDefault();var t="profile/reservations/"+this.model.get("confirmation_code");app.router.navigate(t,{trigger:!0})}});return r}),define("text!templates/account/reservations/all.html",[],function(){return'<!-- Account -->\r\n<section class="account">\r\n    <ul class="tabs">\r\n        <li class="tabsItem"><a class="tabsLink btnAbout" href="#">About</a></li>\r\n        <li class="tabsItem"><a class="tabsLink active" href="#">Reservations</a></li>\r\n    </ul>\r\n    <div class="tabsContent">\r\n        <div class="tabsContentInner">\r\n            <div class="accountReservation upcoming">\r\n                <h2 class="accountReservationTitle">Upcoming Reservations</h2>                \r\n                <ul class="accountReservationList upcomingReservations"></ul>\r\n            </div>\r\n            <div class="accountReservation">\r\n                <h2 class="accountReservationTitle">Past Reservations</h2>\r\n                <ul class="accountReservationList pastReservations"></ul>\r\n            </div>\r\n            <div class="accountReservation">\r\n                <h2 class="accountReservationTitle">Canceled Reservations</h2>\r\n                <ul class="accountReservationList canceledReservations"></ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</section>'}),define("views/account/reservations/all",["marionette","underscore","views/account/reservations/item","text!templates/account/reservations/all.html"],function(e,t,n,r){var n=e.CompositeView.extend({template:t.template(r),itemView:n,events:{"click .btnAbout":"btnAboutClick","click .tabsLink.active":"goToVoid"},appendHtml:function(e,t,n){var r;t.model.isUpcoming()?r=e.$(".upcomingReservations"):t.model.isPast()?r=e.$(".pastReservations"):r=e.$(".canceledReservations"),r.append(t.el)},btnAboutClick:function(e){e.preventDefault(),app.router.navigate("profile",{trigger:!0})},goToVoid:function(e){e.preventDefault()}});return n}),define("controllers/reservations",["underscore","app","modules/helper","BaseController","models/topBar","views/shared/topBar","views/restaurant/bookIt/complete/complete","views/restaurant/bookIt/complete/restaurantInfo","views/restaurant/bookIt/complete/userInfo","views/restaurant/bookIt/complete/additionalInfo","views/account/reservations/details","views/account/reservations/all","views/account/reservations/details"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=r.extend({completeReservation:function(e,r,i,s,l,c,h,p){var v=this,m=n.parseDate(i,c),g,y;y="restaurants/"+e+"/party/"+r+"/date/"+i+"/time/"+c+"/book-it";switch(l){case"search":g="search-results/party/"+r+"/date/"+i+"/time/"+c;break;case"info":g="restaurants/"+e+"/info";break;case"info-ext":g="restaurants/"+e+"/party/"+r+"/date/"+i+"/time/"+c+"/info";break;case"book-it-ext":g=y;break;case"book-it":g="restaurants/"+e+"/book-it"}var b=d({leftUrl:g});t.execute("GetRestaurant",e,m,r,c,function(i,s){if(i)return v.errorPartial();t.execute("GetCurrentUser",function(i,l){if(h&&s.get("special_meals_slots").length==0||h==null&&s.get("slots").length==0)return t.router.navigate(g,{trigger:!0});var c=new o,d=new u({model:s,bookItUrl:y,specialMealId:h}),w=function(){v.topBarLayout.show(b),v.contentLayout.show(c),c.restaurantInfo.show(d),c.userInfo.show(c.userInfoView),c.additionalInfo.show(c.additionalInfoView),c.on("completeClicked",function(){if(c.userInfoView.validate()){v.toggleLoading(!0);var i={user:c.userInfoView.getModel(),additionalInfo:c.additionalInfoView.getModel(),party:r,slotDate:m,timeOffset:s.get("current_time_offset"),restaurantId:e,specialMealId:h?parseInt(h,10):null};t.execute(p?"UpdateReservation":"ConfirmReservation",p?p:e,i,function(r,i){if(r==null)t.router.navigate("restaurants/"+e+"/confirmed-reservation/"+i.get("confirmation_code"),{trigger:!0});else{var s=n.getErrorMessage(r);s?v.errorPartial(s):v.errorPartial()}})}})};p?t.execute("GetReservation",p,function(e,n){if(e)return v.errorPartial(e);if(n==null)return t.router.navigate("profile/reservations",{trigger:!0});c.userInfoView=new a({model:l,reservation:n}),c.additionalInfoView=new f({reservation:n}),w()}):(c.userInfoView=new a({model:l}),c.additionalInfoView=new f,w())})})},reservationConfirmed:function(e,n){var r=this,i=0,s;t.execute("GetCurrentUser",function(o,u){topBarView=v();var a=function(o){t.topBar.show(topBarView),t.content.show(s),r.toggleLoading(),s.on("btnCancelClicked",function(){t.execute("CancelReservation",o,function(e){if(e)return r.errorPartial();t.router.navigate("profile/reservations",{trigger:!0})})}),s.on("btnModifyClicked",function(n,r,i,s,o){t.router.navigate("restaurants/"+e+"/party/"+i+"/date/"+s+"/time/"+o+"/book-it/modify/"+n,{trigger:!0})}),s.on("reminderChanged",function(e,s){i++,r.toggleLoading(!0),t.execute("UpdateReservationReminders",n,e,s,function(e,t){if(e)return i=0,r.toggleLoading(),r.errorPartial(e);i--,i<=0&&r.toggleLoading()})})};u==null?t.execute("GetReservation",n,function(e,n){if(e)return r.errorPartial(e);if(n==null)return t.router.navigate("profile/reservations",{trigger:!0});s=new l({model:n,isConfirmedView:!0}),a(n.get("order_id"))}):t.execute("GetReservation",n,function(e,n){if(e)return r.errorPartial(e);if(n==null)return t.router.navigate("profile/reservations",{trigger:!0});s=new l({model:n,user:u,isConfirmedView:!0,points:200}),a(n.get("order_id"))})})},reservations:function(){var e=this;t.execute("GetReservations",function(t,n){if(t)return e.errorPartial(t);e.toggleLoading();if(n.error)e.errorPartial(n.error);else{topBarView=m();var r=new c({collection:n});e.topBarLayout.show(topBarView),e.contentLayout.show(r)}})},reservation:function(e){var n=this,r=0;t.execute("GetCurrentUser",function(i,s){if(s==null)return t.router.navigate("login",{trigger:!0});t.execute("GetReservation",e,function(i,o){if(i)return n.errorPartial();if(o==null)return t.router.navigate("profile/reservations",{trigger:!0});t.execute("GetRestaurant",o.get("restaurant_id"),function(i,u){if(i)return n.errorPartial();var a;o.isUpcoming()?a="Upcoming Reservation":o.isPast()?a="Past Reservation":o.isCanceled()&&(a="Canceled Reservation");var f=new h({model:o,user:s,phoneNumber:u.get("phone_number"),minTimeToCancel:u.get("min_time_to_cancel_reservation")}),l=g({title:a});n.topBarLayout.show(l),n.contentLayout.show(f),f.on("btnCancelClicked",function(){t.execute("CancelReservation",o.get("order_id"),function(t){if(t)return n.errorPartial();n.reservation(e)})}),f.on("btnModifyClicked",function(e,n,r,i,s){t.router.navigate("restaurants/"+u.get("id")+"/party/"+r+"/date/"+i+"/time/"+s+"/book-it/modify/"+e,{trigger:!0})}),f.on("reminderChanged",function(i,s){r++,n.toggleLoading(!0),t.execute("UpdateReservationReminders",e,i,s,function(e,t){if(e)return r=0,n.toggleLoading(),n.errorPartial(e);r--,r<=0&&n.toggleLoading()})})})})})}}),d=function(t){var n=new i(e.extend({leftText:"Back",title:"Book It"},t));return new s({model:n})},v=function(t){var n=new i(e.extend({rightText:"Done",rightUrl:"back",rightCss:"blue",title:"Reservation Confirmed"},t));return new s({model:n})},m=function(){var e=new i({leftText:"Home",leftUrl:"back",title:"Account"});return new s({model:e})},g=function(t){var n=new i(e.extend({leftText:"Back",leftUrl:"profile/reservations"},t));return new s({model:n})};return p}),define("router",["app","marionette","views/shared/footer","views/shared/error","views/shared/404","views/shared/loading","modules/helper","modules/forgotPassword","modules/contactUs","modules/restaurant/exclusiveEats","modules/restaurant/completeReservation","modules/profile","modules/messages","controllers/restaurants","controllers/metros","controllers/account","controllers/findTable","controllers/filter","controllers/restaurant","controllers/reservations"],function(e,t,n,r,i,s,o){var u="488317004581923",a="https://qa-beta.cityeats.com/api/v2/facebook_auth",f=t.AppRouter.extend({routes:{"":"index","index.html":"index","change-city":"changeCity",back:"back",login:"login","login?:url":"loginReturnUrl",signup:"signUp","find-table":"findTable","search-results/party/:num/date/:num/time/:num":"searchResults",restaurants:"restaurants","restaurants/filter":"restaurantsFilter","search-results/party/:num/date/:num/time/:num/filter":"searchResultsFilter","restaurants/filter/cuisines":"restaurantsFilterCuisines","search-results/party/:num/date/:num/time/:num/filter/cuisines":"searchResultsFilterCuisines","restaurants/filter/neighborhoods":"restaurantsFilterNeighborhoods","search-results/party/:num/date/:num/time/:num/filter/neighborhoods":"searchResultsFilterNeighborhoods","restaurants/:num/info":"restauranInfoShort","restaurants/:num/info?:url":"restauranInfoShort","restaurants/:num/party/:num/date/:num/time/:num/info":"restauranInfo","restaurants/:num/reviews":"restauranReviewsShort","restaurants/:num/party/:num/date/:num/time/:num/reviews":"restauranReviews","restaurants/:num/menus":"restauranMenushort","restaurants/:num/party/:num/date/:num/time/:num/menus":"restauranMenus","restaurants/:num/book-it(/meal/:meal)":"restauranBookItShort","restaurants/:num/party/:num/date/:num/time/:num/book-it(/meal/:meal)":"restauranBookIt","restaurants/:num/party/:num/date/:num/time/:num/book-it/modify/:code(/meal/:meal)":"restauranBookItEdit","restaurants/:num/party/:num/date/:num/time/:num/:from/complete-reservation/:num(/meal/:meal)":"completeReservation","restaurants/:num/party/:num/date/:num/time/:num/:from/complete-reservation/:num/modify/:code(/meal/:meal)":"completeReservationEdit","restaurants/:num/confirmed-reservation/:num":"reservationConfirmed",profile:"profile","profile/edit(?:url)":"profileEdit","profile/reservations":"profileReservations","profile/reservations/:num":"profileReservation","*path":"404"},setup:function(){if(e.footer)return!0;var t=this;e.footerView=new n,e.loadingView=new s,e.addRegions({topBar:"#topBar"}),e.addRegions({content:"#content"}),e.addRegions({footer:"#footer"}),e.addRegions({loading:"#loading"}),e.footer.show(e.footerView),e.vent.on("showLoading",function(){t.toggleLoading(!0)}).on("hideLoading",function(){t.toggleLoading(!1)})},getController:function(t){this.setup();var n=require(t);return new n({contentLayout:e.content,topBarLayout:e.topBar})},index:function(){this.chooseCity()},changeCity:function(){this.chooseCity(!0)},chooseCity:function(e){this.getController("controllers/metros").index(e)},back:function(){var t=e.request("GetCurrentCity");t==null?e.router.navigate("",{trigger:!0}):e.router.navigate("find-table",{trigger:!0})},loginReturnUrl:function(e){this.login(e)},login:function(e){this.getController("controllers/account").login(a,e)},signUp:function(){this.getController("controllers/account").signUp(a)},forgotPassword:function(){this.setup();var t=require("modules/forgotPassword");t.topBarBlock=new t.TopBarView({model:t.topBar}),t.contentLayout=new t.ContentLayout,e.topBar.show(t.topBarBlock),e.content.show(t.contentLayout)},contactUs:function(){this.setup();var t=require("modules/contactUs");t.topBarBlock=new t.TopBarView({model:t.topBar}),t.contentLayout=new t.ContentLayout,e.topBar.show(t.topBarBlock),e.content.show(t.contentLayout)},findTable:function(){this.getController("controllers/findTable").index()},searchResults:function(e,t,n,r,i,s,o){this.getController("controllers/restaurants").search(e,t,n,r,i,s,o)},restaurants:function(){this.getController("controllers/restaurants").index()},restaurantsFilter:function(e){this.filter(!0)},searchResultsFilter:function(e,t,n){this.filter(!1,e,t,n)},filter:function(e,t,n,r){this.getController("controllers/filter").index(e,t,n,r)},restaurantsFilterCuisines:function(){this.filterCuisines(!0)},searchResultsFilterCuisines:function(e,t,n){this.filterCuisines(!1,e,t,n)},filterCuisines:function(e,t,n,r){this.getController("controllers/filter").cuisines(e,t,n,r)},restaurantsFilterNeighborhoods:function(){this.filterNeighborhoods(!0)},searchResultsFilterNeighborhoods:function(e,t,n){this.filterNeighborhoods(!1,e,t,n)},filterNeighborhoods:function(e,t,n,r){this.getController("controllers/filter").neighborhoods(e,t,n,r)},restauranInfoShort:function(e,t){this.restauranInfo(e,2,o.formatDate(new Date),"18:45",!0,t)},restauranInfo:function(e,t,n,r,i,s){this.getController("controllers/restaurant").info(e,t,n,r,i,s)},restauranReviewsShort:function(e){this.restauranReviews(e,2,o.formatDate(new Date),"19:00",!0)},restauranReviews:function(e,t,n,r,i){this.getController("controllers/restaurant").reviews(e,t,n,r,i)},restauranMenushort:function(e){this.restauranMenus(e,2,o.formatDate(new Date),"19:00",!0)},restauranMenus:function(e,t,n,r,i){this.getController("controllers/restaurant").menus(e,t,n,r,i)},restauranBookItShort:function(e,t){this.restauranBookIt(e,2,o.formatDate(new Date),"19:00",t,null,!0)},restauranBookItEdit:function(e,t,n,r,i,s){this.restauranBookIt(e,2,o.formatDate(new Date),"19:00",s,i,!0)},restauranBookIt:function(e,t,n,r,i,s,o){this.getController("controllers/restaurant").bookIt(e,t,n,r,i,s,o)},restaurantExclusiveEats:function(t){this.setup();var n=require("modules/restaurant/exclusiveEats");n.topBarBlock=new n.TopBarView({model:n.topBar}),n.aboutView=new n.AboutView,n.bookView=new n.BookView,n.selectView=new n.SelectView,n.contentLayout=new n.ContentLayout,e.topBar.show(n.topBarBlock),e.content.show(n.contentLayout),n.contentLayout.about.show(n.aboutView),n.contentLayout.select.show(n.selectView),n.contentLayout.book.show(n.bookView)},restaurantExclusiveEatsFaq:function(t){var n=require("modules/restaurant/exclusiveEats");n.topBarBlock=new n.TopBarView({model:n.faqTopBar}),n.contentLayout=new n.FaqView,e.topBar.show(n.topBarBlock),e.content.show(n.contentLayout)},completeReservationEdit:function(e,t,n,r,i,s,o,u){this.completeReservation(e,t,n,r,i,s,u,o)},completeReservation:function(e,t,n,r,i,s,o,u){this.getController("controllers/reservations").completeReservation(e,t,n,r,i,s,o,u)},reservationConfirmed:function(e,t){this.getController("controllers/reservations").reservationConfirmed(e,t)},reservationCardInfo:function(t){this.setup();var n=require("modules/restaurant/completeReservation");n.topBarBlock=new n.TopBarView({model:n.topBar}),n.contentLayout=new n.CardInfoView,e.topBar.show(n.topBarBlock),e.content.show(n.contentLayout)},reservationCanceled:function(t){this.setup();var n=require("modules/restaurant/completeReservation");n.topBarBlock=new n.TopBarView({model:n.topBar}),n.contentLayout=new n.CanceledView,e.topBar.show(n.topBarBlock),e.content.show(n.contentLayout)},profile:function(){this.getController("controllers/account").profile()},profileEdit:function(e){this.getController("controllers/account").profileEdit(e)},profileReservations:function(){this.getController("controllers/reservations").reservations()},profileReservation:function(e){this.getController("controllers/reservations").reservation(e)},404:function(){this.setup(),e.topBar.close(),e.content.show(new i)},errorPartial:function(t,n){t=t||e.content,n=typeof n=="string"?n:null;var i=new r({error:n});return t.show(i),this.toggleLoading(!1),!1},toggleLoading:function(t){t?e.loading.show(e.loadingView):e.loading.close()}});return f}),function(e){function t(e){var t=e.originalEvent.changedTouches,n=t[0],r="",i;switch(e.type){case"touchmove":r="mousemove";break;case"touchend":r="mouseup";break;default:return}i=document.createEvent("MouseEvent"),i.initMouseEvent(r,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(i),e.preventDefault()}e.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}},e.fn.rateit=function(r,i){var s=1,o={},u="init",a=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},f;if(this.length==0)return this;if(f=e.type(r),f=="object"||r===undefined||r==null)o=e.extend({},e.fn.rateit.defaults,r);else{if(f=="string"&&i===undefined)return this.data("rateit"+a(r));f=="string"&&(u="setvalue")}return this.each(function(){var f=e(this),l=function(e,t){if(t!=null){var n="aria-value"+(e=="value"?"now":e),r=f.find(".rateit-range");r.attr(n)!=undefined&&r.attr(n,t)}return arguments[0]="rateit"+a(e),f.data.apply(f,arguments)},c,h,p,d,v,m,g,y;if(f.hasClass("rateit")||f.addClass("rateit"),c=f.css("direction")!="rtl",u=="setvalue"){if(!l("init"))throw"Can't set value before init";r!="readonly"||i!=1||l("readonly")||(f.find(".rateit-range").unbind(),l("wired",!1)),r=="value"&&(i=i==null?l("min"):Math.max(l("min"),Math.min(l("max"),i))),l("backingfld")&&(h=e(l("backingfld")),r=="value"&&h.val(i),r=="min"&&h[0].min&&(h[0].min=i),r=="max"&&h[0].max&&(h[0].max=i),r=="step"&&h[0].step&&(h[0].step=i)),l(r,i)}l("init")||(l("min",l("min")||o.min),l("max",l("max")||o.max),l("step",l("step")||o.step),l("readonly",l("readonly")!==undefined?l("readonly"):o.readonly),l("resetable",l("resetable")!==undefined?l("resetable"):o.resetable),l("backingfld",l("backingfld")||o.backingfld),l("starwidth",l("starwidth")||o.starwidth),l("starheight",l("starheight")||o.starheight),l("value",Math.max(l("min"),Math.min(l("max"),l("value")||o.value||o.min))),l("ispreset",l("ispreset")!==undefined?l("ispreset"):o.ispreset),l("backingfld")&&(h=e(l("backingfld")),l("value",h.hide().val()),(h.attr("disabled")||h.attr("readonly"))&&l("readonly",!0),h[0].nodeName=="INPUT"&&(h[0].type=="range"||h[0].type=="text")&&(l("min",parseInt(h.attr("min"))||l("min")),l("max",parseInt(h.attr("max"))||l("max")),l("step",parseInt(h.attr("step"))||l("step"))),h[0].nodeName=="SELECT"&&h[0].options.length>1&&(l("min",Number(h[0].options[0].value)),l("max",Number(h[0].options[h[0].length-1].value)),l("step",Number(h[0].options[1].value)-Number(h[0].options[0].value)))),p=f[0].nodeName=="DIV"?"div":"span",s++,d='<button id="rateit-reset-{{index}}" class="rateit-reset" aria-label="'+e.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}"></button><{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+e.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+l("min")+'" aria-valuemax="'+l("max")+'" aria-valuenow="'+l("value")+'"><{{element}} class="rateit-selected" style="height:'+l("starheight")+'px"></{{element}}><{{element}} class="rateit-hover" style="height:'+l("starheight")+'px"></{{element}}></{{element}}>',f.append(d.replace(/{{index}}/gi,s).replace(/{{element}}/gi,p)),c||(f.find(".rateit-reset").css("float","right"),f.find(".rateit-selected").addClass("rateit-selected-rtl"),f.find(".rateit-hover").addClass("rateit-hover-rtl")),l("init",!0)),v=f.find(".rateit-range"),v.width(l("starwidth")*(l("max")-l("min"))).height(l("starheight")),m="rateit-preset"+(c?"":"-rtl"),l("ispreset")?f.find(".rateit-selected").addClass(m):f.find(".rateit-selected").removeClass(m),l("value")!=null&&(g=(l("value")-l("min"))*l("starwidth"),f.find(".rateit-selected").width(g)),y=f.find(".rateit-reset"),y.data("wired")!==!0&&y.bind("click",function(t){t.preventDefault(),y.blur(),l("value",l("min")),v.find(".rateit-hover").hide().width(0),v.find(".rateit-selected").width(0).show(),l("backingfld")&&e(l("backingfld")).val(l("min")),f.trigger("reset")}).data("wired",!0);var b=function(t,r){var i=r.changedTouches?r.changedTouches[0].pageX:r.pageX,s=i-e(t).offset().left;return c||(s=v.width()-s),s>v.width()&&(s=v.width()),s<0&&(s=0),g=Math.ceil(s/l("starwidth")*(1/l("step")))},w=function(e){var t=e*l("starwidth")*l("step"),n=v.find(".rateit-hover"),r;n.data("width")!=t&&(v.find(".rateit-selected").hide(),n.width(t).show().data("width",t),r=[e*l("step")+l("min")],f.trigger("hover",r).trigger("over",r))},E=function(t){l("value",t),l("backingfld")&&e(l("backingfld")).val(t),l("ispreset")&&(v.find(".rateit-selected").removeClass(m),l("ispreset",!1)),v.find(".rateit-hover").hide(),v.find(".rateit-selected").width(t*l("starwidth")-l("min")*l("starwidth")).show(),f.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[t])};l("readonly")?y.hide():(l("resetable")||y.hide(),l("wired")||(v.bind("touchmove touchend",t),v.mousemove(function(e){var t=b(this,e);w(t)}),v.mouseleave(function(){v.find(".rateit-hover").hide().width(0).data("width",""),f.trigger("hover",[null]).trigger("over",[null]),v.find(".rateit-selected").show()}),v.mouseup(function(e){var t=b(this,e),n=t*l("step")+l("min");E(n)}),v.keyup(function(e){(e.which==38||e.which==(c?39:37))&&E(Math.min(l("value")+l("step"),l("max"))),(e.which==40||e.which==(c?37:39))&&E(Math.max(l("value")-l("step"),l("min")))}),l("wired",!0)),l("resetable")&&y.show()),v.attr("aria-readonly",l("readonly"))})},e.fn.rateit.defaults={min:0,max:5,step:.5,starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1},e(function(){e("div.rateit, span.rateit").rateit()})}(jQuery),define("rateIt",["jquery"],function(e){return function(){var t,n;return t||e.rateIt}}(this)),require.config({paths:{backbone:"vendors/backbone.marionette/backbone",underscore:"vendors/backbone.marionette/underscore",jquery:"vendors/backbone.marionette/jquery",marionette:"vendors/backbone.marionette/core/amd/backbone.marionette","backbone.wreqr":"vendors/backbone.marionette/core/amd/backbone.wreqr","backbone.eventbinder":"vendors/backbone.marionette/core/amd/backbone.eventbinder","backbone.babysitter":"vendors/backbone.marionette/core/amd/backbone.babysitter",text:"vendors/require/text",urlArgs:"bust="+(new Date).getTime(),basicItemView:"views/shared/basicItemView",BaseController:"controllers/shared/baseController",rateIt:"vendors/plugins/rateit/jquery.rateit.min"},shim:{jquery:{exports:"jQuery"},underscore:{exports:"_"},backbone:{deps:["jquery","underscore"],exports:"Backbone"},rateIt:{deps:["jquery"],exports:"rateIt"}}}),require(["jquery","app","router","backbone","rateIt"],function(e,t,n,r){this.app=t,t.addInitializer(function(e){t.router=new n,r.history.start({pushState:!0,root:e.root})}),e(document).ready(function(){t.start({root:"/"})})}),define("main",function(){});